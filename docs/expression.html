<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Expression Language specification">
<meta name="keywords" content="openehr, expressions, rules">
<title>Expression Language (EL)</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_expression_language_el">Expression Language (EL)</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
<li><a href="#_conformance">1.5. Conformance</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_design_background">2.1. Design Background</a></li>
<li><a href="#_execution_model">2.2. Execution Model</a></li>
<li><a href="#_general_structure">2.3. General Structure</a></li>
</ul>
</li>
<li><a href="#_the_expression_language">3. The Expression Language</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">3.1. Overview</a></li>
<li><a href="#_syntax_style">3.2. Syntax style</a></li>
<li><a href="#_typing">3.3. Typing</a></li>
<li><a href="#_literals">3.4. Literals</a>
<ul class="sectlevel3">
<li><a href="#_primitive_types">3.4.1. Primitive Types</a></li>
<li><a href="#_container_types">3.4.2. Container Types</a></li>
<li><a href="#_interval_type">3.4.3. Interval Type</a></li>
</ul>
</li>
<li><a href="#_statements">3.5. Statements</a>
<ul class="sectlevel3">
<li><a href="#_declarations">3.5.1. Declarations</a></li>
<li><a href="#_constants">3.5.2. Constants</a></li>
<li><a href="#_assignment">3.5.3. Assignment</a></li>
</ul>
</li>
<li><a href="#_bound_variables_evaluation_and_validity">3.6. Bound Variables, Evaluation and Validity</a></li>
<li><a href="#language-expressions">3.7. Expressions</a>
<ul class="sectlevel3">
<li><a href="#_terminal_entities">3.7.1. Terminal Entities</a>
<ul class="sectlevel4">
<li><a href="#_functions">3.7.1.1. Functions</a></li>
</ul>
</li>
<li><a href="#language-operators">3.7.2. Operators</a>
<ul class="sectlevel4">
<li><a href="#_logical_negation">3.7.2.1. Logical Negation</a></li>
<li><a href="#_precedence_and_parentheses">3.7.2.2. Precedence and Parentheses</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_container_operators">3.8. Container Operators</a></li>
</ul>
</li>
<li><a href="#_the_expression_object_model">4. The Expression Object Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">4.1. Overview</a></li>
<li><a href="#_core_package">4.2. Core Package</a>
<ul class="sectlevel3">
<li><a href="#_expressions">4.2.1. Expressions</a></li>
<li><a href="#_other_statement_elements">4.2.2. Other Statement Elements</a>
<ul class="sectlevel4">
<li><a href="#_external_query">4.2.2.1. External Query</a></li>
</ul>
</li>
<li><a href="#_class_descriptions">4.2.3. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_statement_set_class">4.2.3.1. STATEMENT_SET Class</a></li>
<li><a href="#_statement_class">4.2.3.2. STATEMENT Class</a></li>
<li><a href="#_assertion_class">4.2.3.3. ASSERTION Class</a></li>
<li><a href="#_variable_declaration_class">4.2.3.4. VARIABLE_DECLARATION Class</a></li>
<li><a href="#_assignment_class">4.2.3.5. ASSIGNMENT Class</a></li>
<li><a href="#_expr_value_class">4.2.3.6. EXPR_VALUE Class</a></li>
<li><a href="#_external_query_class">4.2.3.7. EXTERNAL_QUERY Class</a></li>
<li><a href="#_expression_class">4.2.3.8. EXPRESSION Class</a></li>
<li><a href="#_expr_operator_class">4.2.3.9. EXPR_OPERATOR Class</a></li>
<li><a href="#_expr_unary_operator_class">4.2.3.10. EXPR_UNARY_OPERATOR Class</a></li>
<li><a href="#_expr_binary_operator_class">4.2.3.11. EXPR_BINARY_OPERATOR Class</a></li>
<li><a href="#_operator_def_class">4.2.3.12. OPERATOR_DEF Class</a></li>
<li><a href="#_operator_def_builtin_class">4.2.3.13. OPERATOR_DEF_BUILTIN Class</a></li>
<li><a href="#_builtin_operators_class">4.2.3.14. BUILTIN_OPERATORS Class</a></li>
<li><a href="#_expr_leaf_class">4.2.3.15. EXPR_LEAF Class</a></li>
<li><a href="#_expr_literal_class">4.2.3.16. EXPR_LITERAL Class</a></li>
<li><a href="#_expr_variable_ref_class">4.2.3.17. EXPR_VARIABLE_REF Class</a></li>
<li><a href="#_expr_value_ref_class">4.2.3.18. EXPR_VALUE_REF Class</a></li>
<li><a href="#_expr_function_class">4.2.3.19. EXPR_FUNCTION Class</a></li>
<li><a href="#_function_def_class">4.2.3.20. FUNCTION_DEF Class</a></li>
<li><a href="#_function_def_builtin_class">4.2.3.21. FUNCTION_DEF_BUILTIN Class</a></li>
<li><a href="#_builtin_functions_class">4.2.3.22. BUILTIN_FUNCTIONS Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_extension_package">4.3. Extension Package</a>
<ul class="sectlevel3">
<li><a href="#_value_references">4.3.1. Value References</a></li>
<li><a href="#_operators_and_functions">4.3.2. Operators and Functions</a></li>
<li><a href="#_class_descriptions_2">4.3.3. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_operator_def_external_class">4.3.3.1. OPERATOR_DEF_EXTERNAL Class</a></li>
<li><a href="#_op_def_example_class">4.3.3.2. OP_DEF_EXAMPLE Class</a></li>
<li><a href="#_op_def_and_class">4.3.3.3. OP_DEF_AND Class</a></li>
<li><a href="#_op_def_exists_class">4.3.3.4. OP_DEF_EXISTS Class</a></li>
<li><a href="#_function_def_external_class">4.3.3.5. FUNCTION_DEF_EXTERNAL Class</a></li>
<li><a href="#_function_def_example_class">4.3.3.6. FUNCTION_DEF_EXAMPLE Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_typing_2">4.4. Typing</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_3">4.4.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_expr_type_def_class">4.4.1.1. EXPR_TYPE_DEF Class</a></li>
<li><a href="#_type_def_boolean_class">4.4.1.2. TYPE_DEF_BOOLEAN Class</a></li>
<li><a href="#_type_def_integer_class">4.4.1.3. TYPE_DEF_INTEGER Class</a></li>
<li><a href="#_type_def_real_class">4.4.1.4. TYPE_DEF_REAL Class</a></li>
<li><a href="#_type_def_date_class">4.4.1.5. TYPE_DEF_DATE Class</a></li>
<li><a href="#_type_def_date_time_class">4.4.1.6. TYPE_DEF_DATE_TIME Class</a></li>
<li><a href="#_type_def_time_class">4.4.1.7. TYPE_DEF_TIME Class</a></li>
<li><a href="#_type_def_duration_class">4.4.1.8. TYPE_DEF_DURATION Class</a></li>
<li><a href="#_type_def_string_class">4.4.1.9. TYPE_DEF_STRING Class</a></li>
<li><a href="#_type_def_uri_class">4.4.1.10. TYPE_DEF_URI Class</a></li>
<li><a href="#_type_def_terminology_code_class">4.4.1.11. TYPE_DEF_TERMINOLOGY_CODE Class</a></li>
<li><a href="#_type_def_object_ref_class">4.4.1.12. TYPE_DEF_OBJECT_REF Class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_syntax_specification">Appendix A: Syntax Specification</a></li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_expression_language_el" class="sect0"><a class="anchor" href="#_expression_language_el"></a>Expression Language (EL)</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: BASE Release-1.0.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: openehr, expressions, rules</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2016 - 2021 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/BASE/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser, Implementer</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>R E L E A S E&#160;&#160;&#160;&#160;&#160;1.0.4</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.5</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="latest_issue"></a><a href="https://specifications.openehr.org/tickets/SPECBASE-33">SPECBASE-33</a>. Retrospectively release interim form of Expression Language.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 P Bos,<br>
 D Bosca</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>11 Aug 2021</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.0</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://specifications.openehr.org/tickets/SPECPUB-6">SPECPUB-6</a>. Correct UML package nesting and paths in documents; insert <code>base</code> parent package; rename <code>expressions</code> package to <code>expression</code>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27 Nov 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.1</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Correct type of <code>OP_DEF_EXISTS.<em>evaluation_agent</em></code> to <code>FUNCTION&lt;&lt;Any&gt;, Boolean&gt;</code>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C Nanjo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31 May 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Initial writing. Taken from AOM2 2.0.6.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 openEHR SEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Feb 2016</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica; openEHR Foundation Management Board.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document specifies the openEHR Expression Model (EOM) and an abstract syntax, denoted the openEHR Expression Language (oEL). The EOM defines the semantics of a first order predicate style logic that can be used to express assertions (for example in archetypes) and rulesfor example in decision support situations.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>Solution vendors;</p>
</li>
<li>
<p>Medical informaticians and clinicians interested in health information.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Releated documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html" target="_blank" rel="noopener">Archetype Object Model 2 (AOM2)</a>.</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/CDS/latest/GDL.html" target="_blank" rel="noopener">Guideline Definition Language (GDL)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>The contents of this specification were separated out from the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html">AOM2 specification</a> in order to provide a common model of expressions and rules structures for AOM, GDL and other specifications requiring it.</p>
</div>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/LANG/latest/expression_language.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/LANG/latest/expression_language.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications/bmm-el" target="_blank" rel="noopener">openEHR languages specifications forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/BASE/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/BASE/history" target="_blank" rel="noopener">BASE component Change Request tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.5. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR specification is determined by a formal test of that artifact against the relevant <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specification(s) (ITSs)</a>, such as an IDL interface or an XML-schema. Since ITSs are formal derivations from underlying models, ITS conformance indicates model conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The openEHR Expression Object Model (EOM) defines the semantics of all of the elements of computable expressions that are used in openEHR, and are likely to be used in healthcare and life sciences computing where rules and expressions are needed. The model is designed as an extensible core formalism suitable for use and extension in other formalisms (such as the openEHR Archetype formalism).</p>
</div>
<div class="paragraph">
<p>The openEHR Expression Language (EL) specified here is an abstract syntax counterpart to the Expression Object Model, and may be considered a 'default syntax'. Other syntaxes or syntax variants are certainly possible, and other serialisation methods are possible, such as object graph serialisation into XML, JSON, YAML etc. The EL is provided firstly as a way of specifying and explaining the semantics of the EOM, and secondly, as one way of actually authoring expressions and rules in textual form. This approach is the same as with any programming language, where the usual form for learning and programming is the abstract language form, while the computational form is an abstract syntax tree (AST) or similar.</p>
</div>
<div class="paragraph">
<p>Accordingly, the EOM should be considered the normative definition of the openEHR Expression formalism, and indeed not all implementations need support the language: they might for example only serialse in JSON or use purely graphical visualisation.</p>
</div>
<div class="paragraph">
<p>The formalism as defined here requires extensions for use, at a minimum to provide concrete value referencing. Extensions would also typically provide more operators, functions, leaf types and other features that are needed in specific circumstances.</p>
</div>
<div class="paragraph">
<p>Key features of the formalism include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>variable declarations, assignments and expressions;</p>
</li>
<li>
<p>strong typing;</p>
</li>
<li>
<p>standard logical operators including universal and existential quantification, as well as user-defined operators;</p>
</li>
<li>
<p>standard arithmetic and relational comparison operators, enabling the use of numerics;</p>
</li>
<li>
<p>parentheses for overridding operator precedence;</p>
</li>
<li>
<p>functions, including built-ins like <code>current_date</code>, standard functions such as <code>max()</code> defined on primitive types, as well as the ability to use external functions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For reasons of comprehensibility and explanation, the Expression Language is defined first in this specification.</p>
</div>
<div class="sect2">
<h3 id="_design_background"><a class="anchor" href="#_design_background"></a>2.1. Design Background</h3>
<div class="paragraph">
<p>The openEHR Expression Language is based on a limited first-order predicate logic language. It has similarities with <a href="https://www.omg.org/spec/OCL/" target="_blank" rel="noopener">OMG&#8217;s OCL (Object Constraint Language)</a>, and to the assertion syntax used in the Object-Z language (<a href="#Object_Z">Smith&#44; 2000</a>). See <a href="#Sowa2000">Sowa (2000)</a>, <a href="#Hein2002">Hein (2002)</a>, <a href="#Kilov1994">Kilov &amp; Ross (1994)</a> for an explanation of predicate logic in information modelling. It also draws on the semantics and some of the syntax (particularly agent-related) of the Eiffel Language (<a href="http://www.ecma-international.org/publications/standards/Ecma-367.htm" target="_blank" rel="noopener">ECMA-367</a>). It is not exactly the same as any of these languages because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it has a different target meta-model, namely the BMM <code>expression</code> model;</p>
</li>
<li>
<p>the syntax is designed to be comprehensible to developers familiar with modern mainstream object-oriented and functional languages such as Java, C#, Python, TypeScript etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Modern syntaxes that provide a more generic and minimal inspiration for the expression syntax described here include the <a href="https://www.w3.org/TR/xpath-31/">Xpath syntax</a>.</p>
</div>
<div class="paragraph">
<p>The semantic requirements are for expressions including arithmetic, boolean, and relational operators, functions, quantifier operators, operator precedence, parentheses, constant values, and certain kinds of variables. However, there is no support in the core specification for procedural semantics or most of the other complexities of full-blown programming languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_model"><a class="anchor" href="#_execution_model"></a>2.2. Execution Model</h3>
<div class="paragraph">
<p>The assumed execution model of the Expression language is that an EL text is evaluated by an <em>evaluator</em> against a <em>data context</em>, which determines the truth values of the expression(s). The data context typically includes data services such as the EHR, patient demographics, laboratory systems and so on - anything that is available computationally via some service. The text may contain symbols representing internal variables and bound variables, the latter of which map to entities in the data context.</p>
</div>
<div class="paragraph">
<p>No assumption is made about whether the data context used is complete or faithful to reality. Consequently, the <em>expression universe</em> is technically speaking an 'open world' in the sense of the <a href="https://en.wikipedia.org/wiki/Open-world_assumption">open-world assumption</a>. However, higher-level applications or components (or users) may have sufficient knowledge about the data as to be able to treat it in a closed world fashion, for example to treat absence of X as negation of X.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_structure"><a class="anchor" href="#_general_structure"></a>2.3. General Structure</h3>
<div class="paragraph">
<p>The Expression Language may be used to write single Boolean-valued expressions within another computational context, and in future, a multi-section self-standing <code>EL text</code> with a similar structure to an archetype. Expressions may be <em>declarations</em>, <em>assignments</em> or <em>assertions</em>. These are made up of expressions containing <em>symbols</em> which represent typed <em>variables</em> and <em>constants</em>. Variables are either <em>bound</em> or <em>local</em>, and are defined using <code>$</code> names, e.g. <code>$heart_rate</code> as used in shell script and some other programming languages. A bound variable is mapped to a field in the data context. In the current version of the language, this is achieved by assignment statements that either assign a path in the data context to a symbolic variable (reading) or the reverse (writing back). In this sense, 'assignment' can be understood as <em>associating</em> a data context path with a named variable.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_expression_language"><a class="anchor" href="#_the_expression_language"></a>3. The Expression Language</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>3.1. Overview</h3>
<div class="paragraph">
<p>This section describes the openEHR Expression Language. In the various contexts where openEHR expressions are used, the syntax provides a foundation for concrete  syntaxes supporting specific value-referencing mechanisms, as well as other types of rules, operands etc. The key features of the language are: variable declarations, assignments and expressions. Most of the semantics are in the expression part, which is based on first-order predicate logic with the addition of arithmetic and relational operators to enable the use of numeric elements. Expressions may contain constants, variable references, value references and functions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_style"><a class="anchor" href="#_syntax_style"></a>3.2. Syntax style</h3>
<div class="paragraph">
<p>The syntax style used here is generally so-called 'snake_case' rather than so-called 'CamelCase', in common with other openEHR specifications, but either may be used in real applications.</p>
</div>
</div>
<div class="sect2">
<h3 id="_typing"><a class="anchor" href="#_typing"></a>3.3. Typing</h3>
<div class="paragraph">
<p>The Expression language is fully typed. The type system is the same as that used in other openEHR components, and supports the same set of basic types as described in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/foundation_types.html" target="_blank" rel="noopener">openEHR Foundation Types Specification</a>, namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>primitive types;</p>
</li>
<li>
<p>container types:</p>
<div class="ulist">
<ul>
<li>
<p><code>List&lt;T&gt;</code>, i.e. an ordered list of elements of primitive type T;</p>
</li>
<li>
<p><code>Set&lt;T&gt;</code>, i.e. a set of elements of primitive type T;</p>
</li>
<li>
<p><code>Hash&lt;K:Ordered,V&gt;</code>, i.e. a Hash table or dictionary;</p>
</li>
</ul>
</div>
</li>
<li>
<p>an interval type:</p>
<div class="ulist">
<ul>
<li>
<p><code>Interval&lt;T: Ordered&gt;</code> where T is any ordered primitive type.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_literals"><a class="anchor" href="#_literals"></a>3.4. Literals</h3>
<div class="sect3">
<h4 id="_primitive_types"><a class="anchor" href="#_primitive_types"></a>3.4.1. Primitive Types</h4>
<div class="paragraph">
<p>The primitive types are shown below, along with typical literal values, which are expressed in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html#_primitive_types" target="_blank" rel="noopener">ODIN syntax</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Literal value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code>, <code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code>, <code>-4</code>, <code>1024</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Real</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0</code>, <code>0.345</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Real value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2004-08-12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8601-format date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2004-08-12T12:00:59+0100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8601-format date/time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>12:00:59</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8601-format time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>P39W</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO8601-format duration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"this is a string"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="https://en.wikipedia.org/wiki/Everest" class="bare">https://en.wikipedia.org/wiki/Everest</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uri in <a href="#uri_syntax">RFC3986 format</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Terminology_code</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[snomed_ct::389086002]</code><br>
                         <code>[snomed_ct::389086002|Hypoxia|]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminology code reference</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Automatic type promotion from <code>Integer</code> to <code>Real</code> applies to all integer and real values and expressions, in the same fashion as most programming languages.</p>
</div>
<div class="paragraph tbd">
<p>TBD: do we need <code>Integer64</code> and <code>Real64</code>?</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_types"><a class="anchor" href="#_container_types"></a>3.4.2. Container Types</h4>
<div class="paragraph">
<p>The same container types as defined in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/foundation_types.html#_structure_types" target="_blank" rel="noopener">Foundation Types specification</a> are supported in EL, as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Literal value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[val, val, &#8230;&#8203;]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linear list of items of any primitive type, allowing order and repeated membership'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Set&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{val, val, &#8230;&#8203;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set of items of any primitive type; no order, unique membership;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Hash&lt;K:Ordered, V&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;<br>
                              ["key1"] = &lt;val1&gt;<br>
                              ["key2"] = &lt;val2&gt;<br>
                              &#8230;&#8203;<br>
                              ["keyN"] = &lt;valN&gt;<br>
                         &gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indexed linear container;<br>
                                                         concretely, a table of values of any type V, keyed by values of any Ordered descendant K, typically String or Integer</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The above types each have an assumed interface consisting of functions and procedures that apply to all members of the container, consistent with the semantics of the container. These include the following methods that may be accessed in EL via the syntactic operators <code>for_all</code> and <code>there_exists</code> described below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    for_all (test(v: T): Boolean): Boolean
            -- True if for every v in container, test (v) is True

    there_exists (test(v: T): Boolean): Boolean
            -- True if there is any v in container for which test (v) is True</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_interval_type"><a class="anchor" href="#_interval_type"></a>3.4.3. Interval Type</h4>
<div class="paragraph">
<p>The same <code>Interval</code> type as defined in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/foundation_types.html#_interval">Foundation Types specification</a> is supported in EL, as follows. Literal interval values take the same form as in <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html#_intervals_of_ordered_primitive_types">ODIN</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Literal value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Interval&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval of any ordered primitive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|N..M|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the two-sided interval N &gt;= x &lt;= M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|&gt;N..M|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the two-sided interval N &gt; x &lt;= M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|N..&lt;M|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the two-sided interval N &gt;= x &lt; M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|&lt;N|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the one-sided interval x &lt; N</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|&gt;N|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the one-sided interval x &gt; N</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|&lt;=N|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the one-sided interval x &lt;= N</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|&gt;=N|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the one-sided interval x &gt;= N</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|N +/-M|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the two-sided interval of N ±M</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|N±M|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the two-sided interval of N ±M</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Automatic type promotion from <code>Interval&lt;Integer&gt;</code> to <code>Interval&lt;Real&gt;</code> applies to all integer and real values and expressions, in the same fashion as most programming languages.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_statements"><a class="anchor" href="#_statements"></a>3.5. Statements</h3>
<div class="paragraph">
<p>An EL text consists of statements, each of which may be a declaration, an assignment or an assertion.</p>
</div>
<div class="sect3">
<h4 id="_declarations"><a class="anchor" href="#_declarations"></a>3.5.1. Declarations</h4>
<div class="paragraph">
<p>Variables are declared with a formal type. Bound variables additionally include an assignment to a path within an assumed data context, which may be understood as performing the binding. Local variable declaratoins may include an assignment to an expression result, in the manner of common programming languages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    -- local variable, primitive type
    $date_of_birth: Date

    -- local variable, container type
    $heart_rate_history: List&lt;Real&gt;

    -- local variable with assignment
    $age_in_years: Integer := current_date() - $date_of_birth

    -- a bound variable
    $weight: Quantity := /data[id3]/events[id4]/data[id2]/items[id5]/value</pre>
</div>
</div>
<div class="paragraph">
<p>Variables are referenced within assignments and expressions using the same syntax, i.e. <code>var_name</code> and <code>$var_name</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constants"><a class="anchor" href="#_constants"></a>3.5.2. Constants</h4>
<div class="paragraph">
<p>Constants are defined via the use of the equality operator <code>=</code> in a declaration and a literal value, as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    Mph_to_kmh_factor: Real = 1.6
    Pounds_to_kg: Real = 0.4536
    Systolic_normal_range: Interval&lt;Integer&gt; = |105..135|</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_assignment"><a class="anchor" href="#_assignment"></a>3.5.3. Assignment</h4>
<div class="paragraph">
<p>An assignment to a writable variable is expressed using the <code>:=</code> operator. An assignment may be made in a declaration in the same way as in many programming languages. The right hand side of an assignment is any value-returning expression. Typical assignments are illustrated below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    $speed_kmh: Real                             -- declaration
    $speed_mph: Real := 35.0                     -- assignment in a declaration (not a constant)

    $speed_kmh := $speed_mph * Mph_to_kmh_factor  -- assignment</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bound_variables_evaluation_and_validity"><a class="anchor" href="#_bound_variables_evaluation_and_validity"></a>3.6. Bound Variables, Evaluation and Validity</h3>
<div class="paragraph">
<p>Variables that are bound to entities in the data context function differently from local variables, since their availability is predicated on the existence of the relevant entities. For example, the variable <code>$body_weight</code> may be bound to a call that retrieves a patient heart rate from the EHR, via an appropriate API call. There is no guarantee that the value is available, so <code>$body_weight</code> may therefore be undefined in a sense not applicable to local variables. In a programming language, if a variable is not explicitly set, it has either the default value of the type (e.g. <code>0</code> for <code>Integer</code>) or a random value of the correct type. This behaviour is appropriate for local variables, but for bound variables that cannot be evaluated because the external entity does not exist, we want something like an exception to occur.</p>
</div>
<div class="paragraph">
<p>The approach used for EL is to allow bound variables to be used freely, as for local variables, but if a bound variable cannot be evaluated from the data context, an <code>'undefined value'</code> exception should be generated, indicating which variable could not be evaluated. To impose more control, the predicate <code>exists ()</code> can be used within an expression or assertion to ensure that one or more variables can be populated before proceeding with logic that depends on them, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    Check_vs_vars: exists $heart_rate and exists $blood_pressure</pre>
</div>
</div>
<div class="paragraph">
<p>To assert that a certain part of a larger data structure exists, the following assertion can be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    Smoker_details_recorded: $is_smoker implies exists $smoking_details</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="language-expressions"><a class="anchor" href="#language-expressions"></a>3.7. Expressions</h3>
<div class="paragraph">
<p>Expressions constitute the main part of the Expressions language, and consist of a familiar typed, operator-based syntax common to many programming languages and logics. Formally, an expression is any of the following entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>terminal entities</em>:</p>
<div class="ulist">
<ul>
<li>
<p><em>symbolic variables</em>;</p>
</li>
<li>
<p><em>constants</em>;</p>
</li>
<li>
<p><em>literals</em>: values are of any primitive type, and are expressed in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html">ODIN syntax</a>. Examples are shown above under <a href="#_typing">Section 3.3</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>non-terminal entities</em>:</p>
<div class="ulist">
<ul>
<li>
<p><em>operators</em>: arithmetic operators, relational operators, boolean operators, quantification operators;</p>
</li>
<li>
<p><em>functions</em>: built-in functions and user-defined functions.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_terminal_entities"><a class="anchor" href="#_terminal_entities"></a>3.7.1. Terminal Entities</h4>
<div class="paragraph">
<p>Terminal entities in EL are any of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>variable</p>
</li>
<li>
<p>variable with sub-path</p>
</li>
<li>
<p>constant</p>
</li>
<li>
<p>function call</p>
</li>
<li>
<p>raw path</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use of variables, constants and function calls is the same as in common languages, using the following syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    -- expression containing a variable and function call
    current_date() - $date_of_birth

    -- expression containing a variable and a constant
    $speed_mph * Mph_to_kmh_factor</pre>
</div>
</div>
<div class="paragraph">
<p>Variables that are bound to paths may be used to generate a reference to a sub-element, using an Xpath-like approach, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    $event: List&lt;Event&gt; := /data[id2]/events[id3]

    Check_field_vals: $event/data[id4]/items[id7]/value/magnitude =
        $event/data[id4]/items[id5]/value/magnitude - $event/data[id4]/items[id6]/value/magnitude</pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the construction <code>$event/data[id4]/items[id7]/value/magnitude</code> references an element in the data context whose location is given by the path to which $event is bound, i.e. <code>/data[id2]/events[id3]</code>, concatenated with the subordinate path, giving a resulting path of <code>/data[id2]/events[id3]/data[id4]/items[id7]/value/magnitude</code>.</p>
</div>
<div class="paragraph">
<p>Finally, in the current version of EL, raw paths may be used directly as variables. This is primarily to allow UI expression building tools that work based on the path map of a data context (e.g. an openEHR archetype) to generate expressions directly using paths rather than introducing variables.</p>
</div>
<div class="sect4">
<h5 id="_functions"><a class="anchor" href="#_functions"></a>3.7.1.1. Functions</h5>
<div class="paragraph">
<p>Functions are considered leaf entities in the Expression language, and can be of a built-in type or external (user-defined) type. A simple example is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    $date_of_birth: Date
    $age: Duration

    $age := current_date() - $date_of_birth</pre>
</div>
</div>
<div class="paragraph">
<p>This uses the built-in function <code>current_date()</code> to compute a person&#8217;s age in the standard way. The typing is based on the operator <code>-</code> (subtract) in the type <code>Date</code> having the following signature, as defined in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/foundation_types.html#_iso8601_date_class" target="_blank" rel="noopener">openEHR Foundation Types Specification</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    class Date
        infix '-' alias subtract (Date): Duration</pre>
</div>
</div>
<div class="paragraph">
<p>The built-in functions are formally defined in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/base_types.html" target="_blank" rel="noopener">openEHR Base Types Specification</a>. Some common ones are listed below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Textual Rendering</th>
<th class="tableblock halign-left valign-top">Signature</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock">Degree 0 functions (no arguments)</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current_date()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">:Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current_time()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">:Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_date_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current_date_time()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">:Date_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Curent date time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_time_zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>current_time_zone()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">:Time_zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Curent time zone</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock">Degree N functions (N arguments)</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sum (x, y, &#8230;&#8203;.)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;Real, &#8230;&#8203;&gt;: Real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equivalent to x + y + &#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mean (x, y, &#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;Real, &#8230;&#8203;&gt;: Real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The mean (average) value of x, y, &#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max (x, y, &#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;Real, &#8230;&#8203;&gt;: Real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum value among x, y, &#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>min (x, y, &#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;Real, &#8230;&#8203;&gt;: Real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minimum value among x, y, &#8230;&#8203;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any other functions that are used need to be mapped by the EL engine to implementations with matching signatures.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="language-operators"><a class="anchor" href="#language-operators"></a>3.7.2. Operators</h4>
<div class="paragraph">
<p>Expressions can include arithmetic, relational and boolean operators, plus the existential and universal quantifiers. The full operator set is shown below, along with textual and symbolic renderings. The latter are just standard Unicode symbols. Expression parsers should ideally support these symbols as operator equivalents in addition to the textual form, since it allows expressions to be expressed in a more compact and less language-independent way.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 50.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Identifier</th>
<th class="tableblock halign-left valign-top">Textual<br>
               Rendering</th>
<th class="tableblock halign-left valign-top">Symbolic<br>
                               Rendering</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock">Arithmetic Operators - Numeric result; descending precendence order</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">^</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">^</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expontentiation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">times</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">divide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Division</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modulo (whole number) division</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Addition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtraction</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock">Relational Operators - Boolean result; equal precedence</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equality relation between numerics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ne</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">!=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">≠</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inequality relation between numerics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less than relation between numerics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">le</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">≤</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less than or equal relation between numerics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater than relation between numerics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;=</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">≥</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Greater than or equal relation between numerics</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock">Logical Operators - Boolean result; descending precendence order</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">not</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not, ~</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∼</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Negation, "not p"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∧</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical conjunction, "p and q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∨</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical disjunction, "p or q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⊻</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclusive or, "only one of p or q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">implies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⇒</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Material implication, "p implies q", or "if p then q"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Operator semantics that require further explanation are described below.</p>
</div>
<div class="sect4">
<h5 id="_logical_negation"><a class="anchor" href="#_logical_negation"></a>3.7.2.1. Logical Negation</h5>
<div class="paragraph">
<p>All Boolean operators take Boolean operands and generate a Boolean result. The <code>not</code> operator can be applied as a prefix operator to all operators returning a Boolean result as well as a parenthesised Boolean expression.</p>
</div>
</div>
<div class="sect4">
<h5 id="_precedence_and_parentheses"><a class="anchor" href="#_precedence_and_parentheses"></a>3.7.2.2. Precedence and Parentheses</h5>
<div class="paragraph">
<p>The precendence of operators follows the order shown in the operator tables above. To change precedence, parentheses can be used in the fashion typical of most programming languages, as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    $at_risk := $weight &gt; 120 and ($is_smoker or $is_hypertensive)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_container_operators"><a class="anchor" href="#_container_operators"></a>3.8. Container Operators</h3>
<div class="paragraph">
<p>The two standard quantification operators from predicate logic <code>there exists</code> (∃ operator) and <code>for all</code> (∀ operator) are defined in EL for the container types found in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/foundation_types.html" target="_blank" rel="noopener">openEHR Foundation Types</a>.</p>
</div>
<div class="paragraph">
<p>The textual syntax of <code>there exists</code> is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    there_exists v : container_var | &lt;Boolean expression mentioning v&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Here, the <code>|</code> symbol is usually read in English as 'such that'. The symbolic equivalent may also be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    ∃ v : container_var | &lt;Boolean expression mentioning v&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>for_all</code> operator has similar textual syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    for_all v : container_var | &lt;Boolean expression mentioning v&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Here, the <code>|</code> symbol is normally read in English as as 'it holds that'. The symbolic equivalent may also be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    ∀ v : container_var | &lt;Boolean expression mentioning v&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For both operators, the <code>:</code> symbol may be replaced by the keyword <code>in</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_expression_object_model"><a class="anchor" href="#_the_expression_object_model"></a>4. The Expression Object Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The <code>expression</code> package defines the Expression Object Model (EOM), a model of 'statements' and 'expressions' that can be used in various contexts in openEHR, including inside archetypes and in GDL guidelines. If the Expression Language or other syntax-based artefact is used, the model described here defines the parser output in the form of an expression tree. Other openEHR models designed for a particular purpose may reuse the <code>expression</code> package and further specialise some of its types specifically intended for extension.</p>
</div>
<div class="paragraph">
<p>The package structure of the <code>expression</code> package is shown below.</p>
</div>
<div id="expression_packages" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/BASE-expression_packages.svg" alt="BASE expression packages">
</div>
<div class="title">Figure 1. base.expression Package</div>
</div>
</div>
<div class="sect2">
<h3 id="_core_package"><a class="anchor" href="#_core_package"></a>4.2. Core Package</h3>
<div class="paragraph">
<p>The main <code>expression</code> packages <code>core</code> and <code>extension</code> are illustrated below.</p>
</div>
<div id="expression_package" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/BASE-expression.svg" alt="BASE expression">
</div>
<div class="title">Figure 2. base.expression.core Package</div>
</div>
<div class="paragraph">
<p>A group of statements to be used together is formally defined as one or more <code>STATEMENTs</code> in a <code>STATEMENT_SET</code>. There are three types of statements corresponding to the classes <code>ASSERTION</code>, <code>VARIABLE_DECLARATION</code> and <code>ASSIGNMENT</code>. Assertions consist of an expression tree structure that evaluates to a <code>Boolean</code> value. The root of the tree is a descendant of the class <code>EXPR_ITEM</code> that represents a Boolean-returning operator or value. An Assertion has an optional tag, enabling it to be named.</p>
</div>
<div class="paragraph">
<p>A <code>VARIABLE_DECLARATION</code> enables a named variable to be declared with a type, which must be one of the descendants of <code>EXPR_DEF_TYPE</code>.</p>
</div>
<div class="paragraph">
<p>The <code>ASSIGNMENT</code> class defines the usual operation of assigning a value (the <code><em>source</em></code> i.e. the notional right-hand side) to a variable, (the <code><em>target</em></code>, i.e. left-hand side). The source of an assignment can be any Expression or an <code>EXTERNAL_QUERY</code>, which are sub-types of <code>EXPR_VALUE</code>.</p>
</div>
<div class="sect3">
<h4 id="_expressions"><a class="anchor" href="#_expressions"></a>4.2.1. Expressions</h4>
<div class="paragraph">
<p>Expressions are fully described statement values that may be evaluated internally (as compared to an external query) and are defined by the <code>EXPR_XXX</code> classes. The Expression classes model a typical evaluation tree each of whose nodes is either a leaf or an operator node. The semantics of Expressions are described in the <a href="#language-expressions">Expressions</a> sub-section in the Language section.</p>
</div>
<div class="paragraph">
<p>In this model, 'functions' are treated as leaf nodes rather than tree nodes, which would be more typical of a functional language meta-model. The leaf node approach used here treats functions as black boxes requiring an evaluation method, enabling the main expression tree to be evaluated by use of a standard set of operators whose semantics can be safely built in.</p>
</div>
<div class="paragraph">
<p>Operator semantics are defined by the class <code>OPERATOR_DEF</code>, which includes the two attributes <code><em>name</em></code> and <code><em>symbols</em></code> which define the name of the operator and its allowable symbols respectively.</p>
</div>
<div class="paragraph tbd">
<p>TBD: could potentially separate 'text symbols' and 'math symbols' to enable rendering in different ways.</p>
</div>
<div class="paragraph">
<p>The <code>OPERATOR_DEF_BUILTIN</code> class defines a hook for implementing built-in operators, i.e. those that will be executed by fixed code within the statement evaluator, e.g. a case statement or similar that uses the implementation language native operators.</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_statement_elements"><a class="anchor" href="#_other_statement_elements"></a>4.2.2. Other Statement Elements</h4>
<div class="sect4">
<h5 id="_external_query"><a class="anchor" href="#_external_query"></a>4.2.2.1. External Query</h5>
<div class="paragraph">
<p>An <code>EXTERNAL_QUERY</code> is a type of expression representing a call to an external service which obtains a value for it. This enables information items from the exterior computational environment to be treated as abstract typed values within expressions.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions"><a class="anchor" href="#_class_descriptions"></a>4.2.3. Class Descriptions</h4>
<div class="sect4">
<h5 id="_statement_set_class"><a class="anchor" href="#_statement_set_class"></a>4.2.3.1. STATEMENT_SET Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>STATEMENT_SET</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>A container for a specific set of statements intended to be used together.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>statement</strong>: <code>List&lt;STATEMENT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The member statements of this statement set.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional name of this rule set.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_result</strong> (): <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Execution result of the whole rule set. Determined by the and-ing of result values of Assertions in the rule set.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_statement_class"><a class="anchor" href="#_statement_class"></a>4.2.3.2. STATEMENT Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>STATEMENT (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstract concept of any statement in a block of rule statements.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_assertion_class"><a class="anchor" href="#_assertion_class"></a>4.2.3.3. ASSERTION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>ASSERTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Structural model of a typed first order predicate logic assertion, in the form of an expression tree, including optional variable definitions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>STATEMENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tag</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Expression tag, used for differentiating multiple assertions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>string_expression</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>String form of expression, in case an expression evaluator taking String expressions is used for evaluation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expression</strong>: <code>EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Root of expression tree.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_variable_declaration_class"><a class="anchor" href="#_variable_declaration_class"></a>4.2.3.4. VARIABLE_DECLARATION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>VARIABLE_DECLARATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Definition of a named variable that can be used in an expression.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>STATEMENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the variable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type</strong>: <code>EXPR_TYPE_DEF</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Primitive type of the variable, enabling its use to be type-checked in expressions.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_assignment_class"><a class="anchor" href="#_assignment_class"></a>4.2.3.5. ASSIGNMENT Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>ASSIGNMENT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstract ancestor of types representing the assignment statement, which does not produce a value in the way that operators such as '=', 'and' etc do. An assignment associates a named variable with an expression.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>STATEMENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>target</strong>: <code>VARIABLE_DECLARATION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The target variable on the notional left-hand side of this assignment.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>source</strong>: <code>EXPR_VALUE</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Source right hand side) of the assignment.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_value_class"><a class="anchor" href="#_expr_value_class"></a>4.2.3.6. EXPR_VALUE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EXPR_VALUE (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Any kind of statement element that can be evaluated. The type will either be supplied in descendant types or else will be inferred by an assignment statement linked to a typed variable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">(abstract)</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value</strong> (): <code>Any</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The computed value of this node as a result of the nodes below it, for operator nodes, or else statically set or otherwise derived values.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_external_query_class"><a class="anchor" href="#_external_query_class"></a>4.2.3.7. EXTERNAL_QUERY Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXTERNAL_QUERY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Definition of a variable whose value is derived from a query run on a data context in the operational environment. Typical uses of this kind of variable are to obtain values like the patient date of birth, sex, weight, and so on. It could also be used to obtain items from a knowledge context, such as a drug database.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_VALUE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>context</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional name of context. This allows a basic separation of query types to be done in more sophisticated environments. Possible values might be “patient”, “medications” and so on.
Not yet standardised.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>query_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Identifier of query in the external context, e.g. “date_of_birth”.
Not yet standardised.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>query_args</strong>: <code>List&lt;String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional arguments to query.
Not yet standardised.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expression_class"><a class="anchor" href="#_expression_class"></a>4.2.3.8. EXPRESSION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EXPRESSION (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstract parent of all typed expression tree items.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_VALUE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">(abstract)</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type</strong> (): <code>EXPR_TYPE_DEF</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The primitive type of this node, which must be determined by redefinitions in concrete classes.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_operator_class"><a class="anchor" href="#_expr_operator_class"></a>4.2.3.9. EXPR_OPERATOR Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EXPR_OPERATOR (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstract parent of operator types.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPRESSION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>precedence_overridden</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>True if the natural precedence of operators is overridden in the expression represented by this node of the expression tree. If True, parentheses should be introduced around the totality of the syntax expression corresponding to this operator node and its operands.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>operator_def</strong>: <code>OPERATOR_DEF</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Operator definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>symbol</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The symbol actually used in the rule, or intended to be used for serialisation. Must be a member of operator_def.symbols.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_unary_operator_class"><a class="anchor" href="#_expr_unary_operator_class"></a>4.2.3.10. EXPR_UNARY_OPERATOR Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXPR_UNARY_OPERATOR</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Unary operator expression node.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_OPERATOR</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>operand</strong>: <code>EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Operand node.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_binary_operator_class"><a class="anchor" href="#_expr_binary_operator_class"></a>4.2.3.11. EXPR_BINARY_OPERATOR Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXPR_BINARY_OPERATOR</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Binary operator expression node.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_OPERATOR</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>left_operand</strong>: <code>EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Left operand node.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>right_operand</strong>: <code>EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Right operand node.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_operator_def_class"><a class="anchor" href="#_operator_def_class"></a>4.2.3.12. OPERATOR_DEF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>OPERATOR_DEF (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstract definition of an operator for use in the Rules evaluator.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>identifier</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Unique identifier of this operator within the rules system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock">(abstract)</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>symbols</strong> (): <code>List&lt;String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>One or more symbols used to express the operator in textual form. This may include any unicode character.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_operator_def_builtin_class"><a class="anchor" href="#_operator_def_builtin_class"></a>4.2.3.13. OPERATOR_DEF_BUILTIN Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>OPERATOR_DEF_BUILTIN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Builtin operator pseudo-type. An implementation will typically use the 'identifer' attribute to determine which piece of internal code to execute to evaluate the operator.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>OPERATOR_DEF</code>, <code>BUILTIN_OPERATORS</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p><strong><em>Valid_operator</em></strong>: <code>op_table.has (name)</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_builtin_operators_class"><a class="anchor" href="#_builtin_operators_class"></a>4.2.3.14. BUILTIN_OPERATORS Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>BUILTIN_OPERATORS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Singleton accessor object for list of builtin operators.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Constants</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>op_table</strong>: <code>Hash&lt;String, List&lt;String&gt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List of built-in operators in the form of a keyed table of List&lt;String&gt;, where the latter represents one or more lexical symbols used for the operator, e.g. "+", and the key is the operator identifier, e.g. "plus".</p>
</div>
<div class="paragraph">
<p>Implementations may choose to populate this table with all operators defined in the core specifications, or only partially, in which case operators not in the table are implemented using the closure/agent approach for externally defined operators.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_leaf_class"><a class="anchor" href="#_expr_leaf_class"></a>4.2.3.15. EXPR_LEAF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EXPR_LEAF (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Expression tree leaf item representing one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a manifest constant of any primitive type;</p>
</li>
<li>
<p>a path referring to a value in the archetype;</p>
</li>
<li>
<p>a constraint;</p>
</li>
<li>
<p>a variable reference.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPRESSION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>item</strong>: <code>Any</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The reference item from which the value of this node can be computed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_literal_class"><a class="anchor" href="#_expr_literal_class"></a>4.2.3.16. EXPR_LITERAL Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXPR_LITERAL</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Literal value expression tree leaf item. This can represent a literal value of any primitive type included in the PRIMITIVE_TYPE enumeration.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_LEAF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>item</strong>: <code>Any</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A statically set constant value of a primitive type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_variable_ref_class"><a class="anchor" href="#_expr_variable_ref_class"></a>4.2.3.17. EXPR_VARIABLE_REF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXPR_VARIABLE_REF</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Expression tree leaf item representing a reference to a declared variable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_LEAF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>item</strong>: <code>VARIABLE_DECLARATION</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The variable referred to.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_value_ref_class"><a class="anchor" href="#_expr_value_ref_class"></a>4.2.3.18. EXPR_VALUE_REF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EXPR_VALUE_REF (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstract parent type of concrete types enabling access to values in a specific information structure. This type provides an extension point for specific syntaxes to connect a generic rule structure to a data source.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_LEAF</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_expr_function_class"><a class="anchor" href="#_expr_function_class"></a>4.2.3.19. EXPR_FUNCTION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXPR_FUNCTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Node representing a function with 0 or more arguments.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_LEAF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>arguments</strong>: <code>List&lt;EXPRESSION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Arguments of this function, which can be from 0 to any number. Functions with no arguments are typically used to represent real world varying values like 'current time' and so on.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>function_def</strong>: <code>FUNCTION_DEF</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_function_def_class"><a class="anchor" href="#_function_def_class"></a>4.2.3.20. FUNCTION_DEF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>FUNCTION_DEF (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Ancestor type for types that define a function for use in the Rules evaluator.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>identifier</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Unique identifier of this function within the Rules system.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_function_def_builtin_class"><a class="anchor" href="#_function_def_builtin_class"></a>4.2.3.21. FUNCTION_DEF_BUILTIN Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>FUNCTION_DEF_BUILTIN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Builtin function pseudo-type. An implementation will typically use the 'identifer' attribute to determine which piece of internal code to execute to evaluate the function.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>FUNCTION_DEF</code>, <code>BUILTIN_FUNCTIONS</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p><strong><em>Valid_function</em></strong>: <code>func_table.has (name)</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_builtin_functions_class"><a class="anchor" href="#_builtin_functions_class"></a>4.2.3.22. BUILTIN_FUNCTIONS Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>BUILTIN_FUNCTIONS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Singleton accessor object for list of builtin functions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Constants</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>func_table</strong>: <code>Hash&lt;String, List&lt;String&gt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List of built-in functions in the form of a keyed table of List&lt;String&gt;, where the latter represents one or more lexical symbols used for the function, e.g. "max", and the key is the function identifier, e.g. "max".</p>
</div>
<div class="paragraph">
<p>Implementations may choose to populate this table with all functions defined in the core specifications, or only partially, in which case functions not in the table are implemented using the closure/agent approach for externally defined functions.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extension_package"><a class="anchor" href="#_extension_package"></a>4.3. Extension Package</h3>
<div class="paragraph">
<p>The Extension package contains classes that provide extension points to the Expression formalism. These are of three kinds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>value references;</p>
</li>
<li>
<p>externally defined operators;</p>
</li>
<li>
<p>externally defined functions.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_value_references"><a class="anchor" href="#_value_references"></a>4.3.1. Value References</h4>
<div class="paragraph">
<p>Value references are defined by creating descandants of the <code>EXPR_VALUE_REF</code> class. These typically contain a reference to a data object, or an identifier that can be resolved to a value via a resolver.</p>
</div>
</div>
<div class="sect3">
<h4 id="_operators_and_functions"><a class="anchor" href="#_operators_and_functions"></a>4.3.2. Operators and Functions</h4>
<div class="paragraph">
<p>Externally defined operators and functions are defined as the separate types <code>OPERATOR_DEF_EXTERNAL</code> and <code>FUNCTION_DEF_EXTERNAL</code> resepectively. They could in theory be defined with a single class, however the use of two classes express the distinction between operators and functions used in the openEHR Expression language.</p>
</div>
<div class="paragraph tbd">
<p>TBD: this model in its current form treats functions and operators as separate, to allow some convenience in simple implementation of standard operators. But   Theoretically, operators are just 1-arg or 2-arg functions, and the extensions could be defined by treating them as functions. However operators also usually have a symbol form, whereas we are assuming a function&#8217;s symbol is just its identifier. Also, functions can in general have variable numbers of arguments, and complex implementations. Do we want to implement operators that way?</p>
</div>
<div class="paragraph">
<p>The <code>OPERATOR_DEF_EXTERNAL</code> class inherits the <code><em>identifier</em></code> and <code><em>symbols</em></code> features from <code>OPERATOR_DEF</code>, and adds an <code><em>execution_agent</em></code>, which is a function object that can compute the operator, given appropriate arguments. The extention part of the UML model above shows how tihs facility can be used to define two operators that would normally be implemented as built-ins, <code>and</code> and <code>exists</code>.</p>
</div>
<div class="paragraph tbd">
<p>TBD: this is shown as being done with a class per operator, but in fact it only requires instances of <code>OPERATOR_DEF_EXTERNAL</code> which have the appropriate identifiers, symbols and avaluation agent. Should we just define it this way?</p>
</div>
<div class="paragraph">
<p>The approach to adding custom functions is the same as with operators.</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_2"><a class="anchor" href="#_class_descriptions_2"></a>4.3.3. Class Descriptions</h4>
<div class="sect4">
<h5 id="_operator_def_external_class"><a class="anchor" href="#_operator_def_external_class"></a>4.3.3.1. OPERATOR_DEF_EXTERNAL Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>OPERATOR_DEF_EXTERNAL (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Ancestor of concrete operator definition types. Adds an optional execution agent, typically implemented by closures / lambdas/ agents in languages supporting functional programming.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>OPERATOR_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>evaluation_agent</strong>: <code>FUNCTION&lt;TUPLE,Any&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_op_def_example_class"><a class="anchor" href="#_op_def_example_class"></a>4.3.3.2. OP_DEF_EXAMPLE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>OP_DEF_EXAMPLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Example custom operator definition as a class, for an operator whose identifier is 'xxx' and for which the symbols "xxx" and "%" can be used, and with a two-argument numeric signature.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>OPERATOR_DEF_EXTERNAL</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>symbols</strong>: <code>List&lt;String&gt;&#160;=&#160;"xxx", "%"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>identifier</strong>: <code>String&#160;=&#160;"xxx"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>evaluation_agent</strong>: <code>FUNCTION&lt;&lt;Numeric,Numeric&gt;,Numeric&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_op_def_and_class"><a class="anchor" href="#_op_def_and_class"></a>4.3.3.3. OP_DEF_AND Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>OP_DEF_AND</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Illustrative class showing what the normally built-in logical 'and' operator looks like as an external definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>OPERATOR_DEF_EXTERNAL</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>symbols</strong>: <code>List&lt;String&gt;&#160;=&#160;"and","∧"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>identifier</strong>: <code>String&#160;=&#160;"and"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>evaluation_agent</strong>: <code>FUNCTION&lt;&lt;Boolean,Boolean&gt;,Boolean&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_op_def_exists_class"><a class="anchor" href="#_op_def_exists_class"></a>4.3.3.4. OP_DEF_EXISTS Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>OP_DEF_EXISTS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Illustrative class showing what the normally built-in logical 'exists' operator looks like as an external definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>OPERATOR_DEF_EXTERNAL</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>symbols</strong>: <code>List&lt;String&gt;&#160;=&#160;"exists", "∃"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>identifier</strong>: <code>String&#160;=&#160;"exists"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>evaluation_agent</strong>: <code>FUNCTION&lt;&lt;Any&gt;,Boolean&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_function_def_external_class"><a class="anchor" href="#_function_def_external_class"></a>4.3.3.5. FUNCTION_DEF_EXTERNAL Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>FUNCTION_DEF_EXTERNAL (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Ancestor class of externally defined function types.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>FUNCTION_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>evaluation_agent</strong>: <code>FUNCTION&lt;TUPLE,Any&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_function_def_example_class"><a class="anchor" href="#_function_def_example_class"></a>4.3.3.6. FUNCTION_DEF_EXAMPLE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>FUNCTION_DEF_EXAMPLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Example of an externally defined function of signature:</p>
</div>
<div class="paragraph">
<p>func (v: Numeric): Numeric</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>FUNCTION_DEF_EXTERNAL</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>identifier</strong>: <code>String&#160;=&#160;"funny"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>evaluation_agent</strong>: <code>FUNCTION&lt;&lt;Numeric&gt;,Numeric&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_typing_2"><a class="anchor" href="#_typing_2"></a>4.4. Typing</h3>
<div class="paragraph">
<p>The <code>expressions.types</code> package is shown below.</p>
</div>
<div id="expressions_types_package" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/BASE-expression.types.svg" alt="BASE expression.types">
</div>
<div class="title">Figure 3. baes.expression.types Package</div>
</div>
<div class="paragraph">
<p>The type system of the Expression formalism is defined via the type <code>EXPR_TYPE_DEF</code> and its descendants. All types have a <code><em>type_name</em></code> and a <code><em>type_anchor</em></code>, which is a variable of the coresponding primtive type from within the openEHR <code>base_types</code> package, i.e. <code>Integer</code>, <code>Real</code>, <code>String</code>, etc. The type anchor can be used for testing assignments within the implementation. A special type <code>TYPE_DEF_OBJECT</code> is included to enable a value reference (descendant of <code>EXPR_VALUE_REF</code>) to refer to a complex object, to which some expression operators can be applied, including equality and existence. The types system is extensible, as described below.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_3"><a class="anchor" href="#_class_descriptions_3"></a>4.4.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_expr_type_def_class"><a class="anchor" href="#_expr_type_def_class"></a>4.4.1.1. EXPR_TYPE_DEF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EXPR_TYPE_DEF (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Ancestor class for type definitions known in the openEHR Expression formalism.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Natural language type name of this type as used in abstract rules syntax variable declarations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>Any</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Attribute of the openEHR primitive type (or Any) corresponding to this type definition meta-type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_boolean_class"><a class="anchor" href="#_type_def_boolean_class"></a>4.4.1.2. TYPE_DEF_BOOLEAN Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_BOOLEAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Boolean.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Boolean"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_integer_class"><a class="anchor" href="#_type_def_integer_class"></a>4.4.1.3. TYPE_DEF_INTEGER Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_INTEGER</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Integer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Integer"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_real_class"><a class="anchor" href="#_type_def_real_class"></a>4.4.1.4. TYPE_DEF_REAL Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_REAL</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Real.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Real"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>Real</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_date_class"><a class="anchor" href="#_type_def_date_class"></a>4.4.1.5. TYPE_DEF_DATE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_DATE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Date.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Date"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>IDate</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_date_time_class"><a class="anchor" href="#_type_def_date_time_class"></a>4.4.1.6. TYPE_DEF_DATE_TIME Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_DATE_TIME</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Date_time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Date_time"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>IDate_time</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_time_class"><a class="anchor" href="#_type_def_time_class"></a>4.4.1.7. TYPE_DEF_TIME Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_TIME</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Time"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>ITime</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_duration_class"><a class="anchor" href="#_type_def_duration_class"></a>4.4.1.8. TYPE_DEF_DURATION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_DURATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Duration.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Duration"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>IDuration</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_string_class"><a class="anchor" href="#_type_def_string_class"></a>4.4.1.9. TYPE_DEF_STRING Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_STRING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type String.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"String"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_uri_class"><a class="anchor" href="#_type_def_uri_class"></a>4.4.1.10. TYPE_DEF_URI Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_URI</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Uri.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Uri"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_terminology_code_class"><a class="anchor" href="#_type_def_terminology_code_class"></a>4.4.1.11. TYPE_DEF_TERMINOLOGY_CODE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_TERMINOLOGY_CODE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the primitive type Terminology_code.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Terminology_code"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_anchor</strong>: <code>Terminology_code</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_type_def_object_ref_class"><a class="anchor" href="#_type_def_object_ref_class"></a>4.4.1.12. TYPE_DEF_OBJECT_REF Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TYPE_DEF_OBJECT_REF</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Rules meta-type representing the type Object_ref, which is assumed to by the type of any non-primitive reference target within a rule.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EXPR_TYPE_DEF</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type_name</strong>: <code>String&#160;=&#160;"Object_ref"</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntax_specification"><a class="anchor" href="#_syntax_specification"></a>Appendix A: Syntax Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The grammar and lexical specification for the standard Expression syntax is shown below in ANTLR4 form.
 </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">//  description: Antlr4 grammar for openEHR Rules core syntax.</span><span class="tok-w"></span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span><span class="tok-w"></span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span><span class="tok-w"></span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span><span class="tok-w"></span>
<span class="tok-c">//  copyright:   Copyright (c) 2016- openEHR Foundation &lt;http://www.openEHR.org&gt;</span><span class="tok-w"></span>
<span class="tok-c">//  license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">base_expressions</span><span class="tok-p">;</span><span class="tok-w"></span>


<span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">// General expressions</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-nl">expression</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">simple_expression</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">for_all_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">exists_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">simple_expression</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">boolean_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">// Universal and existential quantifier</span><span class="tok-w"></span>

<span class="tok-nl">for_all_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-no">SYM_FOR_ALL</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-no">SYM_IN</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-s">&#39;|&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">there_exists_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-no">SYM_THERE_EXISTS</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-no">SYM_IN</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-s">&#39;|&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">// Expressions evaluating to boolean values</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-nl">boolean_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_AND</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_XOR</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_OR</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_IMPLIES</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">// basic boolean expression elements</span><span class="tok-w"></span>

<span class="tok-nl">boolean_leaf</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">boolean_literal</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">instance_ref</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">relational_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">comparison_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constraint_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_EXISTS</span><span class="tok-w"> </span><span class="tok-nv">mapped_data_ref</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_NOT</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">constraint_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">mapped_data_ref</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_object</span><span class="tok-w"> </span><span class="tok-s">&#39;}&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">boolean_literal</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-no">SYM_TRUE</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">// Comparison expression between any operand</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-nl">comparison_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">simple_expression</span><span class="tok-w"> </span><span class="tok-nv">equality_binop</span><span class="tok-w"> </span><span class="tok-nv">simple_expression</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">// Relational expressions of arithmetic operands</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-nl">relational_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">relational_binop</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">equality_binop</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-no">SYM_EQ</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_NE</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">relational_binop</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">equality_binop</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">// Expressions evaluating to arithmetic values</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-nl">arithmetic_expr</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">&lt;</span><span class="tok-nv">assoc</span><span class="tok-o">=</span><span class="tok-nv">right</span><span class="tok-err">&gt;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-s">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">mult_op</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">add_op</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">arithmetic_leaf</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">integer_value</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">instance_ref</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">mult_op</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-s">&#39;/&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s">&#39;*&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">add_op</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-s">&#39;+&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s">&#39;-&#39;</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">//</span><span class="tok-w"></span>
<span class="tok-c">// instances references: data references, variables, and function calls.</span><span class="tok-w"></span>
<span class="tok-c">// TODO: Currently treat ADL paths as &#39;mapped&#39; data references;</span><span class="tok-w"></span>
<span class="tok-c">// which is ambiguous, since an ADL path may match multiple runtime objects</span><span class="tok-w"></span>
<span class="tok-c">//</span><span class="tok-w"></span>

<span class="tok-nl">instance_ref</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">value_ref</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">function_call</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">value_ref</span><span class="tok-p">:</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">mapped_data_ref</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">variable_id</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">mapped_data_ref</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">variable_id</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">function_call</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="Hein2002"></a>Hein, J. L. (2002). <em>Discrete Structures, Logic and Computability</em> (Second.). Jones and Bartlett.</p>
</div>
<div class="paragraph">
<p><a id="Kilov1994"></a>Kilov, H., &amp; Ross, J. (1994). <em>Information Modelling - an object-oriented approach</em>. Prentice Hall.</p>
</div>
<div class="paragraph">
<p><a id="Object_Z"></a>Smith, G. (2000). <em>The Object Z Specification Language</em>. Kluwer Academic Publishers. Retrieved from <a href="http://www.itee.uq.edu.au/ smith/objectz.html" class="bare">http://www.itee.uq.edu.au/ smith/objectz.html</a></p>
</div>
<div class="paragraph">
<p><a id="Sowa2000"></a>Sowa, J. F. (2000). <em>Knowledge Representation: Logical, philosophical and Computational Foundations</em>. California: Brooks/Cole.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-08-11 16:44:15 +0100
</div>
</div>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-default.css">
</body>
</html>