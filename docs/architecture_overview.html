<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Architecture Overview">
<meta name="keywords" content="EHR, openehr, architecture">
<title>openEHR Architecture Overview</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_openehr_architecture_overview">openEHR Architecture Overview</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_status">1.2. Status</a></li>
<li><a href="#_feedback">1.3. Feedback</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_the_openehr_specification_program">2.1. The openEHR Specification Program</a></li>
</ul>
</li>
<li><a href="#_aims_of_the_openehr_architecture">3. Aims of the openEHR Architecture</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">3.1. Overview</a>
<ul class="sectlevel3">
<li><a href="#_generic_care_record_requirements">3.1.1. Generic Care Record Requirements</a></li>
<li><a href="#_health_care_record_epr">3.1.2. Health Care Record (EPR)</a></li>
<li><a href="#_shared_care_ehr">3.1.3. Shared Care EHR</a></li>
</ul>
</li>
<li><a href="#_clinical_aims">3.2. Clinical Aims</a></li>
<li><a href="#_deployment_environments">3.3. Deployment Environments</a></li>
</ul>
</li>
<li><a href="#_design_principles">4. Design Principles</a>
<ul class="sectlevel2">
<li><a href="#_ontological_separation">4.1. Ontological Separation</a>
<ul class="sectlevel3">
<li><a href="#_multi_level_modelling_and_archetypes">4.1.1. Multi-level Modelling and Archetypes</a></li>
<li><a href="#_consequences_for_software_engineering">4.1.2. Consequences for Software Engineering</a></li>
</ul>
</li>
<li><a href="#_separation_of_responsibilities">4.2. Separation of Responsibilities</a></li>
<li><a href="#_separation_of_viewpoints">4.3. Separation of Viewpoints</a></li>
</ul>
</li>
<li><a href="#_openehr_specification_structure">5. openEHR Specification Structure</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">5.1. Overview</a></li>
<li><a href="#_consolidated_package_structure">5.2. Consolidated Package Structure</a></li>
<li><a href="#_base_component_base">5.3. Base Component (BASE)</a>
<ul class="sectlevel3">
<li><a href="#_foundation_types">5.3.1. Foundation Types</a></li>
<li><a href="#_base_types">5.3.2. Base Types</a></li>
<li><a href="#_resource_model">5.3.3. Resource Model</a></li>
</ul>
</li>
<li><a href="#_languages_component_lang">5.4. Languages Component (LANG)</a>
<ul class="sectlevel3">
<li><a href="#_basic_meta_model_bmm">5.4.1. Basic Meta-Model (BMM)</a></li>
<li><a href="#_object_data_instance_notation_odin">5.4.2. Object Data Instance Notation (ODIN)</a></li>
<li><a href="#_expression_language_el">5.4.3. Expression Language (EL)</a></li>
</ul>
</li>
<li><a href="#_reference_model_component_rm">5.5. Reference Model Component (RM)</a>
<ul class="sectlevel3">
<li><a href="#_package_overview">5.5.1. Package Overview</a>
<ul class="sectlevel4">
<li><a href="#_support_information_model">5.5.1.1. Support Information Model</a></li>
<li><a href="#_data_types_information_model">5.5.1.2. Data Types Information Model</a></li>
<li><a href="#_data_structures_information_model">5.5.1.3. Data Structures Information Model</a></li>
<li><a href="#_common_information_model">5.5.1.4. Common Information Model</a></li>
<li><a href="#_security_information_model">5.5.1.5. Security Information Model</a></li>
<li><a href="#_ehr_information_model">5.5.1.6. EHR Information Model</a></li>
<li><a href="#_ehr_extract_information_model">5.5.1.7. EHR Extract Information Model</a></li>
<li><a href="#_integration_information_model">5.5.1.8. Integration Information Model</a></li>
<li><a href="#_demographics_information_model">5.5.1.9. Demographics Information Model</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_archetype_model_component_am">5.6. Archetype Model Component (AM)</a></li>
<li><a href="#_service_model_sm">5.7. Service Model (SM)</a>
<ul class="sectlevel3">
<li><a href="#_definitions_service">5.7.1. Definitions Service</a></li>
<li><a href="#_ehr_service">5.7.2. EHR Service</a></li>
<li><a href="#_query_service">5.7.3. Query Service</a></li>
<li><a href="#_terminology_interface">5.7.4. Terminology Interface</a></li>
</ul>
</li>
<li><a href="#_global_view">5.8. Global View</a></li>
</ul>
</li>
<li><a href="#_design_of_the_openehr_ehr">6. Design of the openEHR EHR</a>
<ul class="sectlevel2">
<li><a href="#_the_ehr_system">6.1. The EHR System</a>
<ul class="sectlevel3">
<li><a href="#_system_identity">6.1.1. System Identity</a></li>
<li><a href="#_information_architecture">6.1.2. Information Architecture</a></li>
</ul>
</li>
<li><a href="#_top_level_information_structures">6.2. Top-level Information Structures</a></li>
<li><a href="#_the_ehr">6.3. The EHR</a></li>
<li><a href="#_entries_and_clinical_statements">6.4. Entries and Clinical Statements</a>
<ul class="sectlevel3">
<li><a href="#_entry_subtypes">6.4.1. Entry Subtypes</a>
<ul class="sectlevel4">
<li><a href="#_ontology_of_entry_types">6.4.1.1. Ontology of Entry Types</a></li>
<li><a href="#_clinical_statement_status_and_negation">6.4.1.2. Clinical Statement Status and Negation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_managing_interventions">6.5. Managing Interventions</a></li>
<li><a href="#_time_in_the_ehr">6.6. Time in the EHR</a></li>
<li><a href="#_language">6.7. Language</a></li>
</ul>
</li>
<li><a href="#_security_and_confidentiality">7. Security and Confidentiality</a>
<ul class="sectlevel2">
<li><a href="#_requirements">7.1. Requirements</a>
<ul class="sectlevel3">
<li><a href="#_privacy_confidentiality_and_consent">7.1.1. Privacy, Confidentiality and Consent</a></li>
<li><a href="#_requirements_of_healthcare_providers">7.1.2. Requirements of Healthcare Providers</a></li>
<li><a href="#_specifying_access_control">7.1.3. Specifying Access Control</a></li>
<li><a href="#_the_problem_of_roles">7.1.4. The Problem of Roles</a></li>
<li><a href="#_usability">7.1.5. Usability</a></li>
</ul>
</li>
<li><a href="#_threats_to_security_and_privacy">7.2. Threats to Security and Privacy</a></li>
<li><a href="#_solutions_provided_by_openehr">7.3. Solutions Provided by openEHR</a>
<ul class="sectlevel3">
<li><a href="#_overview_4">7.3.1. Overview</a></li>
<li><a href="#_security_policy">7.3.2. Security Policy</a>
<ul class="sectlevel4">
<li><a href="#_general">7.3.2.1. General</a></li>
<li><a href="#_access_control">7.3.2.2. Access Control</a></li>
</ul>
</li>
<li><a href="#_integrity">7.3.3. Integrity</a>
<ul class="sectlevel4">
<li><a href="#_versioning">7.3.3.1. Versioning</a></li>
<li><a href="#_digital_signature">7.3.3.2. Digital Signature</a></li>
</ul>
</li>
<li><a href="#_anonymity">7.3.4. Anonymity</a></li>
</ul>
</li>
<li><a href="#_access_control_2">7.4. Access Control</a>
<ul class="sectlevel3">
<li><a href="#_overview_5">7.4.1. Overview</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_versioning_2">8. Versioning</a>
<ul class="sectlevel2">
<li><a href="#_overview_6">8.1. Overview</a></li>
<li><a href="#_the_configuration_management_paradigm">8.2. The Configuration Management Paradigm</a>
<ul class="sectlevel3">
<li><a href="#_organisation_of_the_repository">8.2.1. Organisation of the Repository</a></li>
<li><a href="#_change_management">8.2.2. Change Management</a></li>
</ul>
</li>
<li><a href="#_managing_changes_in_time">8.3. Managing Changes in Time</a>
<ul class="sectlevel3">
<li><a href="#_general_model_of_a_change_controlled_repository">8.3.1. General Model of a Change-controlled Repository</a></li>
</ul>
</li>
<li><a href="#_the_virtual_version_tree">8.4. The Virtual Version Tree</a></li>
</ul>
</li>
<li><a href="#_identification">9. Identification</a>
<ul class="sectlevel2">
<li><a href="#_identification_of_the_ehr">9.1. Identification of the EHR</a></li>
<li><a href="#_identification_of_items_within_the_ehr">9.2. Identification of Items within the EHR</a>
<ul class="sectlevel3">
<li><a href="#_general_scheme">9.2.1. General Scheme</a></li>
<li><a href="#_levels_of_identification">9.2.2. Levels of Identification</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_archetypes_and_templates">10. Archetypes and Templates</a>
<ul class="sectlevel2">
<li><a href="#_overview_7">10.1. Overview</a></li>
<li><a href="#_archetype_formalisms_and_models">10.2. Archetype Formalisms and Models</a>
<ul class="sectlevel3">
<li><a href="#_overview_8">10.2.1. Overview</a></li>
<li><a href="#_design_time_relationships_between_archetypes">10.2.2. Design-time Relationships between Archetypes</a></li>
</ul>
</li>
<li><a href="#_relationship_of_archetypes_and_templates_to_data">10.3. Relationship of Archetypes and Templates to Data</a></li>
<li><a href="#_archetype_enabling_of_reference_model_data">10.4. Archetype-enabling of Reference Model Data</a></li>
<li><a href="#_archetypes_templates_and_paths">10.5. Archetypes, Templates and Paths</a></li>
<li><a href="#_archetypes_and_templates_at_runtime">10.6. Archetypes and Templates at Runtime</a>
<ul class="sectlevel3">
<li><a href="#_overview_9">10.6.1. Overview</a></li>
<li><a href="#_deploying_archetypes_and_templates">10.6.2. Deploying Archetypes and Templates</a></li>
<li><a href="#_validation_during_data_capture">10.6.3. Validation during Data Capture</a></li>
<li><a href="#_querying">10.6.4. Querying</a></li>
</ul>
</li>
<li><a href="#_the_openehr_archetypes">10.7. The openEHR Archetypes</a></li>
</ul>
</li>
<li><a href="#_paths_and_locators">11. Paths and Locators</a>
<ul class="sectlevel2">
<li><a href="#_overview_10">11.1. Overview</a></li>
<li><a href="#_paths">11.2. Paths</a>
<ul class="sectlevel3">
<li><a href="#_basic_syntax">11.2.1. Basic Syntax</a></li>
<li><a href="#_predicate_expressions">11.2.2. Predicate Expressions</a>
<ul class="sectlevel4">
<li><a href="#_overview_11">11.2.2.1. Overview</a></li>
<li><a href="#_archetype_path_predicate">11.2.2.2. Archetype path Predicate</a></li>
<li><a href="#_name_based_predicate">11.2.2.3. Name-based Predicate</a></li>
<li><a href="#_other_predicates">11.2.2.4. Other Predicates</a></li>
</ul>
</li>
<li><a href="#_paths_within_top_level_structures">11.2.3. Paths within Top-level Structures</a></li>
<li><a href="#_data_paths_and_uniqueness">11.2.4. Data Paths and Uniqueness</a>
<ul class="sectlevel4">
<li><a href="#_using_a_uid_based_predicate">11.2.4.1. Using a Uid-based Predicate</a></li>
<li><a href="#_using_a_name_based_predicate">11.2.4.2. Using a Name-based Predicate</a></li>
<li><a href="#_using_positional_parameters">11.2.4.3. Using Positional Parameters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ehr_uris">11.3. EHR URIs</a>
<ul class="sectlevel3">
<li><a href="#_ehr_reference_uris">11.3.1. EHR Reference URIs</a>
<ul class="sectlevel4">
<li><a href="#_ehr_location">11.3.1.1. EHR Location</a></li>
<li><a href="#_top_level_structure_locator">11.3.1.2. Top-level Structure Locator</a></li>
<li><a href="#_item_uris">11.3.1.3. Item URIs</a></li>
<li><a href="#_relative_uris">11.3.1.4. Relative URIs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_terminology_in_openehr">12. Terminology in openEHR</a>
<ul class="sectlevel2">
<li><a href="#_overview_12">12.1. Overview</a></li>
<li><a href="#_terminology_to_support_the_reference_model">12.2. Terminology to Support the Reference Model</a></li>
<li><a href="#_archetype_internal_terminology">12.3. Archetype Internal Terminology</a></li>
<li><a href="#_binding_to_external_terminologies">12.4. Binding to External Terminologies</a>
<ul class="sectlevel3">
<li><a href="#_binding_external_terminology_codes_to_archetype_codes">12.4.1. Binding External Terminology Codes to Archetype Codes</a>
<ul class="sectlevel4">
<li><a href="#_binding_terminology_value_sets_to_archetypes">12.4.1.1. Binding Terminology Value-sets to Archetypes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_querying_using_external_terminologies">12.5. Querying using External Terminologies</a></li>
</ul>
</li>
<li><a href="#_deployment">13. Deployment</a>
<ul class="sectlevel2">
<li><a href="#_5_tier_system_architecture">13.1. 5-tier System Architecture</a></li>
</ul>
</li>
<li><a href="#_integrating_openehr_with_other_systems">14. Integrating openEHR with other Systems</a>
<ul class="sectlevel2">
<li><a href="#_overview_13">14.1. Overview</a></li>
<li><a href="#_integration_archetypes">14.2. Integration Archetypes</a></li>
<li><a href="#_data_conversion_architecture">14.3. Data Conversion Architecture</a></li>
</ul>
</li>
<li><a href="#_relationship_to_standards">15. Relationship to Standards</a>
<ul class="sectlevel2">
<li><a href="#_standards_by_which_openehr_can_be_evaluated">15.1. Standards by which openEHR can be evaluated</a></li>
<li><a href="#_standards_which_have_influenced_the_design_of_openehr_specifications">15.2. Standards which have influenced the design of openEHR specifications</a></li>
<li><a href="#_standards_which_have_influenced_the_design_of_openehr_archetypes">15.3. Standards which have influenced the design of openEHR archetypes</a></li>
<li><a href="#_standards_which_are_used_inside_openehr">15.4. Standards which are used "inside" openEHR</a></li>
<li><a href="#_standards_which_require_a_conversion_gateway">15.5. Standards which require a conversion gateway</a></li>
<li><a href="#_generic_technology_standards">15.6. Generic Technology Standards</a></li>
</ul>
</li>
<li><a href="#_implementation_technology_specifications">16. Implementation Technology Specifications</a>
<ul class="sectlevel2">
<li><a href="#_overview_14">16.1. Overview</a></li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_openehr_architecture_overview" class="sect0"><a class="anchor" href="#_openehr_architecture_overview"></a>openEHR Architecture Overview</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: BASE latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: STABLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: EHR, openehr, architecture</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2003 - 2020 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/BASE/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser, Implementer</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>BASE Release 1.?.? (unreleased)</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>1.2.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECPUB-7" target="_blank" rel="noopener">SPECPUB-7</a>: Convert citations to bibtex form;<br>
 <a href="https://specifications.openehr.org/tickets/SPECBASE-24" target="_blank" rel="noopener">SPECBASE-24</a>: Improve specifications block diagram and related explanations in sections 2 and 5.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>18 Jan 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-88" target="_blank" rel="noopener">SPECRM-88</a>. Improve documentation relating to use of <code><em>uid</em></code> in versioning and <code>LOCATABLE</code> descendants in <code>change_control</code> package (addresses <a href="https://specifications.openehr.org/tickets/SPECPR-322" target="_blank" rel="noopener">SPECPR-322</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
 M Polajnar,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Oct 2019</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>BASE Release 1.1.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECBASE-21" target="_blank" rel="noopener">SPECBASE-21</a>. Update Architecture Overview with new LANG component, and improved explanation of ITS. Improve package structure description. Replace some diagrams.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26 Nov 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-80" target="_blank" rel="noopener">SPECRM-80</a>. Improve description of <code><em>system_id</em></code> field in <code>EHR</code>, <code>AUDIT_DETAILS</code> and <code>FEEDER_AUDIT_DETAILS</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Frankel,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-78" target="_blank" rel="noopener">SPECRM-78</a>: Improve documentation on 'plain text' EHR URIs.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Frankel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22 Nov 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECBASE-18" target="_blank" rel="noopener">SPECBASE-18</a>. Update text in Common IM to latest openPGP specification.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17 May 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECBASE-16" target="_blank" rel="noopener">SPECBASE-16</a>. Update Architecture Overview with current high-level elements.
 Section 5.3.4: Added text indicating BMM usage and alternatives.
 Section 11.2.4.2: Added JSON format version of example.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E Sundvall,
 S Iancu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Nov 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECBASE-15" target="_blank" rel="noopener">SPECBASE-15</a>. Add Foundation Types specification to BASE;<br>
 <a href="https://specifications.openehr.org/tickets/SPECBASE-7" target="_blank" rel="noopener">SPECBASE-7</a>. Add Base Types specification to BASE.<br>
 <a href="https://specifications.openehr.org/tickets/SPECBASE-16" target="_blank" rel="noopener">SPECBASE-16</a>. Update Architecture Overview with current high-level elements.<br>
 Section 2: Updated overview diagram and description to be based on 'components' as per current specifications program;<br>
 Section 5: Updated package diagrams to exported diags from BASE, RM, AM, SM UML components;<br>
 Section 7.4.1: small updates to statements to make them more current; fixed some references to ISO standards.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Sep 2017</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>BASE Release 1.0.3</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-33" target="_blank" rel="noopener">SPECRM-33</a>. Clarify specification of DV_EHR_URI scheme. (solves <a href="https://specifications.openehr.org/tickets/SPECPR-48" target="_blank" rel="noopener">SPECPR-48</a>, <a href="https://specifications.openehr.org/tickets/SPECPR-50" target="_blank" rel="noopener">SPECPR-50</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Frankel,<br>
 E Sundvall,<br>
 B Lah,<br>
 S Iancu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07 Dec 2015</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-27" target="_blank" rel="noopener">SPECRM-27</a>. Relax unique name rule in <code>LOCATABLE</code>: change text of sections 11.2.2 and 11.2.4.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Frankel,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-25" target="_blank" rel="noopener">SPECRM-25</a>. Corrections to Architecture Overview specification: text in section 9.2.2 about <code>LOCATABLE_REF</code> referred to wrong specification.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECRM-28" target="_blank" rel="noopener">SPECRM-28</a>. Corrections to EHR and Common IM documentation.<br>
 <a href="https://specifications.openehr.org/tickets/SPECPR-2" target="_blank" rel="noopener">SPECPR-2</a>. Changes to Architecture Overview section 5.2.1.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R Erens</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0.2</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-249" target="_blank" rel="noopener">SPEC-249</a>. Paths and locators minor errors in Architecture Overview and Common IM. Typos corrected in sections 9.2.2 and 11.3.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C Ma,<br>
 T Beale<br>
 R Chen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13 Nov 2008</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-257" target="_blank" rel="noopener">SPEC-257</a>: Correct minor typos and clarify text. Section 9.2.1 para 1 line 2: with -&#8594; within.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C Ma,<br>
 R Chen,<br>
 T Cook</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-284" target="_blank" rel="noopener">SPEC-284</a>: Correct inconsistencies in naming of <code><em>term_definitions</em></code>, <code><em>constraint_definitions</em></code>, <code><em>term_bindings</em></code>, <code><em>constraint_bindings</em></code> attributes in XML-schema and specifications.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Torrisi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0.1</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-200" target="_blank" rel="noopener">SPEC-200</a>: Correct package names in RM diagram.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D Lloyd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12 Apr 2007</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-130" target="_blank" rel="noopener">SPEC-130</a>: Correct security details in <code>LOCATABLE</code> and <code>ARCHETYPED</code> classes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-203" target="_blank" rel="noopener">SPEC-203</a>: Release 1.0 explanatory text improvements.  Improved path explanation. Slight re-ordering of main headings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale<br>
 G Grieve<br>
 T Shannon<br>
 H van der Linden</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path shortcuts.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Frankel</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added configuration management and versioning material from Common IM.<br>
 Added section on ontological landscape.<br>
 Added section on aims.<br>
 Added section on systems architectures.<br>
 Added section on security.<br>
 Added section on system integration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added section on terminology.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale<br>
 S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial Writing - content taken from Roadmap document.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-147" target="_blank" rel="noopener">SPEC-147</a>. Make <code>DIRECTORY</code> Re-usable<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-167" target="_blank" rel="noopener">SPEC-167</a>. Move AOM description package to <code>resource</code> package in Common IM.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-185" target="_blank" rel="noopener">SPEC-185</a>. Improved EVENT model.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">29 Jan 2006</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The work reported in this paper has been funded in by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>University College London - Centre for Health Informatics and Multi-professional Education (CHIME);</p>
</li>
<li>
<p>Ocean Informatics.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Special thanks to David Ingram, Emeritus Professor of Health Informatics at UCL who provided a vision and collegial working environment ever since the days of GEHR (1992).</p>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a trademark of the openEHR Foundation</p>
</li>
<li>
<p>'Java' is a registered trademark of Oracle Corporation</p>
</li>
<li>
<p>'Microsoft' and '.Net' are trademarks of the Microsoft Corporation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document provides an overview of the openEHR architecture in terms of a model overview, key global semantics, deployment and integration architectures, relationship to published standards, and finally the approach to building Implementation Technology Specifications (ITSs). Semantics specific to each information, archetype and service model are described in the relevant specification.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>The open source healthcare community;</p>
</li>
<li>
<p>Solution vendors.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This document is the key technical overview of openEHR, and should be read before all other technical documents.</p>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.2. Status</h3>
<div class="paragraph">
<p>This specification is in the STABLE state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.3. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://forums.openehr.org/c/specifications" target="_blank" rel="noopener">technical mailing list</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/BASE/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/BASE/history" target="_blank" rel="noopener">BASE component Change Request tracker</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document provides an overview of the openEHR architecture. It commences with a description of the specification project, followed by an overview of the model structure and packages. Key global semantics including security, archetyping, identification, version and paths are then described. The relationship to published standards is described, and finally, the approach to building implementations is outlined.</p>
</div>
<div class="sect2">
<h3 id="_the_openehr_specification_program"><a class="anchor" href="#_the_openehr_specification_program"></a>2.1. The openEHR Specification Program</h3>
<div class="paragraph">
<p>The <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a> is responsible for developing the specifications of openEHR, from which the openEHR Health Computing Platform is implemented. The outputs of the program consist of a number of <em>components</em>, as shown in the diagram below, with each component (marked in blue) consisting of one or more separate specifications.</p>
</div>
<div id="specification_project" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/openehr_block_diagram.svg" alt="openehr block diagram" width="70%">
</div>
<div class="title">Figure 1. The openEHR Specification project</div>
</div>
<div class="paragraph">
<p>The components in the left group contain the <em>abstract specifications</em> (also known as the 'Platform Independent Model' or PIM) and are divided into the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Foundation (BASE)</strong>: primitive types, definitions, identifiers, other basic types needed across openEHR;</p>
</li>
<li>
<p><strong>Formalisms (LANG, AM, QUERY)</strong>: various generic formalisms, including BMM (Basic Meta-Model), (ADL (Archetype Definition Language) and AQL (Archetype Query Language);</p>
</li>
<li>
<p><strong>Content (TERM, RM)</strong>: the models of primary content of the openEHR platform, including demographics, EHR; supporting openEHR Terminology (along with expressions of various ISO, IETF and other vocabularies (language names, territory names, MIME types, etc) that are not typically published in a directly usable format);</p>
</li>
<li>
<p><strong>Process &amp; CDS (PROC, CDS)</strong>: clinical process and clinical decision support components, containing the Task Planning and GDL (Guideline Definition Language) specifications;</p>
</li>
<li>
<p><strong>Platform Services</strong>: abstract formal APIs defining the interfaces to the openEHR platform.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some of these specifications (e.g. Antlr grammars) are directly usable in software development. Most of the abstract specifications have concrete expressions in formalisms such as JSON, XML schema, openEHR BMM and REST APIs enabling their direct use in development. These are known as Implementation Technology Specifications (ITSs; also known as 'Platform-Specific Models' or PSMs), and are collected in the <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">ITS component</a> shown on the right. They also constitute openEHR&#8217;s <em>interoperability specifications</em>.</p>
</div>
<div class="paragraph">
<p>As implementation technologies change over time the ITS specifications will be replaced, while the main group of abstract specifications will generally only change in response to real-world requirements other than information technology.</p>
</div>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/CNF/latest/index" target="_blank" rel="noopener">CNF component</a> at the top defines <em>conformance criteria</em>, and is primarily based on ITS artefacts such as REST APIs, XSDs, but also upon AQL queries, archetypes and some other abstract artefacts. It includes a formal definition of the notional openEHR Platform and how to test it in a standard way. This is used as the basis for openEHR product certification and also for procurement tender specification.</p>
</div>
<div class="paragraph">
<p>The specifications published by openEHR constitute the <em>primary reference for all openEHR semantics</em>. The presentation style is deliberately intended to be clear and semantically close to the <em>ideas</em> being communicated. Accordingly, the specifications do not follow any particular programming language or idiom, but instead use  various formalisms and illustrations appropriate to each topic.</p>
</div>
<div class="paragraph">
<p>Change control is performed by the <a href="https://www.openehr.org/programs/specification/editorialcommittee" target="_blank" rel="noopener">openEHR Specifications Editorial Committee (SEC)</a>, using a formal process based on Problem Reports (PRs) and Change Reqests (CRs), and a formal release cycle. The details are described in the <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">Specifications Program part of the openEHR website</a>.</p>
</div>
<div class="paragraph">
<p>The openEHR specification documents and related formal artefacts may be found on the <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications home page</a>. The documents are maintained in <a href="http://asciidoctor.org" target="_blank" rel="noopener">Asciidoctor</a> source form, and make significant use of included formal elements, including extracted UML class texts and diagrams, as well as grammar files.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aims_of_the_openehr_architecture"><a class="anchor" href="#_aims_of_the_openehr_architecture"></a>3. Aims of the openEHR Architecture</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>3.1. Overview</h3>
<div class="paragraph">
<p>The openEHR architecture embodies over 20 years of research from numerous projects and standards from
around the world. It has been designed based on requirements captured over many years, including those developed in the <a href="https://www.openehr.org/resources/related_projects#gehr" target="_blank" rel="noopener">EU FP3 Good European Health Record (GEHR) project (1992-1995)</a>.</p>
</div>
<div class="paragraph">
<p>Because the architecture is highly generic, and particularly due to being archetype-driven, it satisfies
many requirements outside the original concept of the 'clinical EHR'. For example, the same reference
architecture can be used for veterinary health or even care of public infrastructure or listed
buildings. This is due to the fact that the reference model embodies only concepts relating to 'service
and administrative events relating to a subject of care'; it is in archetypes and templates that specifics
of the kinds of care events and subjects of care are defined. In another dimension, although one of the
requirements for the openEHR EHR was a 'patient-centric, longitudinal, shared care EHR', it is not
limited to this, and can be used in purely episodic, specialist situations, e.g. as a radiology department
record system. Requirements for various flavours of 'health care record' can be categorised according
to the two dimensions, scope, and kind of subject, as shown below.</p>
</div>
<div id="scope_of_openehr" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/scope_of_openehr.png" alt="scope of openehr" width="65%">
</div>
<div class="title">Figure 2. Structure of Requirements met by openEHR</div>
</div>
<div class="paragraph">
<p>In this figure, each bubble represents a set of requirements, being a superset of all requirements of
bubbles contained within it. Requirements for a generic record of care for any kind of subject in a
local deployment are represented by the top left bubble. The subsequent addition of requirements corresponding
to living subjects and then human subjects is represented by the bubbles down the left side
of the diagram. The requirements represented by the largest bubble on the left hand side correspond to
'local health records for human care', such as radiology records, hospital EPRs and so on. Additional
sets of requirements represented by wider bubbles going across the diagram correspond to extending
the scope of the content of the care record first to a whole subject (resulting in a patient-centric, longitudinal
health record) and then to populations or cohorts of subjects, as done in population health and
research. From the (human) healthcare point of view, the important requirements groups extend all
the way to the bottom row of the diagram.</p>
</div>
<div class="paragraph">
<p>Going down the diagram, requirements corresponding to increasing specificity of subject of care
(from 'any' to 'human') are mostly implemented in openEHR by the use of archetypes. Going across
the diagram, the requirements corresponding to increasing scope of record content (from episodic to
population) are mainly expressed in different deployments, generally going from standalone to a
shared interoperable form. One of the key aspirations for EHRs today is the 'integrated care record'
sought by many health authorities today (see <a href="https://www.iso.org/standard/39525.html">ISO 20514</a> for definition of ICEHR), which provides an informational framework for integrated
shared care.</p>
</div>
<div class="paragraph">
<p>As a result of the approach taken by openEHR, components and applications built to satisfy the
requirements of an integrated shared care record can also be deployed as (for example) an episodic
radiology record system.</p>
</div>
<div class="paragraph">
<p>Some of the key requirements developed during the evolution of GEHR to openEHR are listed in the
following sections, corresponding to some of the major requirements groups of <a href="#scope_of_openehr">Figure 2</a>.</p>
</div>
<div class="sect3">
<h4 id="_generic_care_record_requirements"><a class="anchor" href="#_generic_care_record_requirements"></a>3.1.1. Generic Care Record Requirements</h4>
<div class="paragraph">
<p>The openEHR requirements include the following, corresponding to a basic, generic record of care:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>prioritisation of the patient / carer interaction (over e.g. research use of the record);</p>
</li>
<li>
<p>suitable for all care settings (primary, acute etc.);</p>
</li>
<li>
<p>medico-legal faithfulness, traceability, audit-trailing;</p>
</li>
<li>
<p>technology &amp; data format independence;</p>
</li>
<li>
<p>highly maintainable and flexible software;</p>
</li>
<li>
<p>support for clinical data structures: lists, tables, time-series, including point and interval events.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_health_care_record_epr"><a class="anchor" href="#_health_care_record_epr"></a>3.1.2. Health Care Record (EPR)</h4>
<div class="paragraph">
<p>The following requirements addressed in openEHR correspond to a local health record, or EPR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>support for all aspects of pathology data, including normal ranges, alternative systems of units etc.;</p>
</li>
<li>
<p>supports all natural languages, as well as translations between languages in the record;</p>
</li>
<li>
<p>integrates with any/multiple terminologies.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_shared_care_ehr"><a class="anchor" href="#_shared_care_ehr"></a>3.1.3. Shared Care EHR</h4>
<div class="paragraph">
<p>The following requirements addressed in openEHR correspond to an integrated shared care EHR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>support for patient privacy, including anonymous EHRs;</p>
</li>
<li>
<p>facilitate sharing of EHRs via interoperability at data and knowledge levels;</p>
</li>
<li>
<p>compatibility with <a href="https://www.iso.org/standard/40784.html">ISO 13606</a>, Corbamed, and messaging systems;</p>
</li>
<li>
<p>support semi-automated and automated distributed workflows.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_clinical_aims"><a class="anchor" href="#_clinical_aims"></a>3.2. Clinical Aims</h3>
<div class="paragraph">
<p>From a more specifically clinical care perspective (rather than a record-keeping perspective), the following requirements have been identified during the development of openEHR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The need for a patient-centric, lifelong electronic health record that entails a holistic view of patient needs as opposed to niche problem-solving and decision-support techniques for limited diagnostic purposes;</p>
</li>
<li>
<p>Integration of different views of the patient (GP, emergency and acute care, pathology, radiology, computerised patient-order entry, etc.) with the vast body of available knowledge resources (terminologies, clinical guidelines and computerised libraries);</p>
</li>
<li>
<p>Clinical decision-support to improve patient safety and reduced costs through repeated medical investigations;</p>
</li>
<li>
<p>Access to standards-based computing applications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Integrated Care EHR holds great promise: to generalise and make widely available the benefits
of computerisation that have been demonstrated individually and in isolated settings. These can be
summarised as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reducing adverse events arising from medication errors such as interactions, duplications or inappropriate treatments and the flow-on costs associated with these;</p>
</li>
<li>
<p>Improving the timely access to critical information and reduced clinician time searching for information;</p>
</li>
<li>
<p>Reducing the incidence of patients being overlooked in the healthcare system due to information not being communicated;</p>
</li>
<li>
<p>Reducing the duplication of investigations and other tests and procedures due to results not being available in the local computing environment;</p>
</li>
<li>
<p>Improved prevention and early detection, based on predictive risk factor analysis, which is possible with quality EHR data;</p>
</li>
<li>
<p>Improved decision making through decision support tools with access to the patients whole EHR;</p>
</li>
<li>
<p>Improving access to and computation of evidence based guidelines;</p>
</li>
<li>
<p>Increasing targeted health initiatives known to be effective, based on patient criteria; and</p>
</li>
<li>
<p>Reduced hospitalisations and readmissions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One comprehensive statement of EHR requirements covering many of the above is the <a href="https://www.iso.org/standard/52823.html">ISO 18308, ISO Technical Report 18308</a> for which an <a href="https://specifications.openehr.org/releases/1.0.2/architecture/requirements/iso18308_conformance.pdf" target="_blank" rel="noopener">openEHR profile has been created</a>. The requirements summarised above are described in more detail in the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">openEHR EHR Information Model specification</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deployment_environments"><a class="anchor" href="#_deployment_environments"></a>3.3. Deployment Environments</h3>
<div class="paragraph">
<p>Ultimately any software and information architecture only provides utility when deployed. The architecture of openEHR is designed to support the construction of a number of types of system. One of the most important, the integrated shared care health record is illustrated in the figure below.</p>
</div>
<div id="shared_ehr" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/shared_ehr.svg" alt="shared ehr" width="70%">
</div>
<div class="title">Figure 3. Community Shared-care Context</div>
</div>
<div class="paragraph">
<p>In this form, the openEHR services are added to the existing IT infrastructure to provide a shared, secure health record for patients that are seen by any number of health providers in their community context. openEHR-enabled systems can also be used to provide EMR/EPR functionality at provider locations. Overall, a number of important categories of system can be implemented using openEHR including the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>shared-care community or regional health service EHRs;</p>
</li>
<li>
<p>summary EHRs at a national, state, province or similar level;</p>
</li>
<li>
<p>small desktop GP systems;</p>
</li>
<li>
<p>hospital EMRs;</p>
</li>
<li>
<p>consolidated and summary EHRs in federation environments;</p>
</li>
<li>
<p>legacy data purification and validation gateways;</p>
</li>
<li>
<p>web-based secure EHR systems for mobile patients.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Systems containing health records in anonymised or pseudonymised form can also be implemented, since the openEHR architecture defines an EHR in which  demographic links (e.g. to national registry, or via national healthcare number) are optional. Where such links are used in the institutional EMR or shared EHR context, they can easily be removed in an anonymisation process.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_principles"><a class="anchor" href="#_design_principles"></a>4. Design Principles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The openEHR approach to modelling information, services and domain knowledge is based on a
number of design principles, described below. The application of these principles leads to a separation
of the models of the openEHR architecture, and consequently, a high level of componentisation. This
leads to better maintainability, extensibility, and flexible deployment.</p>
</div>
<div class="sect2">
<h3 id="_ontological_separation"><a class="anchor" href="#_ontological_separation"></a>4.1. Ontological Separation</h3>
<div class="paragraph">
<p>The most basic kind of distinction in any system of models is ontological, i.e. in the levels of abstraction
of description of the real world. All models carry some kind of semantic content, but not all
semantics are the same, or even of the same category. For example, some part of the <a href="http://www.ihtsdo.org" target="_blank" rel="noopener">SNOMED CT</a>
terminology describes types of bacterial infection, sites in the body, and symptoms. An information
model might specify a logical type Quantity. A content model might define the model of information
collected in an ante-natal examination by a physician. These types of 'information' are qualitatively
different, and need to be developed and maintained separately within the overall model eco-system.
The figure below illustrates these distinctions, and indicates what parts are built directly into software
and databases.</p>
</div>
<div id="ontological_landscape" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/ontological_landscape.png" alt="ontological landscape" width="80%">
</div>
<div class="title">Figure 4. The Ontological Landscape</div>
</div>
<div class="paragraph">
<p>This figure shows a primary separation between 'ontologies of information' i.e. models of information
content, and 'ontologies of reality' i.e. descriptions and classifications of real phenomena. These
two categories have to be separated because the type of authors, the representation and the purposes
are completely different. In health informatics, this separation already exists by and large, due to the
development of terminologies and classifications.</p>
</div>
<div class="paragraph">
<p>A secondary ontological separation within the information side is shown between information models
and domain content models. The former category corresponds to semantics that are <em>invariant</em> across
the domain (e.g. basic data types like coded terms, data structures like lists, identifiers), while the latter
corresponds to <em>variable</em> domain level content descriptions - descriptions of information structures
such as 'microbiology result' rather than descriptions of actual phenomena in the real world (such as
infection by a microbe). This separation is not generally well understood, and historically, a great deal
of domain-level semantics has been hard-wired into the software and databases, leading to relatively
unmaintainable systems.</p>
</div>
<div class="paragraph">
<p>By clearly separating the three categories - information models, domain content models, and terminologies
- the openEHR architecture enables each to have a well-defined, limited scope and clear
interfaces. This limits the dependence of each on the other, leading to more maintainable and adaptable
systems.</p>
</div>
<div class="sect3">
<h4 id="_multi_level_modelling_and_archetypes"><a class="anchor" href="#_multi_level_modelling_and_archetypes"></a>4.1.1. Multi-level Modelling and Archetypes</h4>
<div class="paragraph">
<p>One of the key paradigms on which openEHR is based is known as <em>multi-level modelling</em>, originally described in <a href="#Beale2002">Beale (2002)</a> as 'two-level modelling'. Under the multi-level approach, there are three levels of models required for a system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>reference model (RM)</em>: a stable reference information model constitutes the first level of modelling;</p>
</li>
<li>
<p><em>re-usable content element definitions</em>: formal definitions of clinical content data points and groups, in the form of <a href="https://specifications.openehr.org/releases/AM/latest/index" target="_blank" rel="noopener"><em>archetypes</em></a>;</p>
</li>
<li>
<p><em>context-specific data set definitions</em>: formal definitions of use-case specific data sets used for forms, documents, messages etc, created by combining required elements of relevant archetypes into openEHR <a href="https://specifications.openehr.org/releases/AM/latest/Overview.html#_templates" target="_blank" rel="noopener"><em>templates</em></a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only the first level (the Reference Model) is implemented in software, significantly reducing the dependency of deployed systems and data on variable content definitions. The only other parts of the model universe implemented in software are highly stable languages/models of representation (shown at the bottom of <a href="#ontological_landscape">Figure 4</a>). As a consequence, systems have the possibility of being far smaller and more maintainable than 'single-level' systems, in which all semantics are expressed in one model (typically a UML class model or DB schema). Archetype-based systems are also inherently self-adapting, since they are built to consume archetypes and templates as they are developed into the future.</p>
</div>
<div class="paragraph">
<p>Archetypes and templates also act as a well-defined semantic gateway to terminologies, classifications and computerised clinical guidelines. The alternative in the past has been to try to make systems function solely with a combination of hard-wired software and terminology. This approach is flawed, since terminologies dont contain definitions of domain content (e.g. 'microbiology result'), but rather facts about the real world (e.g. kinds of microbes and the effects of infection in humans); in other words, they are ontological artefacts, whereas archetypes are epistemological artefacts.</p>
</div>
<div class="paragraph">
<p>The use of archetyping in openEHR engenders new relationships between information and models, as shown in the following figure.</p>
</div>
<div id="archetype_meta_architecture" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/archetype_meta_architecture.svg" alt="archetype meta architecture" width="80%">
</div>
<div class="title">Figure 5. Archetype Meta-architecture</div>
</div>
<div class="paragraph">
<p>In this figure, 'data' as we know it in normal information systems (shown on the bottom left) conforms in the usual way to an object model (top left). Systems engineered in the 'classic' way (i.e. all domain semantics are encoded somewhere in the software or database) are limited to this kind of architecture. With the use of multi-level modelling, runtime data now conform semantically to archetypes as well as concretely to the reference model. All archetypes are expressed in a generic <a href="https://specifications.openehr.org/releases/AM/latest/ADL2.html">Archetype Definition Language (ADL)</a>, which is the basis of <a href="https://www.iso.org/standard/62305.html">ISO standard 13606-2</a>.</p>
</div>
<div class="paragraph">
<p>The details of how archetypes and templates work in openEHR are described in the <a href="#_archetypes_and_templates">Section 10</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_consequences_for_software_engineering"><a class="anchor" href="#_consequences_for_software_engineering"></a>4.1.2. Consequences for Software Engineering</h4>
<div class="paragraph">
<p>Multi-level modelling significantly changes the dynamics of the systems development process. In the usual IT-intensive process, requirements are gathered via ad hoc discussions with users (typically via the well-known 'use case' methodology), designs and models built from the requirements, implementation proceeds from the design, followed by testing and deployment and ultimately the maintenance part of the lifecycle. This is usually characterised by ongoing high costs of implementation change and/or a widening gap between system capabilities and the requirements at any moment. The approach also suffers from the fact that ad hoc conversations with systems users nearly always fails to reveal underlying content and workflow. Under the multi-level paradigm, the core part of the system is based on the reference and archetype models (includes generic logic for storage, querying, caching etc.), both of which are extremely stable, while domain semantics are mostly delegated to domain specialists who work building archetypes (reusable), templates (local use) and terminology (general use). The process is illustrated in the following figure. Within this process, IT developers concentrate on generic components such as data management and interoperability, while groups of domain experts work outside the software development process, generating definitions that are used by systems at runtime.</p>
</div>
<div id="multi_level_modelling" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/multi_level_modelling.svg" alt="multi level modelling">
</div>
<div class="title">Figure 6. Multi-level Modelling and Software Engineering</div>
</div>
<div class="paragraph">
<p>Clearly applications cannot always be totally generic (although many data capture and viewing applications are); decision support, administrative, scheduling and many other applications still require custom engineering. However, all such applications can now rely on an archetype- and template-driven computing platform. A key result of this approach is that archetypes now constitute a technology-independent, single-source expression of domain semantics, used to drive database schemas, software logic, GUI screen definitions, message schemas and all other technical expressions of the semantics.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_separation_of_responsibilities"><a class="anchor" href="#_separation_of_responsibilities"></a>4.2. Separation of Responsibilities</h3>
<div class="paragraph">
<p>A second design paradigm used in openEHR is that of separation of responsibilities within the computing environment. Complex domains are only tractable if the functionality is first partitioned into broad areas of interest, i.e. into a 'system of systems' (<a href="#Maier2000">Maier&#44; 2000</a>). This principle has been understood in computer science for a long time under the rubrics 'low coupling', 'encapsulation' and 'componentisation', and was the driver for the explosion of object-oriented languages, libraries and frameworks.</p>
</div>
<div class="paragraph">
<p>When applied to larger systems, such as that needed to run a hospital or regional health network, the modern form of the paradigm is Services Oriented Architecture (SOA), whereby the components of the system are coarse-grained services. In this approach, each area of functionality is formally modelled and implemented as a self-standing service with a defined interface.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates a healthcare services environment containing services at three <em>deployment levels</em>: provider organisation (hospital, clinic, etc); care network (e.g. regional health service, but also non-geographical HMO); and national. These levels may be understood as relating to three perspectives of care (indicated by the larger grey text):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>healthcare delivery</em>: what happens at a provider enterprise, such as a clinic or hospital;</p>
</li>
<li>
<p><em>continuity of care</em>: the passage of the patient through multiple clinics and encounters to achieve a care process designed to fulfill a goal;</p>
</li>
<li>
<p><em>healthcare system</em>: the perspective of a national healthcare system, including public health, planning, quality reporting, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within each of these deployment levels there are semantic categories corresponding to data, information, process (planning and logistics) and analytics. From left to right, the services are also classified according to what kind of entity they are concerned with: single patient, healthcare professional (HCP), provider enterprise, or knowledge. The diagram is only partially populated, and is not intended to be either complete or normative in any sense.</p>
</div>
<div id="health_services_environment" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/platform_landscape.svg" alt="platform landscape">
</div>
<div class="title">Figure 7. A Health Services Environment</div>
</div>
<div class="paragraph">
<p>E-health services at the care network level are emerging, and in many geographies and health organisations, most of the services shown at this level are available only within provider organisations.</p>
</div>
<div class="paragraph">
<p>Services that openEHR is concerned with specifying (including adaptation of published <em>de jure</em> or other standards) are shown in colour, with other services and  applications (e.g. Terminology, patient portal) in grey. As can be seen, the scope of openEHR in terms of services is primarily as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>patient-centric services at the data and process levels in any deployment level;</p>
</li>
<li>
<p>enterprise-centric services within a care network or provider organisation;</p>
</li>
<li>
<p>knowledge services relating to models of content and process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since there are standards available for some aspects of many services, such as terminology, imaging, messages, EHR Extracts, service-based interoperation, and numerous standards for details such as date/time formats and string encoding, the openEHR specifications sometimes act as a mechanism to adapt and integrate existing standards.</p>
</div>
</div>
<div class="sect2">
<h3 id="_separation_of_viewpoints"><a class="anchor" href="#_separation_of_viewpoints"></a>4.3. Separation of Viewpoints</h3>
<div class="paragraph">
<p>The third computing paradigm used in openEHR is a natural consequence of the separation of responsibilities, namely the separation of viewpoints. When responsibilities are divided up among distinct components, it becomes necessary to define a) the information that each processes, and b) how they will communicate. These two aspects of models constitute the two central 'viewpoints' of the <a href="https://en.wikipedia.org/wiki/RM-ODP">ISO RM/ODP model</a>, marked in bold in the following:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Enterprise
</td>
<td class="hdlist2">
<p>concerned with the business activities, i.e. purpose, scope and policies of the specified system.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Information
</td>
<td class="hdlist2">
<p>concerned with the semantics of information that needs to be stored and processed in the system.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Computational
</td>
<td class="hdlist2">
<p>concerned with the description of the system as a set of objects that interact at interfaces - enabling system distribution.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Engineering
</td>
<td class="hdlist2">
<p>concerned with the mechanisms supporting system distribution.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Technological
</td>
<td class="hdlist2">
<p>concerned with the detail of the components from which the distributed system is constructed.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The openEHR specifications accordingly include an information viewpoint - the openEHR Reference Model - and a computational viewpoint - the openEHR Service Model. The Engineering viewpoint corresponds to the <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specifications (ITS)</a>, while the Technological viewpoint corresponds to the technologies and components used in an actual deployment. An important aspect of the division into viewpoints is that there is generally not a 1:1 relationship between model specifications in each viewpoint. For example, there might be a concept of 'health mandate' (see <a href="https://www.iso.org/standard/58102.html">ISO 13940, Continuity of Care concepts</a>) in the enterprise viewpoint. In the information viewpoint, this might have become a model containing many classes. In the computational viewpoint, the information structures defined in the information viewpoint are likely to recur in multiple services, and there may or may not be a
'health mandate' service. The granularity of services defined in the computational viewpoint corresponds most strongly to divisions of function in an enterprise or region, while the granularity of components in the information view points corresponds to the granularity of mental concepts in the problem space, the latter almost always being more fine-grained.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openehr_specification_structure"><a class="anchor" href="#_openehr_specification_structure"></a>5. openEHR Specification Structure</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>5.1. Overview</h3>
<div class="paragraph">
<p>This section provides an overview of the specifications of the openEHR platform components (i.e. the components on the left side of <a href="#specification_project">Figure 1</a>). Each component contains one or more specifications, which come in three types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>language specifications, expressed in Antlr and/or other formal grammars;</p>
</li>
<li>
<p>information models, expressed in UML;</p>
</li>
<li>
<p>service models (APIs), expressed in UML.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The specifications are published as generated documents consisting of text and various formal elements including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>class texts extracted from UML models;</p>
</li>
<li>
<p>diagrams extracted from UML models;</p>
</li>
<li>
<p>grammar files, typically in Antlr4 syntax;</p>
</li>
<li>
<p>EBNF grammars.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The ITS component consists of concrete artefacts of various forms including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API definitions (JSON / Swagger / Apiary etc).</p>
</li>
<li>
<p>XML schemas;</p>
</li>
<li>
<p>JSON schemas;</p>
</li>
<li>
<p>BMM schemas.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_consolidated_package_structure"><a class="anchor" href="#_consolidated_package_structure"></a>5.2. Consolidated Package Structure</h3>
<div class="paragraph">
<p>From the software engineering point of view, the consolidated structure of UML packages from the formal specifications that contain them is useful, and is illustrated below. The top-level packages include: <code>base</code>, <code>lang</code>, <code>rm</code>, <code>am</code>, <code>proc</code> and <code>sm</code>. All packages defining detailed models appear inside one of these outer packages, which are conceptually defined within the <code>org.openehr</code> namespace (also represented in UML as packages). In some implementation technologies (e.g. Java / Maven), the <code>org.openehr</code> namespace is formally used.</p>
</div>
<div class="paragraph">
<p>These packages do not include the specifications for various languages (ADL, AQL, ODIN etc), identification systems, or downstream implementation technology specifications (ITSs), which are included in the corresponding component or else in other components.</p>
</div>
<div id="consolidated_package_structure" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/global_package_structure.svg" alt="global package structure" width="35%">
</div>
<div class="title">Figure 8. Consolidated Package Structure of openEHR</div>
</div>
<div class="paragraph">
<p>In the following sections, diagrams provide a visual association of the various specifications to the top-level UML packages, where it exists.</p>
</div>
</div>
<div class="sect2">
<h3 id="_base_component_base"><a class="anchor" href="#_base_component_base"></a>5.3. Base Component (BASE)</h3>
<div class="paragraph">
<p>The correspondence between the openEHR BASE component specifications and the UML packages is illustrated below. On the right-hand side, the BASE specifications are shown, of which two are based on UML models. These packages fall within the top-level <code>org.openehr.base</code> UML package, as shown on the left side of the figure.</p>
</div>
<div id="spec_component_base" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/spec_component-base.svg" alt="spec component base" width="75%">
</div>
<div class="title">Figure 9. BASE Component of openEHR</div>
</div>
<div class="paragraph">
<p>The <code>base</code> package defines identifiers, data types, data structures and various common design patterns that can be re-used ubiquitously in the <code>rm</code>, <code>am</code> and <code>sm</code> packages. The <code>base</code> packages are shown below.</p>
</div>
<div id="base_packages" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/BASE-packages.svg" alt="BASE packages">
</div>
<div class="title">Figure 10. Structure of <code>org.openehr.base</code> package</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In RM Release 1.0.3 and earlier releases, the contents of the <code>base</code> package resided in the RM <code>support</code> package.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following sub-sections describe the BASE component specifications.</p>
</div>
<div class="sect3">
<h4 id="_foundation_types"><a class="anchor" href="#_foundation_types"></a>5.3.1. Foundation Types</h4>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/foundation_types.html" target="_blank" rel="noopener">Foundation Types specification</a> provides a guide for integrating openEHR models proper into the type systems of implementation technologies. It is specified by the <code>foundations_types</code> package. This contains the special package <code>primitive_types</code>, which describes inbuilt types <em>assumed</em> by openEHR in external type systems. This provides a basis for determining mappings from openEHR to programming languages. For example such as <code>String.<em>is_empty</em></code> in openEHR might be mapped to <code>String.<em>empty()</em></code> in a programming environment.</p>
</div>
<div class="paragraph">
<p>Other foundation types include basic structures (<code>Array&lt;T&gt;</code>, <code>Hash&lt;K,V&gt;</code> etc), time types, and various types enabling functional concepts (principally lambda expressions) to be expressed in the openEHR specifications.</p>
</div>
</div>
<div class="sect3">
<h4 id="_base_types"><a class="anchor" href="#_base_types"></a>5.3.2. Base Types</h4>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/base_types.html" target="_blank" rel="noopener">Base Types specification</a> defines generic openEHR types used in other openEHR components. It is comprised of the <code>definitions</code>, <code>identification</code>, <code>terminology</code> and  <code>measurement</code> sub-packages. The semantics defined in these packages allow all other models to use identifiers and to have access to knowledge services like terminology and other reference data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_resource_model"><a class="anchor" href="#_resource_model"></a>5.3.3. Resource Model</h4>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/resource.html" target="_blank" rel="noopener">Resource Model specification</a> defines a generic 'authored resource' class that carries meta-data relating to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>authorship;</p>
</li>
<li>
<p>copyright, licences and other related meta-data;</p>
</li>
<li>
<p>languages and translations;</p>
</li>
<li>
<p>annotations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The class is used via inheritance to provide types in other models with meta-data to enable instances to be managed as resources with appropriate meta-data.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_languages_component_lang"><a class="anchor" href="#_languages_component_lang"></a>5.4. Languages Component (LANG)</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Until BASE Release 1.1.0, the contents of the LANG component resided in the BASE component.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Languages component contains specifications for a number of generic languages used in openEHR, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ODIN: an object data syntax used in openEHR archetypes (in ADL format), in BMM schemas and generally as a data representation where convenient;</p>
</li>
<li>
<p>BMM: the Basic-Meta Model, a formal, human-readable meta-model language in which other models may be expressed for use with tools;</p>
</li>
<li>
<p>EL: Expression Language, a small specification of predicate logic expressions used in other openEHR specifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following diagram shows the relationship of the UML <code>lang</code> package in the global UML structure (left side) to the LANG component specifications defined in terms of UML (right side).</p>
</div>
<div id="spec_component_lang" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/spec_component-lang.svg" alt="spec component lang" width="80%">
</div>
<div class="title">Figure 11. LANG Component of openEHR</div>
</div>
<div class="sect3">
<h4 id="_basic_meta_model_bmm"><a class="anchor" href="#_basic_meta_model_bmm"></a>5.4.1. Basic Meta-Model (BMM)</h4>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/LANG/latest/bmm.html" target="_blank" rel="noopener">BMM specification</a> defines a generic meta-model, suitable for formally expressing object-oriented models, including those of openEHR (RM etc). It is roughly an equivalent of UML&#8217;s XMI, but fixes various problems with the latter around generic (template) types, while being significantly less complex and fragile. BMM models can be expressed in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">ODIN syntax</a> or any other regular object syntax (JSON etc), and conveniently edited by hand. BMM files are used within tools such as the <a href="https://www.openehr.org/downloads/ADLworkbench" target="_blank" rel="noopener">openEHR ADL Workbench</a> and some of the openEHR tooling software.</p>
</div>
<div class="paragraph">
<p>The BMM is primarily intended to reduce complexity for tools that consume reference model definitions, but is not the only way to implement such tools. Similar tools can be based directly on the openEHR published UML models, as long as typing, template types and qualified attributes are properly handled. Another alternative means of working with models is via software library implementations of the relevant models (openEHR Reference Model etc).</p>
</div>
<div class="paragraph">
<p>Consequently, understanding or use of BMM specification or models based on it is not necessary in order to implement openEHR systems. However BMM provides a convenient format for model processing, e.g. to auto-generate code stubs in a new language.</p>
</div>
</div>
<div class="sect3">
<h4 id="_object_data_instance_notation_odin"><a class="anchor" href="#_object_data_instance_notation_odin"></a>5.4.2. Object Data Instance Notation (ODIN)</h4>
<div class="paragraph">
<p>The <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">ODIN syntax</a> is used to implement faithful machine serialisation and deserialisation of in-memory object graphs, and is a rough equivalent of JSON, YAML and some kinds of XML. It provides more leaf types than any of these, and also supports in-built typing (required to properly represent dynamic binding of polymorphic attributes) and Xpath-like paths.</p>
</div>
</div>
<div class="sect3">
<h4 id="_expression_language_el"><a class="anchor" href="#_expression_language_el"></a>5.4.3. Expression Language (EL)</h4>
<div class="paragraph">
<p>The openEHR expression language (EL) is a formal specification of a subset of first order predicate logic expressions, establishing the formal basis for such expressions in ADL archetypes, GDL guidelines and the Task Planning specification.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reference_model_component_rm"><a class="anchor" href="#_reference_model_component_rm"></a>5.5. Reference Model Component (RM)</h3>
<div class="paragraph">
<p>The openEHR RM component is illustrated below. All of its specifications are UML model-based.</p>
</div>
<div id="spec_component_rm" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/spec_component-rm.svg" alt="spec component rm" width="70%">
</div>
<div class="title">Figure 12. RM Component of openEHR</div>
</div>
<div class="paragraph">
<p>The figure below illustrates the <code>rm</code> package structure. The packages are in two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>domain-related</em>: <code>ehr</code>, <code>demogaphic</code>, <code>ehr_extract</code>, <code>composition</code>, <code>integration</code>;</p>
</li>
<li>
<p><em>generic</em>: <code>common</code>, <code>data_structures</code>, <code>data_types</code>, <code>support</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The packages in the latter group are generic, and are used by all openEHR models, in all the outer packages. Together, they provide identification, access to knowledge resources, data types and structures, versioning semantics, and support for archetyping. The packages in the first group define the semantics of enterprise level health information types, including the EHR and demographics.</p>
</div>
<div id="rm_packages" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/UML/diagrams/RM-packages.svg" alt="RM packages">
</div>
<div class="title">Figure 13. Structure of <code>org.openehr.rm</code> package</div>
</div>
<div class="paragraph">
<p>Each outer package in the above figure corresponds to one openEHR specification document (with the exception of the EHR and Composition packages, which are both described in the EHR Reference Model document), documenting an "information model" (IM). The package structure will normally be replicated in all ITS expressions, e.g. XML schema, programming languages like Java, C# and Eiffel, and interoperability definitions like WSDL, IDL and .Net.</p>
</div>
<div class="sect3">
<h4 id="_package_overview"><a class="anchor" href="#_package_overview"></a>5.5.1. Package Overview</h4>
<div class="paragraph">
<p>The following sub-sections provide a brief overview of the <code>rm</code> sub-packages.</p>
</div>
<div class="sect4">
<h5 id="_support_information_model"><a class="anchor" href="#_support_information_model"></a>5.5.1.1. Support Information Model</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
this part of the RM has been moved to the BASE component; see above.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_data_types_information_model"><a class="anchor" href="#_data_types_information_model"></a>5.5.1.2. Data Types Information Model</h5>
<div class="paragraph">
<p>A set of clearly defined data types underlies all other models, and provides a number of general and
clinically specific types required for all kinds of health information. The following categories of data
types are defined in the data types reference model.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Basic types
</td>
<td class="hdlist2">
<p>boolean, state variable.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Text
</td>
<td class="hdlist2">
<p>plain text, coded text, paragraphs.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Quantities
</td>
<td class="hdlist2">
<p>any ordered type including ordinal values (used for representing symbolic ordered values such as "+", "++", "+++"), measured quantities with values and units, and so on; includes Date/times - date, time, date-time types, and partial date/time types.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Encapsulated data
</td>
<td class="hdlist2">
<p>multimedia, parsable content.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
TIME_specification
</td>
<td class="hdlist2">
<p>types for specifying times in the future, mainly used in medication orders, e.g. '3 times a day before meals'.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Uri
</td>
<td class="hdlist2">
<p>Unique Resource Identifiers.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_data_structures_information_model"><a class="anchor" href="#_data_structures_information_model"></a>5.5.1.3. Data Structures Information Model</h5>
<div class="paragraph">
<p>In most openEHR information models, generic data structures are used for expressing content whose particular structure will be defined by archetypes. The generic structures are as follows.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Single
</td>
<td class="hdlist2">
<p>single items, used to contain any single value, such as a height or weight.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
List
</td>
<td class="hdlist2">
<p>linear lists of named items, such as many pathology test results.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Table
</td>
<td class="hdlist2">
<p>tabular data, including unlimited and limited length tables with named and ordered columns, and potentially named rows.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Tree
</td>
<td class="hdlist2">
<p>tree-shaped data, which may be conceptually a list of lists, or other deep structure.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
History
</td>
<td class="hdlist2">
<p>time-series structures, where each time-point can be an entire data structure of any complexity, described by one of the above structure types. Point and interval samples are supported.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_common_information_model"><a class="anchor" href="#_common_information_model"></a>5.5.1.4. Common Information Model</h5>
<div class="paragraph">
<p>Several concepts that recur in higher level packages are defined in the <code>common</code> package. For example, the classes <code>LOCATABLE</code> and <code>ARCHETYPED</code> provide the link between information and archetype models. The classes <code>ATTESTATION</code> and <code>PARTICIPATION</code> are generic domain concepts that provide a standard way of documenting involvement of clinical professionals and other agents with the EHR, including signing.</p>
</div>
<div class="paragraph">
<p>The <code>change_control</code> package defines a formal model of change management and versioning which applies to any service that needs to be able to supply previous states of its information, in particular the demographic and EHR services. The key semantics of versioning in openEHR are described in the <a href="#_versioning">Section 7.3.3.1</a> section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_security_information_model"><a class="anchor" href="#_security_information_model"></a>5.5.1.5. Security Information Model</h5>
<div class="paragraph">
<p>The Security Information Model defines the semantics of access control and privacy setting for information in the EHR.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ehr_information_model"><a class="anchor" href="#_ehr_information_model"></a>5.5.1.6. EHR Information Model</h5>
<div class="paragraph">
<p>The EHR IM includes the <code>ehr</code> and <code>composition</code> packages, and defines the containment and context semantics of the key concepts <code>EHR</code>, <code>COMPOSITION</code>, <code>SECTION</code>, and <code>ENTRY</code>. These classes are the major coarse-grained components of the EHR, and correspond directly to the classes of the same names in <a href="https://www.iso.org/standard/40784.html" target="_blank" rel="noopener">ISO 13606-1:2005</a> and fairly closely to the 'levels' of the same names in the <a href="https://www.hl7.org/implement/standards/product_brief.cfm?product_id=7" target="_blank" rel="noopener">HL7 Clinical Document Architecture (CDA) release 2.0</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ehr_extract_information_model"><a class="anchor" href="#_ehr_extract_information_model"></a>5.5.1.7. EHR Extract Information Model</h5>
<div class="paragraph">
<p>The EHR Extract IM defines how an EHR extract is built from <code>COMPOSITIONs</code>, demographic, and
access control information from the EHR. A number of Extract variations are supported, including
"full openEHR", a simplified form for integration with ISO 13606, and an openEHR/openEHR
synchronisation Extract.</p>
</div>
</div>
<div class="sect4">
<h5 id="_integration_information_model"><a class="anchor" href="#_integration_information_model"></a>5.5.1.8. Integration Information Model</h5>
<div class="paragraph">
<p>The Integration model defines the class <code>GENERIC_ENTRY</code>, a subtype of <code>ENTRY</code> used to represent freeform
legacy or external data as a tree. This Entry type has its own archetypes, known as "integration
archetypes", which can be used in concert with clinical archetypes as the basis for a tool-based data
integration system. See <a href="#_integrating_openehr_with_other_systems">Section 14</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="_demographics_information_model"><a class="anchor" href="#_demographics_information_model"></a>5.5.1.9. Demographics Information Model</h5>
<div class="paragraph">
<p>The demographic model defines generic concepts of <code>PARTY</code>, <code>ROLE</code> and related details such as contact
addresses. The archetype model defines the semantics of constraint on <code>PARTYs</code>, allowing archetypes
for any type of person, organisation, role and role relationship to be described. This approach provides
a flexible way of including the arbitrary demographic attributes allowed in the <a href="https://www.omg.org/spec/PIDS/">OMG HDTF PIDS standard</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_archetype_model_component_am"><a class="anchor" href="#_archetype_model_component_am"></a>5.6. Archetype Model Component (AM)</h3>
<div class="paragraph">
<p>The openEHR AM component is illustrated below.</p>
</div>
<div id="spec_component_am" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/spec_component-am.svg" alt="spec component am">
</div>
<div class="title">Figure 14. AM Component of openEHR</div>
</div>
<div class="paragraph">
<p>The openEHR <code>am</code> package contains the models necessary to describe the semantics of archetypes and templates, and their use within openEHR. There are currently two extant major versions of archetype technology in openEHR: 'ADL 1.4', the original version, and 'ADL 2', a more modern version, which is slowly being adopted. Both versions are maintained side by side, to enable implementers to work with the version(s) that suit their needs.</p>
</div>
<div class="paragraph">
<p>In both versions, the Archetype Model consists of ADL, the Archetype Definition Language (expressed in the form of a syntax specification), and the Archetype Object Model (AOM), a structured model of archetypes.</p>
</div>
<div class="paragraph">
<p>The package structure of the version 2 form of the AM is shown below.</p>
</div>
<div id="aom_2_packages" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/AM/latest/UML/diagrams/AM-packages.svg" alt="AM packages">
</div>
<div class="title">Figure 15. Structure of the ADL 2 version <code>org.openehr.am</code> package</div>
</div>
<div class="paragraph">
<p>The package structure of the version 1.4 form of the AM is shown below.</p>
</div>
<div id="aom_14_packages" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/AM/latest/UML/AOM1.4/diagrams/AM-packages.svg" alt="AM packages">
</div>
<div class="title">Figure 16. Structure of the ADL 1.4 <code>org.openehr.am</code> package</div>
</div>
<div class="paragraph">
<p>Another key specification is the Archetype Identification specification, which defines semantics for archetype identifiers, versioning and life-cycle. The formal specifications may be found on the <a href="https://specifications.openehr.org/releases/AM/latest/index">Archetype Model index page</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_service_model_sm"><a class="anchor" href="#_service_model_sm"></a>5.7. Service Model (SM)</h3>
<div class="paragraph">
<p>The openEHR service model includes definitions of basic services in the health information environment, centred around the EHR. It is illustrated in the figure below. The set of services actually included is evolving over time.</p>
</div>
<div id="service_packages" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/SM/latest/UML/diagrams/SM-platform-packages.svg" alt="SM platform packages" width="50%">
</div>
<div class="title">Figure 17. Structure of the <code>org.openehr.sm</code> package</div>
</div>
<div class="sect3">
<h4 id="_definitions_service"><a class="anchor" href="#_definitions_service"></a>5.7.1. Definitions Service</h4>
<div class="paragraph">
<p>The Definitions Service defines the interface to online repositories of archetypes, templates and AQL queries, and can be used both by GUI applications designed for human browsing as well as access by other software services such as the EHR.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ehr_service"><a class="anchor" href="#_ehr_service"></a>5.7.2. EHR Service</h4>
<div class="paragraph">
<p>The EHR Service defines the coarse-grained interface to electronic health record service. The level of granularity is openEHR Contributions and Compositions, i.e. a version-control / change-set interface.</p>
</div>
<div class="paragraph">
<p>Part of the model defines the semantics of server-side querying, i.e. queries which cause large amounts of data to be processed, generally returning small aggregated answers, such as averages, or sets of ids of patients matching a particular criterion.</p>
</div>
</div>
<div class="sect3">
<h4 id="_query_service"><a class="anchor" href="#_query_service"></a>5.7.3. Query Service</h4>
<div class="paragraph">
<p>The Query Service defines the interface via which AQL queries which may be stored via the Definitions Service, or ad hoc, can be executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_terminology_interface"><a class="anchor" href="#_terminology_interface"></a>5.7.4. Terminology Interface</h4>
<div class="paragraph">
<p>The Terminology Service service provides the means for all other services to access any terminology available in the health information environment, including basic classification vocabularies such as <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">ICDx</a> and <a href="http://www.who.int/classifications/icd/adaptations/icpc2/en/" target="_blank" rel="noopener">ICPC</a>, as well as more advanced ontology-based terminologies. Following the concept of
division of responsibilities in a system-of-systems context, the Terminology Service abstracts the different underlying architectures of each terminology, allowing other services in the environment to access terms in a standard way. The Terminology Service is thus the gateway to all ontology- and terminology-
based knowledge services in the environment, which along with services for accessing guidelines, drug data and other "reference data" enables inferencing and decision support to be carried out in the environment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_global_view"><a class="anchor" href="#_global_view"></a>5.8. Global View</h3>
<div class="paragraph">
<p>The figure below shows all of the openEHR specifications, i.e. object models, languages and APIs, arranged by component. This view abstracts away the components and top-level UML packages, providing a useful <em>aide memoire</em> picture of the totality of openEHR specifications. Dependencies only exist from higher elements to lower elements. The CNF and ITS components are separated since they are semantically derivative from the primary specifications, but are primary artefacts for downstream software engineering use. The other usable software artefact comes in the form of class libraries directly implementing the formal specifications.</p>
</div>
<div class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/openehr_block_diagram_detailed.svg" alt="openEHR_packages_and_languages">
</div>
<div class="title">Figure 18. openEHR Components and specifications - global view</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_of_the_openehr_ehr"><a class="anchor" href="#_design_of_the_openehr_ehr"></a>6. Design of the openEHR EHR</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_ehr_system"><a class="anchor" href="#_the_ehr_system"></a>6.1. The EHR System</h3>
<div class="paragraph">
<p>The notion of a logical EHR <em>system</em> is central to the openEHR architecture. In openEHR, a system is understood as a distinct logical repository  corresponding to an organisational entity that is <em>legally responsible</em> for the management and governance of the healthcare data contained within. This may be a regional health service that serves multiple provider enterprises or a single provider enterprise such as a larger hospital. The 'system' is therefore in general distinct from specific applications and also from provider organisations, even if in some cases it happens to be owned by a single provider. It is also distinct from any underlying virtualisation infrastructure or cloud computing facility, which may house multiple logical EHR systems in a multi-tenant fashion. This is clear by comparing the contractual responsibilities of the infrastructure provider, which are for <em>generic IT service management</em>, to a procurer (e.g. a healthcare data management entity). It is the latter that undertakes legal responsibility for the content, on behalf of one or more healthcare provider organisations.</p>
</div>
<div class="paragraph">
<p>The technical criterion for identifying an EHR system is that it is the entity that assigns version identifiers within a repository.</p>
</div>
<div class="sect3">
<h4 id="_system_identity"><a class="anchor" href="#_system_identity"></a>6.1.1. System Identity</h4>
<div class="paragraph">
<p>Within the openEHR architecture, a <code><em>system_id</em></code> attribute is recorded both within each patient EHR (<a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#_ehr_class" target="_blank" rel="noopener"><code>EHR</code> class</a>), and also within the audit created with each commit of data to an EHR (<a href="https://specifications.openehr.org/releases/RM/latest/common.html#_audit_details_class" target="_blank" rel="noopener"><code>AUDIT_DETAILS</code> class</a>). It is also used in feeder system audits that record the origin of imported data (<a href="https://specifications.openehr.org/releases/RM/latest/common.html#_feeder_audit_details_class" target="_blank" rel="noopener"><code>FEEDER_AUDIT_DETAILS</code> class</a>). This identifier identifies the logical EHR system as described above, and may be of any form. Common forms include the reverse domain name and plain and structured string identifiers.</p>
</div>
<div class="paragraph">
<p>The system identifier is <em>not assumed to be directly processable</em>, but may instead be used as a key, for example in a service maintaining location information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_information_architecture"><a class="anchor" href="#_information_architecture"></a>6.1.2. Information Architecture</h4>
<div class="paragraph">
<p>In informational terms, a minimal EHR system based on openEHR consists of an EHR repository, an archetype repository, terminology (if available), and demographic/identity information, as shown below.</p>
</div>
<div id="minimal_openehr_system" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/minimal_openehr_system.png" alt="minimal openehr system" width="70%">
</div>
<div class="title">Figure 19. Minimal openEHR EHR System</div>
</div>
<div class="paragraph">
<p>The latter may be in the form of an existing PMI (patient master index) or other directory, or it may be
in the form of an openEHR demographic repository. An openEHR demographic repository can act as
a front end to an existing PMI or in its own right. Either way it performs two functions: standardisation
of demographic information structures and versioning. An openEHR EHR contains references to
entities in whichever demographic repository has been configured for use in the environment; the
EHR can be configured to include either no demographic or some identifying data. One of the basic
principles of openEHR is the complete separation of EHR and demographic information, such that an
EHR taken in isolation contains little or no clue as to the identity of the patient it belongs to. The
security benefits are described below. In more complete EHR systems, numerous other services (particularly
security-related) would normally be deployed, as shown in <a href="#health_services_environment">Figure 7</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_top_level_information_structures"><a class="anchor" href="#_top_level_information_structures"></a>6.2. Top-level Information Structures</h3>
<div class="paragraph">
<p>As has been shown, the openEHR information models define information at varying levels of granularity.
Fine-grained structures defined in the Support and Data types are used in the Data Structures
and Common models; these are used in turn in the EHR, EHR Extract, Demographic and other 'top-level'
models. These latter models define the 'top-level structures' of openEHR, i.e. content structures
that can sensibly stand alone, and may be considered the equivalent of separate documents in a
document-oriented system. In openEHR information systems, it is generally the top-level structures
that are of direct interest to users. The major top-level structures include the following:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Composition
</td>
<td class="hdlist2">
<p>the committal unit of the EHR (see type <code>COMPOSITION</code> in EHR IM);</p>
</td>
</tr>
<tr>
<td class="hdlist1">
EHR Access
</td>
<td class="hdlist2">
<p>the EHR-wide access control object (see type <code>EHR_ACCESS</code> in EHR IM);</p>
</td>
</tr>
<tr>
<td class="hdlist1">
EHR Status
</td>
<td class="hdlist2">
<p>the status summary of the EHR (see type <code>EHR_STATUS</code> in EHR IM);</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Folder hierarchy
</td>
<td class="hdlist2">
<p>act as directory structures in EHR, Demographic services (see type FOLDER in Common IM);</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Party
</td>
<td class="hdlist2">
<p>various subtypes including <code>ACTOR</code>, <code>ROLE</code>, etc. representing a demographic entity with identity and contact details (see type <code>PARTY</code> and subtypes in Demographic IM);</p>
</td>
</tr>
<tr>
<td class="hdlist1">
EHR Extract
</td>
<td class="hdlist2">
<p>the transmission unit between EHR systems, containing a serialisation of EHR, demographic and other content (see type <code>EHR_EXTRACT</code> in EHR Extract IM).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All persistent openEHR EHR, demographic and related content is found within top-level information structures. Most of these are visible in the following figures.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_ehr"><a class="anchor" href="#_the_ehr"></a>6.3. The EHR</h3>
<div class="paragraph">
<p>The openEHR EHR is structured according to a relatively simple model. A central EHR object identified
by an EHR id specifies references to a number of types of structured, versioned information, plus
a list of Contribution objects that act as audits for changes made to the EHR. The high-level structure
of the openEHR EHR is shown below.</p>
</div>
<div id="high_level_ehr_structure" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/ehr/diagrams/high_level_ehr_structure.svg" alt="high level ehr structure">
</div>
<div class="title">Figure 20. High-level Structure of the openEHR EHR</div>
</div>
<div class="paragraph">
<p>In this figure, the parts of the EHR are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>EHR</em>: the root object, identified by a globally unique EHR identifier;</p>
</li>
<li>
<p><em>EHR_access (versioned)</em>: an object containing access control settings for the record;</p>
</li>
<li>
<p><em>EHR_status (versioned)</em>: an object containing various status and control information, optionally including the identifier of the subject (i.e. patient) currently associated with the record;</p>
</li>
<li>
<p><em>Directory (versioned)</em>: an optional hierarchical structure of Folders that can be used to logically organise Compositions;</p>
</li>
<li>
<p><em>Folders (versioned)</em>: additional optional hierarchical folder structures that can be used to logically organise Compositions;</p>
</li>
<li>
<p><em>Compositions (versioned)</em>: the containers of all clinical and administrative content of the record;</p>
</li>
<li>
<p><em>Contributions</em>: the change-set records for every change made to the health record; each Contribution references a set of one or more Versions of any of the versioned items in the record that were committed or attested together by a user to an EHR system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The logical structure of a typical Composition is shown in more detail in the next figure. This shows various hierarchical levels from Composition to the data types are shown in a typical arrangement.
The 21 data types provide for all types of data needed for clinical and administrative recording.</p>
</div>
<div id="composition_structure" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/composition_structure.png" alt="composition structure" width="80%">
</div>
<div class="title">Figure 21. Elements of an openEHR Composition</div>
</div>
</div>
<div class="sect2">
<h3 id="_entries_and_clinical_statements"><a class="anchor" href="#_entries_and_clinical_statements"></a>6.4. Entries and Clinical Statements</h3>
<div class="sect3">
<h4 id="_entry_subtypes"><a class="anchor" href="#_entry_subtypes"></a>6.4.1. Entry Subtypes</h4>
<div class="paragraph">
<p>All clinical information created in the openEHR EHR is ultimately expressed in 'Entries'. An Entry
is logically a single <em>clinical statement</em>, and may be a single short narrative phrase, but may also contain
a significant amount of data, e.g. an entire microbiology result, a psychiatric examination note, a
complex medication order. In terms of actual content, the Entry classes are the most important in the
openEHR EHR Information Model, since they define the semantics of all the 'hard' information in
the record. They are intended to be archetyped, and in fact, archetypes for Entries and sub-parts of
Entries make up the vast majority of archetypes defined for the EHR.</p>
</div>
<div class="paragraph">
<p>The openEHR <code>ENTRY</code> classes are shown below. There are five concrete subtypes: <code>ADMIN_ENTRY</code>, <code>OBSERVATION</code>, <code>EVALUATION</code>, <code>INSTRUCTION</code> and <code>ACTION</code>, of which the latter four are kinds of <code>CARE_ENTRY</code>.</p>
</div>
<div id="entry_model_simple" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/UML/diagrams/RM-composition.entry-simple.svg" alt="RM composition.entry simple" width="60%">
</div>
<div class="title">Figure 22. The openEHR Entry model (in EHR IM)</div>
</div>
<div class="paragraph">
<p>The choice of these types is based on the clinical problem-solving process, described in <a href="#Beale_Heard2007">Beale &amp; Heard (2007)</a> shown below.</p>
</div>
<div id="clinical_investigator_process" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/docs/ehr/diagrams/clinical_investigator_recording_process.svg" alt="clinical investigator recording process" width="65%">
</div>
<div class="title">Figure 23. Relationship of information types to the investigation process</div>
</div>
<div class="paragraph">
<p>This figure shows the cycle of information creation due to an iterative, problem solving process typical
not just of clinical medicine but of science in general. The 'system' as a whole is considered to be made up of two
parts: the 'patient system' and the 'clinical investigator system'. The latter consists of health carers,
and may include the patient (at points in time when the patient performs observational or therapeutic
activities), and is responsible for understanding the state of the patient system and delivering care to
it. A problem is solved by making observations, forming opinions (hypotheses), and prescribing
actions (instructions) for next steps, which may be further investigation, or may be interventions
designed to resolve the problem, and finally, executing the instructions (actions).</p>
</div>
<div class="paragraph">
<p>This process model is a synthesis of Lawrence Weed&#8217;s 'problem-oriented' method of EHR recording, and later related efforts, including the model of <a href="#Rector1994">Rector Nowlan &amp; Kay (1991)</a>, and the 'hypothetico-deductive' model of reasoning (see e.g. <a href="#Elstein1978">Elstein Shulman &amp; Sprafka (1978)</a>). However hypothesis-making and testing is not the only successful process used by clinical professionals - evidence shows that many (particularly those older and more experienced) rely on pattern recognition and direct retrieval of plans used previously with similar patients or prototype models. The investigator process model used in openEHR is compatible with both cognitive approaches, since it does not say how opinions are formed, nor imply any specific number or size of iterations to bring the process to a conclusion, nor even require all steps to be present while iterating (e.g. GPs often prescribe without making a firm diagnosis). Consequently, the openEHR Entry model does not impose a process model, it only provides the possible types of information that might occur.</p>
</div>
<div class="sect4">
<h5 id="_ontology_of_entry_types"><a class="anchor" href="#_ontology_of_entry_types"></a>6.4.1.1. Ontology of Entry Types</h5>
<div class="paragraph">
<p>In the clinical world practitioners do not think in terms of only five kinds of data corresponding to the subtypes of Entry described above. There are many subtypes of each of these types, of which some are shown in the figure below, reproduced from <a href="#Beale_Heard2007">Beale &amp; Heard (2007)</a>.</p>
</div>
<div id="CIR_ontology" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/CIR_ontology.png" alt="CIR ontology" width="80%">
</div>
<div class="title">Figure 24. Ontology of Recorded Information</div>
</div>
<div class="paragraph">
<p>The key top-level categories are 'care information' and 'administrative information'. The former encompasses all statements that might be recorded at any point during the care process, and consists of the major sub-categories on which the Entry model is based, namely 'observation', 'opinion', 'instruction', and 'action' (a kind of observation) which themselves correspond to the past, present and future in time. The administrative information category covers information which is not generated by the care process proper, but relates to organising it, such as appointments and admissions. This information is not about care, but about the logistics of care delivery. Regardless of the diversity, each of the leaf-level categories shown in this figure is ultimately a sub-category of one of the types from the process model, and hence, of the subtypes of the openEHR Entry model.</p>
</div>
<div class="paragraph">
<p>Correct representation of the categories from the ontology is enabled by using archetypes designed to express the information of interest (say a risk assessment) in terms of a particular Entry subtype (in this case, Evaluation). In a system where Entries are thus modelled, there will be no danger of incorrectly identifying the various kinds of Entries, as long as the Entry subtype, time, and certainty/negation are taken into account. Note that even if the ontology shown in <a href="#CIR_ontology">Figure 24</a> is not correct (undoubtedly it is not), archetypes will be constructed to account for each improved idea of what such categories should really be.</p>
</div>
</div>
<div class="sect4">
<h5 id="_clinical_statement_status_and_negation"><a class="anchor" href="#_clinical_statement_status_and_negation"></a>6.4.1.2. Clinical Statement Status and Negation</h5>
<div class="paragraph">
<p>A well-known problem in clinical information recording is the assignment of 'status' to recorded
items. Kinds of status include variants like "actual value of P" (P stands for some phenomenon),
"family history of P", "risk of P", "fear of P", as well as negation of any of these, i.e. "not/no P", "no
history of P" etc. A proper analysis of these so called statuses shows that they are not "statuses" at all,
but different categories of information as per the ontology of <a href="#CIR_ontology">Figure 24</a>. In general, negations are
handled by using "exclusion" archetypes for the appropriate Entry type. For example, "no allergies"
can be modelled using an Evaluation archetype that describes which allergies are excluded for this
patient. Another set of statement types that can be confused in systems that do not properly model
information categories concern interventions, e.g. "hip replacement (5 years ago)", "hip replacement
(recommended)", "hip replacement (ordered for next Tuesday 10 am)".</p>
</div>
<div class="paragraph">
<p>All of these statement types map directly to one of the openEHR Entry types in an unambiguous fashion,
ensuring that querying of the EHR does not match incorrect data, such as a statement about fear
or risk, when the query was for an observation of the phenomenon in question.</p>
</div>
<div class="paragraph">
<p>Further details on the openEHR model clinical information are given in the EHR IM document, Entry
Section.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_managing_interventions"><a class="anchor" href="#_managing_interventions"></a>6.5. Managing Interventions</h3>
<div class="paragraph">
<p>A key part of the investigation process shown in <a href="#clinical_investigator_process">Figure 23</a>, and indeed healthcare in general, is
intervention. Specifying and managing interventions (whether the simplest prescriptions or complex
surgery and therapy) is a hard problem for information systems because it is in 'future time' (meaning
that intervention activities have to be expressed using branching/looping time specifications, not
the simple linear time of observations), unexpected events can change things (e.g. patient reaction to
drugs), and the status of a given intervention can be hard to track, particularly in distributed systems.
However, from the health professional&#8217;s point of view, almost nothing is more basic than wanting to
find out: what medications is this patient on, since when, and what is the progress?
The openEHR approach to these challenges is to use the Entry type <code>INSTRUCTION</code>, its subpart
<code>ACTIVITY</code> to specify interventions in the future, and the Entry subtype <code>ACTION</code> to record what has
actually happened. A number of important features are provided in this model, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a single, flexible way of modelling all interventions, whether they be single drug medication orders or complex hospital-based therapies;</p>
</li>
<li>
<p>a way of knowing the state of any intervention, in terms of the states in a standard state machine, shown below; this allows a patient&#8217;s EHR to be queried in a standard way so as to return "all active medications", "all suspended interventions" etc.;</p>
</li>
<li>
<p>a way of mapping particular care process flow steps to the standard state machine states, enabling health professionals to define and view interventions in terms they understand;</p>
</li>
<li>
<p>support for automated workflow, without requiring it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Coupled with the comprehensive versioning capabilities of openEHR, the Instruction/Action design
allows clinical users of the record to define and manage interventions for the patient in a distributed
environment.</p>
</div>
<div id="instruction_state_machine" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/UML/diagrams/RM-InstructionStateMachine.svg" alt="RM InstructionStateMachine">
</div>
<div class="title">Figure 25. openEHR standard Instruction State Machine</div>
</div>
</div>
<div class="sect2">
<h3 id="_time_in_the_ehr"><a class="anchor" href="#_time_in_the_ehr"></a>6.6. Time in the EHR</h3>
<div class="paragraph">
<p>Time is well-known as a challenging modelling problem in health information. In openEHR, times
that are a by-product of the investigation process (e.g. time of sampling or collection; time of measurement,
time of a healthcare business event, time of data committal) described above are concretely
modelled, while other times specific to particular content (e.g. date of onset, date of resolution) are
modelled using archetyping of generic data attributes. The following figure shows a typical relationship
of times with respect to the observation process, and the corresponding attributes within the
openEHR reference model. Note that under different scenarios, such as GP consultation, radiology
reporting and others, the temporal relationships may be quite different than those shown in the figure.
Time is described in detail in the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#_time_in_the_ehr">EHR Information Model</a>.</p>
</div>
<div id="time_in_the_ehr" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/ehr/diagrams/time_in_the_ehr.svg" alt="time in the ehr" width="70%">
</div>
<div class="title">Figure 26. Time in the EHR</div>
</div>
</div>
<div class="sect2">
<h3 id="_language"><a class="anchor" href="#_language"></a>6.7. Language</h3>
<div class="paragraph">
<p>In some situations, there may be more than one language used in the EHR. This may be due to
patients being treated across borders (common among the Scandinavian countries, between Brazil
and northern neighbours), or due to patients being treated while travelling, or due to multiple languages
simply being used in the home environment.</p>
</div>
<div class="paragraph">
<p>Language is handled as follows in the openEHR EHR. The default language for the whole EHR is
determined from the operating system locale. It may be included in the EHR_status object if desired.
Language is then mandatorily indicated in two places in the EHR data, namely in Compositions and
Entries (i.e. Observations, etc), in a language attribute. This allows both Compositions of different
languages in the EHR, and Entries of different languages in the same Composition. Additionally,
within Entries, text and coded text items may optionally have language recorded if it is different from
the language of the enclosing Entry, or where these types are used within other non-Entry structures
that don&#8217;t indicate language.</p>
</div>
<div class="paragraph">
<p>The use of these features is mostly likely to occur due to translation, although in some cases a truly
multi-lingual environment might exist within the clinical encounter context. In the former case, some
parts of an EHR, e.g. particular Compositions will be translated before or after a clinical encounter to
as to make the information available in the primary language of the EHR. The act of translation (like
any other interaction with the EHR) will cause changes to the record, in the form of new Versions.
New translations can conveniently be recorded as branch versions, attached to the version of which
they are a translation. This is not mandatory, but provides a convenient way to store translations so
that they don&#8217;t appear to replace the original content.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security_and_confidentiality"><a class="anchor" href="#_security_and_confidentiality"></a>7. Security and Confidentiality</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>7.1. Requirements</h3>
<div class="sect3">
<h4 id="_privacy_confidentiality_and_consent"><a class="anchor" href="#_privacy_confidentiality_and_consent"></a>7.1.1. Privacy, Confidentiality and Consent</h4>
<div class="paragraph">
<p>Privacy (the right to limit who sees the personal data) and confidentiality (the obligation of others to
respect the privacy of disclosed data) are primary concerns of many consumers with respect to e-
Health systems. A widely accepted principle is that information provided (either directly or due to
observation or testing of specimens etc.) in confidence by a patient to health professionals during an
episode of care should only be passed on or otherwise become available to other parties if the patient
agrees; put more simply: <em>data sharing must be controlled by patient consent</em>. A more complex subrequirement
for some patients is allowing differential access to parts of their health record, for example,
relatively open access rights to most of the health record, but limited access to sexual or mental
health items. The interrelatedness of health information can make this difficult. For example the medication
list will often give away sensitive conditions even if the diagnosis is hidden, yet is needed for
any safe treatment, and many health professionals would see the unavailability of current medications
(and allergies) information as highly problematic for giving even basic care.</p>
</div>
</div>
<div class="sect3">
<h4 id="_requirements_of_healthcare_providers"><a class="anchor" href="#_requirements_of_healthcare_providers"></a>7.1.2. Requirements of Healthcare Providers</h4>
<div class="paragraph">
<p>On the other hand, clinical professionals delivering care want fast access to relevant data, and to be
sure that what they see on the screen is a faithful representation of what has been said about the
patient. Emergency access to health records is sometimes needed by carers otherwise unrelated to the
normal care of a patient; such accesses can only be consented to in a general way, since the specific
providers involved will not usually be known.</p>
</div>
<div class="paragraph">
<p>Researchers in healthcare generally want access to the data of large numbers of patients in order to
evaluate current care and improve it (clinical knowledge discovery), and for educational purposes.
Both of these latter needs are also ultimately patient and societal priorities. Providing effective care
and supporting ongoing medical research therefore have to function in a system that implements the
concept of patient consent.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specifying_access_control"><a class="anchor" href="#_specifying_access_control"></a>7.1.3. Specifying Access Control</h4>
<div class="paragraph">
<p>In theory, it should be easy for the patient or some clinical professional to specify who can see the
patient record. In some cases it can be done by direct identification, e.g. the patient might nominate
their long-term GP by provider id. Some exclusions could potentially be made this way as well, for
example a previous doctor with whom the patient has a problematic personal relationship.
However it soon becomes difficult to identify provider parties individually when the patient moves
into parts of the healthcare system where there are many staff, and/or where there is no previously
established relationship. The advent of e-prescribing and e-pharmacy will bring even larger numbers
of health and allied health workers into the e-Health matrix, making the problem of individual identification
of who should see the patients data infeasible. Further, there is a large and growing category
of "very mobile" people (the military, entertainers, NGO workers, international business and tourism
professionals, athletes&#8230;&#8203;.) who cannot predict even in which country they may require care. As a consequence,
the need for some access control to be specified in terms of categories or role types appears
inescapable.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_problem_of_roles"><a class="anchor" href="#_the_problem_of_roles"></a>7.1.4. The Problem of Roles</h4>
<div class="paragraph">
<p>One of the difficult challenges to implementing access control to health information is that of defining
"roles", i.e. the status of users of the record at the time when right of access is being determined. In
principle, roles ought to be knowable in advance. For example, the labels "nurse", "GP" and "psychiatrist"
can be relatively easily assigned to individuals. However, the kinds of labels that are of more
importance are those that differentiate among (for example) personal carers (e.g. primary GP), other
care delivery staff (e.g. nurses, aged carers) and support staff (e.g. pathologists, radiographers). In a
patient care delivery-oriented view of the world, the professional level of a health care professional is
probably less important than his or her relationship to the current care process for the patient.</p>
</div>
<div class="paragraph">
<p>It will not always be clear which individuals fall into any of these categories at any time, or how such
terms are even defined in different sites and jurisdictions. Realistically, the evaluation of a role category
such as "care deliverer" into particular identities such as those of nurses on the ward on a particular
day must be done in each care delivery environment, not in the EHR. Access decisions for
information in the EHR therefore will have some dependence on provider site knowledge of which
staff are actively involved in the care process of a given patient.</p>
</div>
<div class="paragraph">
<p>Role-based access control is further complicated by the common fact of temporary replacements due
to illness or holiday and role changes due to staff shortages. Further, if a physician employing a medical
secretary requires her to access and update sensitive parts (relating to his own treatment of the
patient) of the record, access at the highest level is effectively given to someone not medically trained
or related directly to the patients care, even if only for 10 minutes. Any role-based system therefore
has to take into account the messy reality of clinical care in the real world rather than being based
solely on theoretical principles.</p>
</div>
</div>
<div class="sect3">
<h4 id="_usability"><a class="anchor" href="#_usability"></a>7.1.5. Usability</h4>
<div class="paragraph">
<p>Usability of security and privacy mechanisms is a key requirement of a health record architecture.
Some very elegant solutions to fine-grained access control designed by security experts would be
simply unusable in practice because they would take too long for patients and doctors to learn, or are
too time-consuming to actually use on the screen; they could also be too complex to safely implement
in software.</p>
</div>
<div class="paragraph">
<p>The following sections describe support in openEHR for the main security and privacy requirements
of EHRs.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threats_to_security_and_privacy"><a class="anchor" href="#_threats_to_security_and_privacy"></a>7.2. Threats to Security and Privacy</h3>
<div class="paragraph">
<p>Any model of how security and privacy are supported in the health record must be based on some
notion of assumed threats. Without going into great detail, security threats assumed by openEHR
include the following (here "inappropriate" means anything that is not or would not be consented to
by the patient):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>human error in patient identification, leading to incorrect association of health data of one patient with another. Mis-identification of patients can cause personal data for one patient to go into the record of another patient (leading to privacy violations and possibly clinical errors), or into a new record rather than the existing one for the same patient (leading to two or more clinically incomplete records);</p>
</li>
<li>
<p>inappropriate access by health professionals or others in the physical care delivery environment (including e.g. any worker in a hospital) not involved in the current care of the patient;</p>
</li>
<li>
<p>inappropriate access by other persons known to the patient, e.g. a by family member;</p>
</li>
<li>
<p>inappropriate access of health data by corporate or other organisations e.g. for purposes of insurance discrimination;</p>
</li>
<li>
<p>malicious theft of or access to health data (e.g. of a celebrity or politician) for profit or other personal motives;</p>
</li>
<li>
<p>generic threats to data integrity and availability, such as viruses, worms, denial of service attacks etc.;</p>
</li>
<li>
<p>failures in software (due to bugs, incorrect configuration, interoperability failures etc.) causing corruption to data, or incorrect display or computation, resulting in clinical errors.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A key principle with respect to the design of mechanisms supporting security, confidentiality and
integrity has to be kept in mind: the likelihood of any given mode of targeted inappropriate access is
proportional to the perceived value of the information and inversely proportional to the cost of access.
To paraphrase Ross Andersons BMA paper (<a href="#Anderson1996">Anderson &amp; Anderson&#44; 1996</a>) on health data security, for a given access, the perpretrator
will try to find the simplest, cheapest and quickest method, which is more likely to be bribery or
burglary than James Bond-inspired technology. openEHR makes use of this principle by providing
some relatively simple mechanisms that are cheap to implement but can make misuse quite difficult,
without compromising availability.</p>
</div>
</div>
<div class="sect2">
<h3 id="_solutions_provided_by_openehr"><a class="anchor" href="#_solutions_provided_by_openehr"></a>7.3. Solutions Provided by openEHR</h3>
<div class="sect3">
<h4 id="_overview_4"><a class="anchor" href="#_overview_4"></a>7.3.1. Overview</h4>
<div class="paragraph">
<p>Many of the concrete mechanisms relating to security and privacy are found in system deployments
rather than in models such as openEHR, particularly the implementation of authentication, access
control, and encryption. The openEHR specifications and core component implementations do not
explicitly define many concrete mechanisms since there is great variability in the requirements of different
sites - secure LAN deployments many require minimal security inside, whereas web-accessible
health record servers are likely to have quite different requirements. What openEHR does is to support
some of the key requirements in a flexible enough way that deployments with substantially different
requirements and configurations can nevertheless implement the basic principles in a standard
way.</p>
</div>
<div class="paragraph">
<p>The figure below illustrates the main security measures directly specified by the openEHR architecture. These include EHR/demographic separation and an EHR-wide access control object. At the level of versioned objects, commit audits (mandatory), digital signatures and hashes are available. The following subsections describe these features in more detail.</p>
</div>
<div id="security_features" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/security_features.png" alt="security features" width="80%">
</div>
<div class="title">Figure 27. Security Features of the openEHR EHR</div>
</div>
</div>
<div class="sect3">
<h4 id="_security_policy"><a class="anchor" href="#_security_policy"></a>7.3.2. Security Policy</h4>
<div class="paragraph">
<p>In and of itself, the openEHR EHR imposes only a minimal security policy profile which could be regarded as necessary, but generally not sufficient for a deployed system (i.e. other aspects would still need to be implemented in layers whose semantics are not defined in openEHR). The following policy principles are embodied in openEHR.</p>
</div>
<div class="sect4">
<h5 id="_general"><a class="anchor" href="#_general"></a>7.3.2.1. General</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Indelibility
</td>
<td class="hdlist2">
<p>health record information cannot be deleted; logical deletion is achieved by marking the data in such a way as to make it appear deleted (implemented in version control).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Audit trailing
</td>
<td class="hdlist2">
<p>All changes made to the EHR including content objects as well as the EHR status and access control objects are audit-trailed with user identity, time-stamp, reason, optionally digital signature and relevant version information; one exception is where the modifier is the patient, in which case, a symbolic identifier can be used (known as <code>PARTY_SELF</code> in openEHR; see next point).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Anonymity
</td>
<td class="hdlist2">
<p>the content of the health record is separate from identifying demographic information. This can be configured such that theft of the EHR provides no direct clue to the identity of the owning patient (indirect clues are of course harder to control). Stealing an identified EHR involves theft of data from two servers, or even theft of two physical computers, depending on deployment configuration.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_access_control"><a class="anchor" href="#_access_control"></a>7.3.2.2. Access Control</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Access list
</td>
<td class="hdlist2">
<p>the overriding principle of access control must be "relevance" both in terms of user identity (who is delivering care to the patient) and time (during the current episode of care, and for some reasonable, limited time afterward). An access control list can be defined for the EHR, indicating both identified individuals and categories, the latter of which might be role types, or particular staff groups.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Access control of access settings
</td>
<td class="hdlist2">
<p>a gate-keeper controls access to the EHR access control settings. The gate-keeper is established at the time of EHR creation as being one of the identities known in the EHR, usually the patient for mentally competent adults, otherwise a parent, legal guardian, advocate or other responsible person. The gate-keeper determines who can make changes to the access control list. All changes to the list are audit-trailed as for normal data (achieved due to normal versioning).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Privacy
</td>
<td class="hdlist2">
<p>patients can mark Compositions in the EHR as having one of a number of levels of privacy. The definition of the privacy levels is not hard-wired in the openEHR models but rather is defined by standards or agreements within jurisdictions of use.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Usability
</td>
<td class="hdlist2">
<p>The general mentality of access control setting is one of "sensible defaults" that work for most of the information in the EHR, most of the time. The defaults for the EHR can be set by the patient, defining access control behaviour for the majority of access decisions. Exceptions to the default policy are then added. This approach minimises the need to think about the security of every item in the EHR individually.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Other security policy principles that should be implemented in even a minimal EHR deployment but are not directly specified by openEHR include the following.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Access logging
</td>
<td class="hdlist2">
<p>read accesses by application users to EHR data should be logged in the EHR system. Currently openEHR does not specify models of such logs, but might do so in the future. Studies have shown that making users aware of the fact of access logging is an effective deterrent to inappropriate access (especially where other controls are not implemented). There are some proponents of the argument that even read-access logs should be made part of the content of the EHR proper; currently openEHR does not support this approach.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Record demerging
</td>
<td class="hdlist2">
<p>when data for a patient is found to be in another patients EHR, the access logs for that EHR should be used to determine who has accessed that data, primarily to determine if subsequent clinical thinking (e.g. diagnoses, medication decisions) have been made based on wrong information.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Record merging
</td>
<td class="hdlist2">
<p>when more than one EHR is discovered for the same patient, and have to be merged into a single record, the access control lists have to be re-evaluated and merged by the patient and potentially relevant carers.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Time-limitation of access
</td>
<td class="hdlist2">
<p>mechanisms should be implemented that limit the time during which given health professionals can see the patient record. Usually, the outer limits are defined by the interval of the episode of care in an institution plus some further time to cover follow-up or outpatient care. Episode start and end are recorded in openEHR as instances of the <code>ADMIN_ENTRY</code> class, containing admission and discharge details.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Non-repudiation
</td>
<td class="hdlist2">
<p>if digital signing of changes to the record is made mandatory, non-repudiation of content can be supported by an openEHR system. The digital signing of communications (EHR Extracts) is also supported in openEHR; coupled with logging of communication of Extracts, this can be used to guarantee non-repudiation of information passed between systems (cf. information passed between back-end and front-end applications of the same system).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Certification
</td>
<td class="hdlist2">
<p>a mechanism should be provided to allow a level of trust to be formally associated with user signing keys.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A key feature of the policy is that it must scale to distributed environments in which health record
information is maintained at multiple provider sites visited by the patient.</p>
</div>
<div class="paragraph">
<p>As Anderson points out in the BMA study, policy elements are also needed for guarding against users
gaining access to massive numbers of EHRs, and inferencing attacks. Currently these are outside the
scope of openEHR, and realistically, of most EHR implementations of any kind today.</p>
</div>
<div class="paragraph">
<p>The following sections describe how openEHR supports the first list of policy objectives.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_integrity"><a class="anchor" href="#_integrity"></a>7.3.3. Integrity</h4>
<div class="sect4">
<h5 id="_versioning"><a class="anchor" href="#_versioning"></a>7.3.3.1. Versioning</h5>
<div class="paragraph">
<p>The most basic security-related feature of openEHR is its support for data integrity. This is mainly
provided by the versioning model, specified in the <code>change_control</code> package in the Common Information
Model, and in the Extract Information Model. Change-set based versioning of all information
in the EHR and demographic services constitutes a basic integrity measure for information, since no
content is ever physically modified, only new versions are created. All logical changes and deletions
as well as additions are therefore physically implemented as new Versions rather than changes to
existing information items. Clearly the integrity of the information will depend on the quality of the
implementation; however, the simplest possible implementations (1 Version = 1 copy) can provide
very good safety due to being write-once systems.</p>
</div>
<div class="paragraph">
<p>The use of change-sets, known as Contributions in openEHR, provides a further unit of integrity corresponding
to all items modified, created or deleted in a single unit of work by a user.</p>
</div>
<div class="paragraph">
<p>The openEHR versioning model defines audit records for all changed items, which can be basic
audits and/or any number of additional digitally signed attestations (e.g. by senior staff). This means
that every write access of any kind to any part of an openEHR record is logged with the user identification,
time, reason, and potentially other meta-data.</p>
</div>
</div>
<div class="sect4">
<h5 id="_digital_signature"><a class="anchor" href="#_digital_signature"></a>7.3.3.2. Digital Signature</h5>
<div class="paragraph">
<p>The possibility exists within an openEHR EHR to digitally sign each Version in a Versioned object
(i.e. for each Version of any logical item, such as medications list, encounter note etc.). The signature
is created as a private-key encryption (e.g. RSA-1) of a hash (e.g. MD5) of a canonical representation
(such as in schema-based XML) of the Version being committed. A likely candidate for defining the
signature and digest strings in openEHR is the openPGP message format (<a href="https://www.ietf.org/rfc/rfc4880" target="_blank" rel="noopener">IETF RFC4880</a>), due to
being an open specification and self-describing. The use of RFC 4880 for the format does not imply
the use of the PGP distributed certificate infrastructure, or indeed any certification infrastructure;
openEHR is agnostic on this point. If no public key or equivalent infrastructure is available, the
encryption step might be omitted, resulting in a digest only of the content. The signature is stored
within the Version object, allowing it to be conveniently carried within EHR Extracts. The process is
shown in the following figure.</p>
</div>
<div id="version_signature" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/version_signature.png" alt="version signature" width="80%">
</div>
<div class="title">Figure 28. Version Signature</div>
</div>
<div class="paragraph">
<p>The signing of data in a versioning system acts as an integrity check (the digest performs this function),
an authentication measure (the signature performs this function), and also a non-repudiation
measure. To guard against hacking of the versioned persistence layer itself, signatures can be forwarded
to a trusted notarisation service. A fully secure system based on digital signing also requires
certified public keys, which may or may not be available in any given environment.</p>
</div>
<div class="paragraph">
<p>One of the benefits of digitally signing relatively small pieces of the EHR (single Versions) rather
than the whole EHR or large sections of it is that the integrity of items is more immune to localised
repository corruptions.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_anonymity"><a class="anchor" href="#_anonymity"></a>7.3.4. Anonymity</h4>
<div class="paragraph">
<p>As described above in section 6.1, one of the features of the openEHR EHR is a separation of EHR
(clinical and administrative) information and demographic information. This mainly relates to references
to the patient rather than to provider entities, since the latter are usually publicly known. A special
kind of object known as <code>PARTY_SELF</code> in openEHR is used to refer to the subject in the EHR. The
only information contained in a <code>PARTY_SELF</code> instance is an optional external reference. The
openEHR EHR can be configured to provide 3 levels of separation by controlling whether and where
this external identifier is actually set in <code>PARTY_SELF</code> instances, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nowhere in the EHR (i.e. every <code>PARTY_SELF</code> instance is a blank placeholder). This is the most secure approach, and means that the link between the EHR and the patient has to be done outside the EHR, by associating <code>EHR.<em>ehr_id</em></code> and the subject identifier. This approach is more likely for more open environments.</p>
</li>
<li>
<p>Once only in the <code>EHR_STATUS</code> object (subject attribute), and nowhere else. This is also relatively secure, if the EHR Status object is protected in some way.</p>
</li>
<li>
<p>In every instance of <code>PARTY_SELF</code>; this solution is reasonable in a secure environment, and convenient for copying parts of the record around locally.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This simple mechanism provides a basic protection against certain kinds of information theft or hacking
if used properly. In the most secure situation, a hacker has to steal not just EHR data but also separate
demographic records and an identity cross reference database, both of which can be located on
different machines (making burglary harder). The identity cross-reference database would be easy to
encrypt or protect by other security mechanisms.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_access_control_2"><a class="anchor" href="#_access_control_2"></a>7.4. Access Control</h3>
<div class="sect3">
<h4 id="_overview_5"><a class="anchor" href="#_overview_5"></a>7.4.1. Overview</h4>
<div class="paragraph">
<p>Access control is completely specified in an openEHR EHR in the <code>EHR_ACCESS</code> object for the EHR.
This object acts as a gateway for all information access, and any access decision must be made based
on the policies and rules it contains.</p>
</div>
<div class="paragraph">
<p>One of the problems with defining the semantics of the EHR Access object is that there is currently no published formal, proven model of access control for shared health information. Relevant standards include <a href="https://www.iso.org/standard/50121.html" target="_blank" rel="noopener">ISO 13606-4</a>, <a href="https://www.iso.org/standard/62653.html" target="_blank" rel="noopener">ISO PMAC (Privilege Management and Access Control) standard</a>. Undoubtedly experimental and even some limited production health information security implementations exist. In reality however, no large-scale shared EHR deployments exist, and so security solutions to date are still developmental.</p>
</div>
<div class="paragraph">
<p>The openEHR architecture is therefore designed to accommodate alternative models of access control,
each defined by a subtype of the class <code>ACCESS_CONTROL_SETTING</code> (Security IM). This
approach means that a simplistic access control model can be defined and implemented initially, with
more sophisticated models being used later. The "scheme" in use at any given time is always indicated
in the EHR Access object.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_versioning_2"><a class="anchor" href="#_versioning_2"></a>8. Versioning</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_6"><a class="anchor" href="#_overview_6"></a>8.1. Overview</h3>
<div class="paragraph">
<p>Version control is an integral part of the openEHR architecture. An openEHR repository for EHR or
demographic information is managed as a change-controlled collection of "version containers" (modelled
by the <code>VERSIONED_OBJECT&lt;T&gt;</code> class in the <code>common.change_control</code> package), each containing
the versions of a top-level content structure (such as a Composition or Party) as it changes
over time. A version-controlled top-level content structure is visualised below.</p>
</div>
<div id="version_control_structures" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/version_control_structures.png" alt="version control structures" width="80%">
</div>
<div class="title">Figure 29. Version Signature</div>
</div>
<div class="paragraph">
<p>Versioning of single top-level structures is a necessary, but not sufficient requirement for a repository
that must provide coherence, traceability, indelibility, rollback, and support for forensic examination
of past states of the data. Features supporting "change control" are also required. Under a disciplined
change control scheme, changes are not made arbitrarily to single top-level structures, but to the
repository itself. Changes take the form of change-sets, called "Contributions", that consist of new or
changed versions of the controlled items in the repository. The key feature of a change-set is that it
acts like a transaction, and takes the repository from one consistent state to another, whereas arbitrary
combinations of changes to single controlled items could easily be inconsistent, and even dangerously
wrong where clinical data are concerned.</p>
</div>
<div class="paragraph">
<p>These concepts are well-known in configuration management (CM), and are used as the basis for
most software and other change management systems, including numerous free and commercial
products available today. They are a central design feature of openEHR architecture. The following
sections provide more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_configuration_management_paradigm"><a class="anchor" href="#_the_configuration_management_paradigm"></a>8.2. The Configuration Management Paradigm</h3>
<div class="paragraph">
<p>The <em>configuration management</em> (CM) paradigm is well-known in software engineering, and has its
own standard <a href="https://standards.ieee.org/standard/828-2005.html" target="_blank" rel="noopener">IEEE 828</a>. CM is about managed control of changes to a repository of items (formally
called "configuration items" or CIs), and is relevant to any logical repository of distinct information
items which changes in time. In health information systems, at least two types of information require
such management: electronic health records, and demographic information. In most analyses in the
past, the need for change management has been expressed in terms of specific requirements for audit
trailing of changes, availability of previous states of the repository and so on. In openEHR, the aim is
to provide a formal, general-purpose model for change control, and show how it applies to health
information.</p>
</div>
<div class="sect3">
<h4 id="_organisation_of_the_repository"><a class="anchor" href="#_organisation_of_the_repository"></a>8.2.1. Organisation of the Repository</h4>
<div class="paragraph">
<p>The general organisation of a repository of complex information items such as a software repository,
or the EHR consists of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a number of distinct information items, or configuration items, each of which is uniquely identified, and may have any amount of internal complexity;</p>
</li>
<li>
<p>optionally, a directory system of some kind, in which the configurations items are organised;</p>
</li>
<li>
<p>other environmental information which may be relevant to correctly interpreting the primary versioned items, e.g. versions of tools used to create them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In a software or document repository, the CIs are files arranged in the directories of the file system; in
an EHR based on openEHR, they are Compositions, the optional Folder structure, Parties in the
demographic service and so on. Contributions are made to the repository by users. This general
abstraction is visualised as follows.</p>
</div>
<div id="controlled_repository" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/controlled_repository.png" alt="controlled repository" width="55%">
</div>
<div class="title">Figure 30. General Structure of a Controlled Repository</div>
</div>
</div>
<div class="sect3">
<h4 id="_change_management"><a class="anchor" href="#_change_management"></a>8.2.2. Change Management</h4>
<div class="paragraph">
<p>Change doesnt occur to Configuration Items in isolation, but to the repository as a whole. Possible types of change include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>creation of a new CI;</p>
</li>
<li>
<p>removal of a CI;</p>
</li>
<li>
<p>modification of a CI;</p>
</li>
<li>
<p>creation of, change to or deletion of part of the directory structure;</p>
</li>
<li>
<p>moving of a CI to another location in the directory structure;</p>
</li>
<li>
<p>attestation of an existing CI.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The goal of configuration management is to ensure the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the repository is always in a valid state;</p>
</li>
<li>
<p>any previous state of the repository can be reconstructed;</p>
</li>
<li>
<p>all changes are audit-trailed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_managing_changes_in_time"><a class="anchor" href="#_managing_changes_in_time"></a>8.3. Managing Changes in Time</h3>
<div class="paragraph">
<p>Properly managing changes to the repository requires two mechanisms. The first, version control, is
used to manage versions of each CI, and of the directory structure if there is one. The second is the
concept of the "change-set", known as a contribution in openEHR. This is the set of changes to individual
CIs (and other top-level structures in the EHR) made by a user as part of some logical change.
For example, in a document repository, the logical change might be an update to a document that consists
of multiple files (CIs). There is one Contribution, consisting of changes to the document file CIs,
to the repository. In the EHR, a Contribution might consist of changes to more than one Composition,
and possibly to the organising Folder structure. Any change to the EHR requires a Contribution. The
kinds of changes that can occur to items affected in a Contribution are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>addition of new item</em>: a new Version container is created and a first Version added to it;</p>
</li>
<li>
<p><em>deletion of item</em>: a new Version whose data attribute is set to Void is added to an existing Version container;</p>
</li>
<li>
<p><em>modification of item</em>: a new Version whose data contains the updated form of the item content is added to an existing Version container (this may be done for a logical update or correction);</p>
</li>
<li>
<p><em>import of item</em>: a new import Version is created, incorporating the received Version;</p>
</li>
<li>
<p><em>attestation of item</em>: a new Attestation is added to the attestations list of an existing Version.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A typical sequence of changes to a repository is illustrated in the following figure.</p>
</div>
<div id="contribution_deltas" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/ehr_contributions_deltas.svg" alt="ehr contributions deltas" width="80%">
</div>
<div class="title">Figure 31. Contributions to the Repository (delta form)</div>
</div>
<div class="paragraph">
<p>This shows the effect of five Contributions (left hand side) to a repository containing a number of CIs. As each Contribution is made, the repository is changed in some way. The first brings into existing a new CI, and modifies two others (changes indicated by the 'update' triangles). The second Contribution causes the creation of a new CI due to importing from a lab data feeder system. The third causes a creation as well as three changes, while the fourth causes an amendment to an existing CI.</p>
</div>
<div class="paragraph">
<p>One nuance which should be pointed out is that in the figure above Contributions are shown as if they are
literally a set of deltas, i.e. exactly the changes which occur to the record. Thus, the first Contribution
is the set {CI<sub>w</sub>, C<sub>a1</sub>, C<sub>c1</sub>, C<sub>d1</sub>} and so on. Whether this is literally true depends on the construction of
the persistence solution. In some situations, some CIs may be updated by the user viewing the current
list and entering just the changes - the situation shown above; in others, the system may provide
the current state of these CIs for editing by the user, and submit the updated versions, as shown
in the next figure. Some applications may do both, depending on which CI is being updated. The internal
versioning implementation may or may not generate deltas as a way of efficient storage.</p>
</div>
<div id="contributions_non_delta" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/ehr_contributions_non_deltas.svg" alt="ehr contributions non deltas" width="80%">
</div>
<div class="title">Figure 32. Contributions to the Repository (non-delta form)</div>
</div>
<div class="paragraph">
<p>For the purposes of openEHR, a Contribution is considered as being the set of Versions created or
attested at one time, as implied by the figure above.</p>
</div>
<div class="sect3">
<h4 id="_general_model_of_a_change_controlled_repository"><a class="anchor" href="#_general_model_of_a_change_controlled_repository"></a>8.3.1. General Model of a Change-controlled Repository</h4>
<div class="paragraph">
<p>The following figure shows an abstract model of a change-controlled repository.</p>
</div>
<div id="abstract_model_repository" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/abstract_model_repository.png" alt="abstract model repository" width="60%">
</div>
<div class="title">Figure 33. Abstract Model of Change-controlled Repository</div>
</div>
<div class="paragraph">
<p>This consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>version-controlled configuration items - instances of <code>VERSIONED_OBJECT&lt;T&gt;</code>;</p>
</li>
<li>
<p><code>CONTRIBUTIONs</code>;</p>
</li>
<li>
<p>an optional directory system of folders. If folders are used, the folder structure must also be versioned as a unit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The actual type of links between the controlled repository and the other entities might vary - in some
cases it might be association, in others aggregation; cardinalities might also vary. The figure above therefore provides a guide to the definition of actual controlled repositories, such as an EHR, rather than a
formal specification for them.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_virtual_version_tree"><a class="anchor" href="#_the_virtual_version_tree"></a>8.4. The Virtual Version Tree</h3>
<div class="paragraph">
<p>An underlying design concept of the versioning model defined in openEHR is known as a "virtual version tree".
The idea is simple in the abstract. Information is committed to a repository (such as an
EHR) in lumps, each lump being the "data" of one Version. Each Version has its place within a version
tree, which in turn is maintained inside a Versioned object (or "version container"). The virtual
version tree concept means that any given Versioned object may have numerous copies in various
systems, and that the creation of versions in each is done in such a way that all versions so created are
in fact compatible with the "virtual" version tree resulting from the superimposition of the version
trees of all copies. This is achieved using simple rules for version identification and is done to facilitate
data sharing. Two very common scenarios are served by the virtual version tree concept:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>longitudinal data that stands as a proxy for the state or situation of the patient such as "Medications" or "Problem list" (persistent Compositions in openEHR) is created and maintained in one or more care delivery organisations, and shared across a larger number of organisations;</p>
</li>
<li>
<p>some EHRs in an EHR server in one location are mirrored into one or more other EHR servers (e.g. at care providers where the relevant patients are also treated); the mirroring process requires asynchronous synchronisation between servers to work seamlessly, regardless of the location, time, or author of any data created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The versioning scheme used in openEHR guarantees that no matter where data are created or copied,
there are no inconsistencies due to sharing, and that logical copies are explicitly represented. It therefore
provides direct support for shared data in a shared care context.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_identification"><a class="anchor" href="#_identification"></a>9. Identification</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_identification_of_the_ehr"><a class="anchor" href="#_identification_of_the_ehr"></a>9.1. Identification of the EHR</h3>
<div class="paragraph">
<p>In an openEHR system, each EHR has a unique identifier, known as the EHR id, found in the root
EHR object of each EHR. EHR ids should be "strong" globally unique identifiers such as reliably created
Oids or Guids. <strong>No single system should contain two EHRs for the same subject.</strong> If this is not
the case, it means that the EHR system has failed to detect the existence of an EHR for a subject, or
failed to match provided demographic attributes to the subject.</p>
</div>
<div class="paragraph">
<p>In a distributed environment, the correspondence of EHR ids to subjects (i.e. patients) is variable, and
depends on the level of integration of the environment. In non-integrated or sporadically connected
environments, the same patient is likely to have a separate EHR at each institution, each with its own
unique EHR id, but the same subject id. If copies of parts of the patient EHR at one location is
requested by another provider, the received items will be merged into the local EHR for that patient.
Merges of persistent Compositions in such circumstances are likely to require human intervention.
Multiple EHR ids per patient in a distributed context are evidence of a lack of systematic connectivity
or identification service.</p>
</div>
<div class="paragraph">
<p>In a fully integrated distributed environment, the typical patient will still have local EHRs in multiple
locations, but each carrying the same EHR id. When a patient presents in a new location, a request to
the environments identification service could be made to determine if there is already an EHR for
this patient. If there is, a clone of all or part of the existing EHR could be made, or a new empty EHR
could be created, but in all cases, the EHR id would be the same as that used in other locations for the
same patient.</p>
</div>
<div class="paragraph">
<p>Note that the above logic only holds where the EHR in each location is an openEHR EHR.</p>
</div>
</div>
<div class="sect2">
<h3 id="_identification_of_items_within_the_ehr"><a class="anchor" href="#_identification_of_items_within_the_ehr"></a>9.2. Identification of Items within the EHR</h3>
<div class="sect3">
<h4 id="_general_scheme"><a class="anchor" href="#_general_scheme"></a>9.2.1. General Scheme</h4>
<div class="paragraph">
<p>While identification of EHRs is not completely definable by openEHR, the identification of items
within an EHR is fully defined. The scheme described here requires two kinds of "identifier": identifiers
proper and references, or locators. An identifier is a unique (within some context) symbol or
number given to an object, and usually written into the object, whereas a reference is the use of an
identifier by an exterior object, to refer to the object containing the identifier in question. This distinction
is the same as that between primary and foreign keys in a relational database system.</p>
</div>
<div class="paragraph">
<p>In the openEHR RM, identifiers and references are implemented with two groups of classes defined
in the <code>support.identification</code> package. Identifiers of various kinds are defined by descendant
classes of <code>OBJECT_ID</code>, while references are defined by the classes inheriting from <code>OBJECT_REF</code>. The
distinction is illustrated in the following figure. Here we see two container objects with <code>OBJECT_IDs</code> (since
<code>OBJECT_ID</code> is an abstract type, the actual type will be another <code>XXX_ID</code> class), and various
<code>OBJECT_REFs</code> as references.</p>
</div>
<div id="ids_and_references" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/ids_and_references.png" alt="ids and references" width="50%">
</div>
<div class="title">Figure 34. XXX_IDs and XXX_REFs</div>
</div>
</div>
<div class="sect3">
<h4 id="_levels_of_identification"><a class="anchor" href="#_levels_of_identification"></a>9.2.2. Levels of Identification</h4>
<div class="paragraph">
<p>In order to make data items locatable from the outside, identification is supported at 3 levels in
openEHR, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>version containers</em>: <code>VERSIONED_OBJECTs</code> (Common IM) are identified uniquely;</p>
</li>
<li>
<p><em>top-level content structures</em>: content structures such as <code>COMPOSITION</code>, <code>EHR_STATUS</code>, <code>EHR_ACCESS</code>, <code>PARTY</code> etc. are uniquely identified by the association of the identifier of their containing <code>VERSIONED_OBJECT</code> and the identifier of their containing <code>VERSION</code> within the container;</p>
</li>
<li>
<p><em>internal nodes</em>: nodes within top-level structures are identified using paths.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Three kinds of identification are used respectively. For version containers, meaningless unique identifiers (UIDs) are used. In most cases, the type <code>HIER_OBJECT_ID</code> will be used, which contains an instance of a subtype of the <code>UID</code> class, i.e. either an ISO OID or a UUID (<a href="https://www.ietf.org/rfc/rfc4122" target="_blank" rel="noopener">IETF RFC4122</a>; also known as a GUID). UUIDs are strongly preferred in openEHR since they require no central assignment and can be generated on the spot. A versioned container can be then referenced with an <code>OBJECT_REF</code> containing its identifier.</p>
</div>
<div class="paragraph">
<p>Versions of top-level structures (i.e. objects of type  <code>VERSION&lt;X&gt;</code>, such as <code>VERSION&lt;COMPOSITION&gt;</code>) are identified in a way that is guaranteed to work even in distributed environments where copying, merging and subsequent modification occur. The full identification of a Version is the globally unique tuple consisting of the <code><em>uid</em></code> of the owning <code>VERSIONED_OBJECT</code>, and the two <code>VERSION</code> attributes <code><em>creating_system_id</em></code> and <code><em>version_tree_id</em></code>. The
<code><em>creating_system_id</em></code> attribute carries a unique identifier for the system where the content was first created; this may be a GUID, Oid or reverse internet identifier. The <code><em>version_tree_id</em></code> is a 1 or 3-part number string, such as <code>"1"</code> or for a branch, <code>"1.2.1"</code>. A typical version identification tuple is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>F7C5C7B7-75DB-4b39-9A1E-C0BA9BFDBDEC    -- id of VERSIONED_COMPOSITION
au.gov.health.rdh.ehr1                  -- id of creating system
2                                       -- current version</code></pre>
</div>
</div>
<div class="paragraph">
<p>This 3-part tuple is known as a <em>version locator</em> and is defined by the class <code>OBJECT_VERSION_ID</code> in the <a href="https://specifications.openehr.org/releases/BASE/latest/base_types.html#_identification_package" target="_blank" rel="noopener"><code>identification</code> package section of the Base Types specification</a>. The openEHR version identification scheme is described in detail in the <a href="https://specifications.openehr.org/releases/RM/latest/common.html#_change_control_package" target="_blank" rel="noopener"><code>change_control</code> package section of the Common IM</a>.</p>
</div>
<div class="paragraph">
<p>The contained top-level content item (i.e. a <code>COMPOSITION</code> etc) also has a <code><em>uid</em></code> attribute (inherited from <code>LOCATABLE</code>), and it is strongly recommended that this be populated with a copy of the <code>OBJECT_VERSION_ID</code> from the containing <code>VERSION&lt;X&gt;</code> object. This facilitates identifying versions from a naked content object e.g. returned in a query.</p>
</div>
<div class="paragraph">
<p>A <code>VERSION</code> can be <em>referred to</em> using a normal <code>OBJECT_REF</code> that contains a copy of the version&#8217;s <code>OBJECT_VERSION_ID</code>.</p>
</div>
<div class="paragraph">
<p>The last component of identification is the <em>path</em>, used to refer to an interior node of a top-level structure of some type <code>X</code> (e.g. <code>COMPOSITION</code>, <code>PARTY</code>, etc), the latter identified by its Version locator. Paths in openEHR follow an Xpath style syntax, with slight abbreviations to shorten paths in the most common cases. Paths are described in detail below.</p>
</div>
<div class="paragraph">
<p>To refer to an interior data node from outside a top-level structure, a combination of a  version locator
and a path is required. This is formalised by the <code>LOCATABLE_REF</code> class, also in the <a href="https://specifications.openehr.org/releases/BASE/latest/base_types.html#_identification_package" target="_blank" rel="noopener"><code>identification</code>
package section of the Base Types specification</a>. A Universal Resource Identifier (URI) form can also be used,
defined by the <a href="https://specifications.openehr.org/releases/RM/latest/data_types.html#_uri_package" target="_blank" rel="noopener">data type <code>DV_EHR_URI</code></a>. This type provides a single string expression
in the scheme-space <code>ehr:</code> which can be used to refer to an interior data node from anywhere. (It can
also be used to represent queries; see below). Any <code>LOCATABLE_REF</code> can be converted to a
<code>DV_EHR_URI</code>, although not all <code>DV_EHR_URIs</code> are <code>LOCATABLE_REFs</code>.</p>
</div>
<div class="paragraph">
<p>The figure below summarises how various types of <code>OBJECT_ID</code> and <code>OBJECT_REF</code> are used to identify
objects, and to reference them from the outside, respectively.</p>
</div>
<div id="object_referencing" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/object_referencing.svg" alt="object referencing">
</div>
<div class="title">Figure 35. How to reference various levels of object</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_archetypes_and_templates"><a class="anchor" href="#_archetypes_and_templates"></a>10. Archetypes and Templates</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_7"><a class="anchor" href="#_overview_7"></a>10.1. Overview</h3>
<div class="paragraph">
<p>Under the multi-level modelling approach, the formal definition of information structuring occurs at
two levels. The lower level is that of the reference model, a stable object model from which software
and data can be built. Concepts in the openEHR reference model are invariant, and include things like
Composition, Section, Observation, and various data types such as Quantity and Coded text. The
upper level consists of domain-level definitions in the form of archetypes and templates. Concepts
defined at this level include things such as 'blood pressure measurement', 'SOAP headings', and
'HbA1c Result'.</p>
</div>
<div class="paragraph">
<p>All information conforming to the openEHR Reference Model (RM) - i.e. the collection of Information
Models (IMs) - is 'archetypable', meaning that the creation and modification of the content, and
subsequent querying of data is controllable by archetypes. Archetypes are themselves separate from
the data, and are stored in their own repository. The archetype repository at any particular location
will usually include archetypes from well-known online archetype libraries. Archetypes are deployed
at runtime via templates that specify particular groups of archetypes to use for a particular purpose,
often corresponding to a screen form.</p>
</div>
<div class="paragraph">
<p>Archetypes are themselves instances of an archetype model, which defines a language in which to
write archetypes; the syntax equivalent of the model is the Archetype Definition Language, ADL.
These formalisms are specified in the openEHR Archetype Object Model (AOM) and ADL documents
respectively. Each archetype is a set of constraints on the reference model, defining a subset of
instances that are considered to conform to the subject of the archetype, e.g. 'laboratory result'. An
archetype can thus be thought of as being similar to a LEGO&#174; instruction sheet (e.g. for a tractor) that
defines the configuration of LEGO&#174; bricks making up a tractor. Archetypes are flexible; one archetype
includes many variations, in the same way that a LEGO&#174; instruction might include a number of
options for the same basic object. Mathematically, an archetype is equivalent to a query in F-logic <a href="#Kifer_Lausen_Wu2000">Kifer Lausen &amp; Wu (2000)</a>.</p>
</div>
<div class="paragraph">
<p>In terms of scope, archetypes are general-purpose, re-usable, and composable. For data capture and
validation purposes, they are usually used at runtime by templates.
An openEHR Template is a specification that defines a tree of one or more archetypes, each constraining
instances of various reference model types, such as Composition, Section, Entry subtypes
and so on. Thus, while there are likely to be archetypes for such things as 'biochemistry results' (an
Observation archetype) and 'SOAP headings' (a Section archetype), templates are used to put archetypes
together to form whole Compositions in the EHR, e.g. for 'discharge summary', 'antenatal
exam' and so on. Templates usually correspond closely to screen forms, printed reports, and in general,
complete application-level lumps of information to be captured or sent; they may therefore be
used to define message content. They are generally developed and used locally, while archetypes are
usually widely used.</p>
</div>
<div class="paragraph">
<p>A template is used at runtime to create default data structures and to validate data input, ensuring that
all data in the EHR conform to the constraints defined in the archetypes referenced by the template. In
particular, it conforms to the path structure of the archetypes, as well as their terminological constraints.
Which archetypes were used at data creation time is written into the data, in the form of both
archetype identifiers at the relevant root nodes, and archetype node identifiers (the [atnnnn] codes),
which act as normative node names, and which are in turn the basis for paths. When it comes time to
modify the same data, these archetype node identifiers enable applications to retrieve and use the
original archetypes, ensuring modifications respect the original constraints.</p>
</div>
<div class="paragraph">
<p>Archetypes also form the basis of semantic querying. Queries are expressed in a language which is a
synthesis of SQL (SELECT/FROM/WHERE) and W3C XPaths, extracted from the archetypes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_archetype_formalisms_and_models"><a class="anchor" href="#_archetype_formalisms_and_models"></a>10.2. Archetype Formalisms and Models</h3>
<div class="sect3">
<h4 id="_overview_8"><a class="anchor" href="#_overview_8"></a>10.2.1. Overview</h4>
<div class="paragraph">
<p>In openEHR, archetypes are formalised by the Archetype Object Model (AOM). This is an object
model of the semantics of archetypes. When an archetype is represented in memory (for example in
an archetype-enabled EHR 'kernel'), the archetype will exist as instances of the classes of this
model. The AOM is thus the definitive statement of the semantics of archetypes.</p>
</div>
<div class="paragraph">
<p>In serialised form, archetypes can be represented in various ways. The normative, abstract serialisation in openEHR is Archetype Definition Language (ADL). This is an abstract language based on Frame Logic queries with the addition of terminology. An ADL archetype is a guaranteed 100% lossless rendering of the semantics of any archetype, and is designed to be a syntactic analogue of the AOM. Nevertheless, other lossless and lossy serialisations are possible and some already exist. For practical purposes, XML-based serialisations are used in some situations. A serialisation purely expressed in ODIN, the ADL object serialisation syntax is available for ADL2 archetypes. Various HTML, RTF and other formats are used for screen rendering and human review.</p>
</div>
<div class="paragraph">
<p>openEHR ADL2 Templates are represented as ODIN documents whose object model conforms to the AOM.</p>
</div>
</div>
<div class="sect3">
<h4 id="_design_time_relationships_between_archetypes"><a class="anchor" href="#_design_time_relationships_between_archetypes"></a>10.2.2. Design-time Relationships between Archetypes</h4>
<div class="paragraph">
<p>Archetypes are extensible formal constraint definitions of object structures. In common with object
model classes, they can be specialised, as well as composed (i.e. aggregated). Specialised archetypes
are created when an archetype is already available for the content that needs to be modelled, but it
lacks detail or is too general. For example, the archetype <code>openEHR-EHR-OBSERVATION.laboratory.v1</code>
contains generic concepts of 'specimen', 'diagnostic service', a single result of any type,
and a two-level result battery for grouped results. This archetype could be (and has been) used to represent
nearly any kind of laboratory result data. However, specialisations such as <code>openEHR-EHROBSERVATION.laboratory-glucose.v1</code>
are extremely useful, and can be easily defined based
on the predecessor; in this case, the single result node is redefined to be 'blood glucose'. The formal
rule for specialisation is that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a specialised archetype can only further narrow existing constraints in the parent (but it may add its own).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This has the effect that the data created with any specialised archetype will always be matched by
queries based on the parent archetype - in other words, a query for 'laboratory' Observations will correctly
retrieve 'glucose' Observations as well. This accords with the basic ontological principle of
subsumption, which says that instances of a type B are also instances of type A, where type B is
related to type A by the semantic relationship 'IS-A'. Specialised archetypes are indicated by the use
of an identifier derived from the parent archetype, with a new sub-element of the semantic part of the
identifier, separated by a '-' character.</p>
</div>
<div class="paragraph">
<p>The second relationship possible between archetypes is composition, allowing large data structures to
be flexibly constrained via the hierarchical re-use of smaller archetypes. Composition is defined in
terms of 'slots' within an archetype. A slot is a point in an archetype structure where, instead of specifying
an object type inline, a special allow_archetype constraint is used to specify other archetypes
constraining that same type, that may be used at that point. For example, the archetype <code>openEHR-EHR-SECTION.vital_signs.v1</code>
defines a heading structure for headings to do with vital signs. It
also defines as its items attribute value (i.e. what comes under the heading) a number of possible
Observations; however, rather than defining these inline, it specifies an archetype slot in the form of
constraints on Observation archetypes that are allowed at that point. The simplest kind of constraint is
in terms of regular expressions on archetype identifiers. More complex constraints can be stated in
terms of paths in other archetypes (for example <code>exists (/some/path[at0005])</code>). A slot thus
defines a 'chaining point' in terms of possible archetypes allowed or excluded at that point; limiting
this to a single archetype is of course possible. Templates are used to choose which particular archetypes
allowed at a slot will actually be used in a given circumstance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_of_archetypes_and_templates_to_data"><a class="anchor" href="#_relationship_of_archetypes_and_templates_to_data"></a>10.3. Relationship of Archetypes and Templates to Data</h3>
<div class="paragraph">
<p>All nodes within the top-level information structures in the openEHR RM are 'archetypable', with
certain nodes within those structures being archetype 'root points'. Each top-level type is always
guaranteed to be an archetype root point. Although it is theoretically possible to use a single archetype
for an entire top-level structure, in most cases, particularly for <code>COMPOSITION</code> and <code>PARTY</code>, a hierarchical
structure of multiple archetypes will be used, via the slot mechanism described above. This
allows for componentisation and reusability of archetypes. When hierarchies of archetypes are used
for a top-level structure, there will also be archetype root points in the interior of the structure. For
example, within a <code>COMPOSITION</code>, <code>ENTRY</code> instances (i.e. <code>OBSERVATIONs</code>, <code>EVALUATIONs</code> etc.) are
almost always root points. <code>SECTION</code> instances are root points if they are the top instance in a Section
structure; similarly for <code>FOLDER</code> instances within a directory structure. Other nodes (e.g. interior <code>SECTIONs</code>,
<code>ITEM_STRUCTURE</code> instances) might also be archetype root points, depending on how archetypes
are applied at runtime to data. The following figure illustrates the application of archetypes and
templates to data.</p>
</div>
<div id="archetypes_and_data" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/archetypes_and_data.png" alt="archetypes and data" width="80%">
</div>
<div class="title">Figure 36. How Archetypes apply to Data</div>
</div>
</div>
<div class="sect2">
<h3 id="_archetype_enabling_of_reference_model_data"><a class="anchor" href="#_archetype_enabling_of_reference_model_data"></a>10.4. Archetype-enabling of Reference Model Data</h3>
<div class="paragraph">
<p>Archetype-enabling of Reference Model classes is achieved via inheritance of the class <code>LOCATABLE</code>
from the package <code>common.archetyped</code> (see Common IM). The <code>LOCATABLE</code> class includes the
attributes <code><em>archetype_node_id</em></code> and <code><em>archetype_details</em></code>. In the data, the former carries an identifier from
the archetype. If the node in the data is a root point, it carries the multipart identifier of the generating
archetype, and <code><em>archetype_details</em></code> carries an <code>ARCHETYPED object</code>, containing information pertinent to
archetype root points. If it is a non-root node, the <code><em>archetype_node_id</em></code> attribute carries the identifier
(known as an 'at', or 'archetype term' code) of the archetype interior node that generated the data
node, and the <code><em>archetype_details</em></code> attribute is void.</p>
</div>
<div class="paragraph">
<p>Sibling nodes in data can carry the same <code><em>archetype_node_id</em></code> in some cases, since archetypes provide a
pattern for data, rather than an exact template. In other words, depending on the archetype design, a
single archetype node may be replicated in the data.</p>
</div>
<div class="paragraph">
<p>In this way, each archetyped data composition in openEHR data has a generating archetype which
defines the particular configuration of instances to create the desired composition. An archetype for
'biochemistry results' is an <code>OBSERVATION</code> archetype, and constrains the particular arrangement of
instances beneath an <code>OBSERVATION</code> object; a 'problem/SOAP headings' archetype constrains <code>SECTION</code>
objects forming a SOAP headings structure. In general, an archetyped data composition is any
composition of data starting at a root node and continuing to its leaf nodes, at which point lower-level
compositions, if they exist, begin. Each of the archetyped areas and its subordinate archetyped areas in <a href="#archetypes_and_data">Figure 36</a> is an archetyped data composition.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
care must be taken not to confuse the general term 'composition' with the specific use of this word in
openEHR and <a href="https://www.iso.org/standard/62305.html" target="_blank" rel="noopener">ISO 13606</a>, defined by the <code>COMPOSITION</code> class; the specific use is always indicated by
using the term 'Composition'.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The result of the use of archetypes to create data in the EHR (and other systems) is that the structure
of data in any top-level object conforms to the constraints defined in a composition of archetypes chosen
by a template, including all optionality, value, and terminology constraints.</p>
</div>
</div>
<div class="sect2">
<h3 id="_archetypes_templates_and_paths"><a class="anchor" href="#_archetypes_templates_and_paths"></a>10.5. Archetypes, Templates and Paths</h3>
<div class="paragraph">
<p>The use of openEHR archetypes and templates enables paths to be used ubiquitously in the openEHR
architecture. Paths are extracted from Archetypes and templates, and are constructed from attribute
names and archetype node identifiers, in an Xpath-compatible syntax, as shown in the following figure.
These paths serve to identify any node in a template or archetype, such as the 'diastolic blood pressure'
<code>ELEMENT</code> node, deep within a 'blood pressure measurement' archetype. Since archetype node
identifiers are embedded into data at runtime, archetype paths can be used to extract data nodes conforming
to particular parts of archetypes, providing a very powerful basis for querying. Paths can also
be constructed into data, using more complex predicates (still in the Xpath style). Paths in openEHR
are explained in detail under <a href="#_paths_and_locators">Section 11</a>.</p>
</div>
<div id="archetype_paths" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/archetype_paths.png" alt="archetype paths">
</div>
<div class="title">Figure 37. Paths extracted from an archetype</div>
</div>
</div>
<div class="sect2">
<h3 id="_archetypes_and_templates_at_runtime"><a class="anchor" href="#_archetypes_and_templates_at_runtime"></a>10.6. Archetypes and Templates at Runtime</h3>
<div class="sect3">
<h4 id="_overview_9"><a class="anchor" href="#_overview_9"></a>10.6.1. Overview</h4>
<div class="paragraph">
<p>openEHR archetypes and templates were designed as formal artefacts, so as to be computable at runtime.
They perform two key functions. The first is to facilitate data validation at data capture or import
time, i.e. to guarantee that data conform to not just the reference model, but also to the archetypes
themselves. Data validation with archetypes is mediated by the use of openEHR Templates. The second
function is as a design basis for queries. Since data are captured based on archetypes, all
openEHR data are guaranteed to conform to the 'semantic paths' that are created by the composition
of archetypes within a template. The paths (such as those shown in figure <a href="#archetype_paths">Figure 37</a> above) are incorporated within a familiar SQL-style syntax, to form queries that can be evaluated to retrieve items on a
semantic basis.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploying_archetypes_and_templates"><a class="anchor" href="#_deploying_archetypes_and_templates"></a>10.6.2. Deploying Archetypes and Templates</h4>
<div class="paragraph">
<p>Archetypes are mostly designed by clinical or other domain experts, and often require significant
study of a subject area, for example, obstetrics. The development process may occur at a national or
international level, and requires peer review and testing in real systems. This accords with the semantic
value of archetypes, namely as reusable models of content. Consequently, from the point of view
of any given site of deployment, archetypes are most likely to have been developed elsewhere, and to
reside in a recognised, quality assured repository.</p>
</div>
<div class="paragraph">
<p>Such a repository may contain hundreds or even thousands of archetypes. However, most EHR sites
will only require a relatively small number. Clinical experts estimate that 100 archetypes would take
care of 80% of routine general practice and acute care, including laboratory, with many of these being
specialisations of a much smaller number of key archetypes. However, which 100 archetypes are useful
for a given site may well vary based on the kind of health care provided, e.g. diabetic clinic, cancer,
orthopedic hospital ward, aged care home. In general, it can be expected that nearly all archetype
deployment sites will use only a small percentage of published archetypes. Some sites may also
develop a small number of their own archetypes; invariably these will be specialisations of existing
archetypes.</p>
</div>
<div class="paragraph">
<p>While archetypes constitute the main shared and carefully quality-assured design activity in the second
layer of openEHR&#8217;s two-level structure, templates are a more local affair, and are likely to be the
point of contact of many system designers with archetypes. A template will typically be designed
based on three things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>what is desired to be in a screen form or report;</p>
</li>
<li>
<p>what archetypes are already available;</p>
</li>
<li>
<p>local usage of terminology.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Templates will generally be created locally by tools conforming to the openEHR Template Object
Model.</p>
</div>
<div class="paragraph">
<p>In the case of GUI applications, the final step in the chain is GUI screen forms. These are created in a
multitude of ways and technologies. In some cases, they will be partially or completely generated
from templates. Regardless of the details, the connection between a screen form and a template will
be established in the tooling environment, so that when the form is requested by a user, the relevant
template will be activated, in turn activating the relevant archetypes.</p>
</div>
<div class="paragraph">
<p>A further technical detail may come into play in many deployment situations: since the archetypes
and templates required by the environment will be known in advance, they may well be compiled into
a near-runtime form from the sharable openEHR form (i.e. ADL, TOM files) in which they are
received from a repository or local tool. This form will usually differ from site to site, and both
improves performance and ensures that only validated archetypes and templates will actually be
accessed by applications. In such systems, runtime form of templates is most likely to incorporate
copies of the relevant archetypes.</p>
</div>
<div class="paragraph">
<p>The deployment of archetypes, templates, and screen forms is shown below.</p>
</div>
<div id="archetype_use" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/archetype_use.png" alt="archetype use" width="80%">
</div>
<div class="title">Figure 38. Deployment of Archetypes and Templates</div>
</div>
</div>
<div class="sect3">
<h4 id="_validation_during_data_capture"><a class="anchor" href="#_validation_during_data_capture"></a>10.6.3. Validation during Data Capture</h4>
<div class="paragraph">
<p>Validation is the primary runtime function of archetypes - it is how 'archetype-based' data are created
in the first place, and modified thereafter. Archetype-based validation can be used in a GUI
application or in a data import service. Although the source of the data (keystrokes or received XML
or other messages) is different, the logical process is the same: create archetype-based openEHR data
according to the input stream.</p>
</div>
<div class="paragraph">
<p>The process at runtime may vary in some details according to implementations and other aspects of
the care setting, but the main thrust will be the same. The archetypes used at a particular site will
always be mediated at runtime by openEHR templates developed for that site or system; these will
usually be linked to screen forms or other formal artefacts that enable the connection between archetypes
and the user or application. It will not be uncommon for a template to be constructed partially at
runtime, due to user choices of archetypes being made on the screen, although of course the user will
not be directly aware of this. Regardless, by the time data are created and validated against the relevant
archetypes, the template that does the job will be completely specified.</p>
</div>
<div class="paragraph">
<p>The actual process of data creation and committal is illustrated below. The essence of the
process is that a 'kernel' component performs the task of data creation and validation by maintaining
a 'template space' and a 'data space'. The former contains the template and archetypes retrieved due
to a screen form being displayed; the latter contains the data structures (instances of the openEHR reference
model) that are constructed due to user activity on the screen. When data are finally committed,
they are guaranteed to conform to the template/archetype definitions, due to the checks that are
made each time the user tries to change the data structure. The committed data contain a 'semantic
imprint' of the generating archetypes, in the form of archetype node identifiers on every node of the
data. This simple inclusion in the data model ensures that all archetypes data are queryable by the use
of archetype paths. In XML representations, the archetype node ids are represented as XML attributes
(i.e. inside the tag), thus enabling XPaths to be conveniently navigated through the data based on
these identifiers (more details on this are in the next section).</p>
</div>
<div id="kernel" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/kernel.png" alt="kernel" width="80%">
</div>
<div class="title">Figure 39. Templated Archetypes at Runtime</div>
</div>
<div class="paragraph">
<p>If data are later modified, they are brought into the kernel along with the relevant template and archetypes,
and the embedded node identifiers allow the kernel to continue to perform appropriate checking
of changes to the data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_querying"><a class="anchor" href="#_querying"></a>10.6.4. Querying</h4>
<div class="paragraph">
<p>The second major computational function of archetypes is to support querying. As described above,
and in the next section, the paths extracted from archetypes are the basis for queries into the data.
Queries are defined in AQL (Archetype Query Language), which is essentially a synthesis of SQL
and XPath style paths extracted from archetypes. The following is an example AQL query meaning
"Get the BMI values which are more than 30 kg/m2 for a specific patient":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-k">SELECT</span> <span class="tok-n">o</span><span class="tok-o">/</span><span class="tok-p">[</span><span class="tok-n">at0000</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-k">data</span><span class="tok-p">[</span><span class="tok-n">at0001</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-n">events</span><span class="tok-p">[</span><span class="tok-n">at0002</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-k">data</span><span class="tok-p">[</span><span class="tok-n">at0003</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-n">item</span><span class="tok-p">[</span><span class="tok-mi">0004</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-n">value</span>
<span class="tok-k">FROM</span> <span class="tok-n">EHR</span> <span class="tok-p">[</span><span class="tok-n">uid</span><span class="tok-o">=@</span><span class="tok-n">ehrUid</span><span class="tok-p">]</span>
<span class="tok-k">CONTAINS</span> <span class="tok-n">COMPOSITION</span> <span class="tok-k">c</span> <span class="tok-p">[</span><span class="tok-n">openEHR</span><span class="tok-o">-</span><span class="tok-n">EHR</span><span class="tok-o">-</span><span class="tok-n">COMPOSITION</span><span class="tok-p">.</span><span class="tok-n">report</span><span class="tok-p">.</span><span class="tok-n">v1</span><span class="tok-p">]</span>
<span class="tok-k">CONTAINS</span> <span class="tok-n">OBSERVATION</span> <span class="tok-n">o</span><span class="tok-p">[</span><span class="tok-n">openEHR</span><span class="tok-o">-</span><span class="tok-n">EHR</span><span class="tok-o">-</span><span class="tok-n">OBSERVATION</span><span class="tok-p">.</span><span class="tok-n">body_mass_index</span><span class="tok-p">.</span><span class="tok-n">v1</span><span class="tok-p">]</span>
<span class="tok-k">WHERE</span> <span class="tok-n">o</span><span class="tok-o">/</span><span class="tok-p">[</span><span class="tok-n">at0000</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-k">data</span><span class="tok-p">[</span><span class="tok-n">at0001</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-n">events</span><span class="tok-p">[</span><span class="tok-n">at0002</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-k">data</span><span class="tok-p">[</span><span class="tok-n">at0003</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-n">item</span><span class="tok-p">[</span><span class="tok-mi">0004</span><span class="tok-p">]</span><span class="tok-o">/</span><span class="tok-n">value</span> <span class="tok-o">&gt;</span> <span class="tok-mi">30</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_openehr_archetypes"><a class="anchor" href="#_the_openehr_archetypes"></a>10.7. The openEHR Archetypes</h3>
<div class="paragraph">
<p>A set of heavily reviewed archetypes is available on <a href="http://www.openehr.org/ckm">the openEHR Clinical Knowledge Manager
(CKM)</a>. This collection is authored by hundreds of clinical professionals,
and is constantly growing.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_paths_and_locators"><a class="anchor" href="#_paths_and_locators"></a>11. Paths and Locators</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_10"><a class="anchor" href="#_overview_10"></a>11.1. Overview</h3>
<div class="paragraph">
<p>The openEHR architecture includes a path mechanism that enables any node within a top level structure
to be specified from the top of the structure using a "semantic" (i.e. archetype-based) X-path
compatible path. The availability of such paths radically changes the available querying possibilities
with health information, and is one of the major distinguishing features of openEHR.</p>
</div>
<div class="paragraph">
<p>Technically, the combination of a path and a Version identifier such as <code>OBJECT_VERSION_ID</code> forms
a 'globally qualified node reference' which can be expressed using <code>LOCATABLE_REF</code>. It can also be
expressed in portable URI form as a <code>DV_EHR_URI</code>, known as a 'globally qualified node locator'.
Either representation enables any openEHR data node to be referred to from anywhere. This section
describes the syntax and semantics of paths, and of the URI form of reference. In the following, the
term 'archetype path' means a path extracted from an archetype, while "data path" means one that
identifies an item in data. They are no different formally, and this terminology is only used to indicate
where they are used.</p>
</div>
</div>
<div class="sect2">
<h3 id="_paths"><a class="anchor" href="#_paths"></a>11.2. Paths</h3>
<div class="sect3">
<h4 id="_basic_syntax"><a class="anchor" href="#_basic_syntax"></a>11.2.1. Basic Syntax</h4>
<div class="paragraph">
<p>Paths in openEHR are defined in an Xpath1-compatible syntax which is a superset of the path syntax
described in the Archetype Definition Language (ADL). The syntax is designed to be easily mappable
to <a href="https://www.w3.org/TR/xpath-31/" target="_blank" rel="noopener">W3C Xpath expressions</a>, for use with openEHR-based XML.</p>
</div>
<div class="paragraph">
<p>The data path syntax used in locator expressions follows the general pattern of a path consisting of
segments each consisting of an attribute name, and separated by the slash ('/') character, i.e.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>attribute_name / attribute_name / ... / attribute_name</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In all openEHR documentation, the term 'attribute' is used in the object-oriented sense of 'property of an object', not in the XML sense of named values appearing within a tag. The syntax described here should not be considered to necessarily have a literal mapping to XML instance, but rather to have a logical mapping to object-oriented data structures.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Paths select the object which is the value of the final attribute name in the path, when going from
some starting point in the tree and following attribute names given in the path. The starting point is
indicated by the initial part of the path, and can be specified in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>relative path</em>: path starts with an attribute name, and the starting point is the current point in the tree (given by some previous operation or knowledge);</p>
</li>
<li>
<p><em>absolute path</em>: path starts with a <code>/</code>; the starting point is the top of the structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the <code>//</code> notation from Xpath can be used to define a path pattern:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>path pattern</em>: path starts with or contains the symbol '//' and is taken to be a pattern which can match any number of path segments in the data; the pattern is matched if an actual path can be found anywhere in the structure for which part of the path matches the path section before the <code>//</code> symbol, and a later section matches the section appearing after the <code>//</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_predicate_expressions"><a class="anchor" href="#_predicate_expressions"></a>11.2.2. Predicate Expressions</h4>
<div class="sect4">
<h5 id="_overview_11"><a class="anchor" href="#_overview_11"></a>11.2.2.1. Overview</h5>
<div class="paragraph">
<p>Paths specified solely with attribute names are limited in two ways. Firstly, they can only locate objects in structures in which there are no containers such as lists or sets. However, in any realistic data, including most openEHR data, list, set and hash structures are common. Additional syntax is needed to match a particular object from among the siblings referred to by a container attribute. This takes the form of a predicate expression enclosed in brackets ('[]') after the relevant attribute in a segment, i.e.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>attribute_name [predicate expression]</pre>
</div>
</div>
<div class="paragraph">
<p>The general form of a path then resembles the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>attribute_name / attribute_name [predicate expression] / ...</pre>
</div>
</div>
<div class="paragraph">
<p>Here, predicate expressions are used optionally on those attributes defined in the reference model to be of a container type (i.e. having a cardinality of &gt; 1). If a predicate expression is not used on a container attribute, the whole container is selected. Note that predicate expressions are often possible even on single-valued attributes, and can be used (e.g. if generic path-processing software can&#8217;t tell the difference) but are not required.</p>
</div>
<div class="paragraph">
<p>The second limitation of basic paths is that they cannot locate objects based on other conditions, such as the object having a child node with a particular value. To address this, predicate expressions can be used to select an object on the basis of other conditions relative to the object, by including boolean expressions including paths, operators, values and parentheses. The syntax of predicate expressions used in openEHR is a subset of the Xpath syntax for predicates with a small number of short-cuts.</p>
</div>
</div>
<div class="sect4">
<h5 id="_archetype_path_predicate"><a class="anchor" href="#_archetype_path_predicate"></a>11.2.2.2. Archetype path Predicate</h5>
<div class="paragraph">
<p>The most important predicate uses the archetype_node_id value (inherited from <code>LOCATABLE</code>) to limit the items returned from a container, such as to certain <code>ELEMENTs</code> within a <code>CLUSTER</code>. The shortcut form allows the archetype code to be included on its own as the predicate, e.g. <code>[at0003]</code>. This shortcut corresponds to using an archetype path against the runtime data. A typical archetype-derived path is the following (applied to an Observation instance):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[at0003]/data/items[at0025]/value/magnitude</pre>
</div>
</div>
<div class="paragraph">
<p>This path refers to the magnitude of a 1-minute Apgar total in an Observation containing a full Apgar result structure. In this path, the <code>[atNNNN]</code> predicates are a shortcut for <code>[@archetype_node_id = 'atNNNN']</code> in standard Xpath.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
while an archetype path is always unique in an archetype, it can correspond to more than one item in runtime data, due to the repeated use of the same archetype node within a container.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_name_based_predicate"><a class="anchor" href="#_name_based_predicate"></a>11.2.2.3. Name-based Predicate</h5>
<div class="paragraph">
<p>If the <code>LOCATABLE.<em>name</em></code> value in certain data is populated with meaningful values, a useful predicate can be formed using a combination of <code>name.value</code> (which takes the Xpath-like form <code>name/value</code> in a predicate) and the <code><em>archetype_node_id</em></code> value. The standard Xpath form of this expression is exemplified by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[@archetype_node_id = 'at0001' and name/value='standing']</pre>
</div>
</div>
<div class="paragraph">
<p>with the openEHR equivalent being:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[at0001 and name/value='standing']</pre>
</div>
</div>
<div class="paragraph">
<p>Since the combination of an archetype node identifier and a <code><em>name</em></code> value is very common in archetyped databases, a shortcut is also available for the <code><em>name/value</em></code> expression, which is to simply include the value after a comma as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[at0001, 'standing']</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_other_predicates"><a class="anchor" href="#_other_predicates"></a>11.2.2.4. Other Predicates</h5>
<div class="paragraph">
<p>Other predicates can be used, based on the value of other attributes such as <code>ELEMENT.<em>name</em></code> or
<code>EVENT.<em>time</em></code>. Combinations of the archetype_node_id and other such values are commonly used in
querying, such as the following path fragment (applied to an <code>OBSERVATION</code> instance):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[at0007 AND time &gt;= '24-06-2005T09:30:00']</pre>
</div>
</div>
<div class="paragraph">
<p>This path would choose Events in <code>OBSERVATION.<em>data</em></code> whose <code><em>archetype_node_id</em></code> meaning is 'summary
event' (<code>at0007</code> in some archetype) and which occurred at or after the given time. The following
example would choose an Evaluation containing a diagnosis (<code>at0002.1</code>) of 'other bacterial intestinal
infections' (ICD10 code <code>A04</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/items[at0002.1
    AND value/defining_code/terminology_id/value = 'ICD10AM'
    AND value/defining_code/code_string = 'A04']</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_paths_within_top_level_structures"><a class="anchor" href="#_paths_within_top_level_structures"></a>11.2.3. Paths within Top-level Structures</h4>
<div class="paragraph">
<p>Paths within top-level structures strictly adhere to attribute and function names in the relevant parts of the reference model. Predicate expressions are needed to distinguish multiple siblings in various points in paths into these structures, but particularly at archetype "chaining" points. A chaining point is where one archetype takes over from another as illustrated in figure <a href="#archetypes_and_data">Figure 36</a>. Chaining points in Compositions occur between the Composition and a Section structure, potentially between a Section structure and other sub-Section structures (constrained by a different Section archetype), and between either Compositions or Section structures, and Entries. Chaining might also occur inside an Entry, if archetyping is used on lower level structures such as Item_lists etc. Most chaining points correspond to container types such as <code>List&lt;T&gt;</code> etc., e.g. <code>COMPOSITION.<em>content</em></code> is defined to be a <code>List&lt;CONTENT_ITEM&gt;</code>, meaning that in real data, the content of a Composition could be a List of Section structures. To distinguish between such sibling structures, predicate expressions are used, based on the archetype_id. At the root point of an archetype in data (e.g. top of a Section structure), the archetype_id carries the identifier of the archetype used to create that structure, in the same manner as any interior point in an archetyped structure has an <code><em>archetype_node_id</em></code> attribute carrying archetype <code><em>node_id</em></code> values. The chaining point between Sections and Entries works in the same manner, and since multiple Entries can occur under a single Section, <code><em>archetype_id</em></code> predicates are also used to distinguish them. The same shorthand is used for <code><em>archetype_id</em></code> predicate expressions as for <code><em>archetype_node_ids</em></code>, i.e. instead of using <code>[@archetype_id = "xxxxx"]</code>, <code>[xxxx]</code> can be used instead.</p>
</div>
<div class="paragraph">
<p>The following paths are examples of referring to items within a Composition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/content[openEHR-EHR-SECTION.vital_signs.v1 and name/value='Vital signs']/items[openEHR-EHR-OBSERVATION.heart_rate-pulse.v1 and name/value='Pulse']/data/events[at0003 and name/value='Any event']/data/items[at1005]

/content[openEHR-EHR-SECTION.vital_signs.v1 and name/value='Vital signs']/items[openEHR-EHR-OBSERVATION.blood_pressure.v1 and name/value='Blood pressure']/data/events[at0006 and name/value='any event']/data/items[at0004]

/content[openEHR-EHR-SECTION.vital_signs.v1, 'Vital signs']/items[openEHR-EHR-OBSERVATION.blood_pressure.v1, 'Blood pressure']/data/events[at0006, 'any event']/data/items[at0005]</pre>
</div>
</div>
<div class="paragraph">
<p>Paths within the other top level types follow the same general approach, i.e. are created by following
the required attributes down the hierarchy.</p>
</div>
</div>
<div class="sect3">
<h4 id="_data_paths_and_uniqueness"><a class="anchor" href="#_data_paths_and_uniqueness"></a>11.2.4. Data Paths and Uniqueness</h4>
<div class="paragraph">
<p>Archetype paths are not guaranteed to uniquely identify items in data, due to the fact that one archetype
node may correspond to multiple instances in the data. However it is often useful to be able
to construct a unique path to an item in real data. This can be done by using attributes other than
<code><em>archetype_node_id</em></code> in path predicates.</p>
</div>
<div class="sect4">
<h5 id="_using_a_uid_based_predicate"><a class="anchor" href="#_using_a_uid_based_predicate"></a>11.2.4.1. Using a Uid-based Predicate</h5>
<div class="paragraph">
<p>The most reliable way to obtain unique path for run-time nodes in data is is by populating the inherited <code>LOCATABLE.<em>uid</em></code> field with UUIDs. A predicate can be formed from just the <code><em>uid</em></code> value, or the combination of  <code><em>uid</em></code> value and the <code><em>archetype_node_id</em></code> value, which although technically speaking is redundant, is more informative (e.g. it can be displayed with the <code><em>archetype_node_id</em></code> meaning visible for the user). This is the preferred method to achieve runtime unique node identification. The standard Xpath form of this expression is exemplified by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[@uid='25f2f224-64f0-41ec-a5c7-c31c040c77ce']   &lt;!-- assumes 'uid' is an XML attribute in XSD --&gt;
/data/events[@archetype_node_id = 'at0001' and @uid='25f2f224-64f0-41ec-a5c7-c31c040c77ce']</pre>
</div>
</div>
<div class="paragraph">
<p>with the openEHR equivalent being:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[uid='25f2f224-64f0-41ec-a5c7-c31c040c77ce']
/data/events[at0001 and uid='25f2f224-64f0-41ec-a5c7-c31c040c77ce']</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_using_a_name_based_predicate"><a class="anchor" href="#_using_a_name_based_predicate"></a>11.2.4.2. Using a Name-based Predicate</h5>
<div class="paragraph">
<p>If the <code>LOCATABLE.<em>name</em></code> value in certain data is known to be reliably populated with unique values across immediate siblings, the <code>name/value</code> term may be used as described above to form a uniquely identifying predicate for a node. Consider as an example the following <code>OBSERVATION</code> archetype (expressed in <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">ODIN syntax</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span>                               <span class="tok-c">-- blood pressure measurement</span>
    <span class="tok-nc">data</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
        <span class="tok-nc">HISTORY</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
            <span class="tok-nc">events</span> <span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                <span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span> <span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span>              <span class="tok-c">-- any event</span>
                    <span class="tok-nc">name</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                        <span class="tok-nc">DV_TEXT</span> <span class="tok-o">matches </span><span class="tok-p">{...}</span>
                    <span class="tok-p">}</span>
                    <span class="tok-nc">data</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                        <span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span>         <span class="tok-c">-- systemic arterial BP</span>
                            <span class="tok-nc">count</span> <span class="tok-o">matches </span><span class="tok-p">{|&gt;=</span><span class="tok-mi">2</span><span class="tok-p">|}</span>
                            <span class="tok-nc">items</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                <span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span>   <span class="tok-c">-- systolic BP</span>
                                    <span class="tok-nc">name</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                        <span class="tok-nc">DV_TEXT</span> <span class="tok-o">matches </span><span class="tok-p">{...}</span>
                                    <span class="tok-p">}</span>
                                    <span class="tok-nc">value</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                        <span class="tok-nc">magnitude</span> <span class="tok-o">matches </span><span class="tok-p">{...}</span>
                                    <span class="tok-p">}</span>
                                <span class="tok-p">}</span>
                                <span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span>   <span class="tok-c">-- diastolic BP</span>
                                    <span class="tok-nc">name</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                        <span class="tok-nc">DV_TEXT</span> <span class="tok-o">matches </span><span class="tok-p">{...}</span>
                                    <span class="tok-p">}</span>
                                    <span class="tok-nc">value</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                        <span class="tok-nc">magnitude</span> <span class="tok-o">matches </span><span class="tok-p">{...}</span>
                                    <span class="tok-p">}</span>
                                <span class="tok-p">}</span>
                            <span class="tok-p">}</span>
                        <span class="tok-p">}</span>
                    <span class="tok-p">}</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following path extracted from the archetype refers to the systolic blood pressure magnitude:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[at0006]/data/items[at0004]/value/magnitude</pre>
</div>
</div>
<div class="paragraph">
<p>The codes <code>[atnnnn]</code> at each node of the archetype become the <code><em>archetype_node_id</em></code> found in each node in the data.</p>
</div>
<div class="paragraph">
<p>Now consider an <code>OBSERVATION</code> instance (expressed here in <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">ODIN syntax</a>), in which a history of two blood pressures has been recorded using this archetype:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-p">&lt;</span>                                                       <span class="tok-c">-- OBSERVATION - blood pressure measurement</span>
    <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;openEHR-EHR-OBSERVATION.blood_pressure.v1&quot;</span><span class="tok-p">&gt;</span>
    <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;BP measurement&quot;</span><span class="tok-p">&gt;&gt;</span>
    <span class="tok-nc">data</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                                            <span class="tok-c">-- HISTORY</span>
        <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">&gt;</span>
        <span class="tok-nc">origin</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-ld">2005-12-03T09:22:00</span><span class="tok-p">&gt;</span>
        <span class="tok-nc">events</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                                      <span class="tok-c">-- List &lt;EVENT&gt;</span>
            <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                                     <span class="tok-c">-- EVENT</span>
                <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;sitting&quot;</span><span class="tok-p">&gt;&gt;</span>
                <span class="tok-nc">time</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-ld">2005-12-03T09:22:00</span><span class="tok-p">&gt;</span>
                <span class="tok-nc">data</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                                <span class="tok-c">-- ITEM_LIST</span>
                    <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">items</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                           <span class="tok-c">-- List&lt;ELEMENT&gt;</span>
                        <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                            <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;systolic&quot;</span><span class="tok-p">&gt;&gt;</span>
                            <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">&gt;</span>
                            <span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">magnitude</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-mf">120.0</span><span class="tok-p">&gt;</span> <span class="tok-p">...&gt;</span>
                        <span class="tok-p">&gt;</span>
                        <span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                            <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;diastolic&quot;</span><span class="tok-p">&gt;&gt;</span>
                            <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">&gt;</span>
                            <span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">magnitude</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-mf">80.0</span><span class="tok-p">&gt;</span> <span class="tok-p">...&gt;</span>
                        <span class="tok-p">&gt;</span>
                    <span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
            <span class="tok-p">&gt;</span>
            <span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                                     <span class="tok-c">-- EVENT</span>
                <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;standing&quot;</span><span class="tok-p">&gt;&gt;</span>
                <span class="tok-nc">time</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-ld">2005-12-03T09:27:00</span><span class="tok-p">&gt;</span>
                <span class="tok-nc">data</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                                <span class="tok-c">-- ITEM_LIST</span>
                    <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">items</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>                           <span class="tok-c">-- List&lt;ELEMENT&gt;</span>
                        <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                            <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;systolic&quot;</span><span class="tok-p">&gt;&gt;</span>
                            <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">&gt;</span>
                            <span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">magnitude</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-mf">105.0</span><span class="tok-p">&gt;</span> <span class="tok-p">...&gt;</span>
                        <span class="tok-p">&gt;</span>
                        <span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                            <span class="tok-nc">name</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;diastolic&quot;</span><span class="tok-p">&gt;&gt;</span>
                            <span class="tok-nc">archetype_node_id</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">&gt;</span>
                            <span class="tok-nc">value</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-nc">magnitude</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-mf">70.0</span><span class="tok-p">&gt;</span> <span class="tok-p">...&gt;</span>
                        <span class="tok-p">&gt;</span>
                    <span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
            <span class="tok-p">&gt;</span>
        <span class="tok-p">&gt;</span>
    <span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The same data are shown in JSON syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span><span class="tok-p">{</span>
    <span class="tok-nt">&quot;_type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;OBSERVATION&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;openEHR-EHR-OBSERVATION.blood_pressure.v1&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;BP measurement&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0001&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;origin&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;2005-12-03T09:22:00&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;events&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;_type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;POINT_EVENT&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0006&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;sitting&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-nt">&quot;time&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;2005-12-03T09:22:00&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;_type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;ITEM_LIST&quot;</span><span class="tok-p">,</span>
                    <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0003&quot;</span><span class="tok-p">,</span>
                    <span class="tok-nt">&quot;items&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
                        <span class="tok-p">{</span>
                            <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;systolic&quot;</span>
                            <span class="tok-p">},</span>
                            <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0004&quot;</span><span class="tok-p">,</span>
                            <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;magnitude&quot;</span><span class="tok-p">:</span> <span class="tok-mf">120.0</span>
                            <span class="tok-p">}</span>
                        <span class="tok-p">},</span>
                        <span class="tok-p">{</span>
                            <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;diastolic&quot;</span>
                            <span class="tok-p">},</span>
                            <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0005&quot;</span><span class="tok-p">,</span>
                            <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;magnitude&quot;</span><span class="tok-p">:</span> <span class="tok-mf">80.0</span>
                            <span class="tok-p">}</span>
                        <span class="tok-p">}</span>
                    <span class="tok-p">]</span>
                <span class="tok-p">}</span>
            <span class="tok-p">},</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;_type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;POINT_EVENT&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0006&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;standing&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-nt">&quot;time&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;2005-12-03T09:27:00&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;_type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;ITEM_LIST&quot;</span><span class="tok-p">,</span>
                    <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0003&quot;</span><span class="tok-p">,</span>
                    <span class="tok-nt">&quot;items&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
                        <span class="tok-p">{</span>
                            <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;systolic&quot;</span>
                            <span class="tok-p">},</span>
                            <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0004&quot;</span><span class="tok-p">,</span>
                            <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;magnitude&quot;</span><span class="tok-p">:</span> <span class="tok-mf">105.0</span>
                            <span class="tok-p">}</span>
                        <span class="tok-p">},</span>
                        <span class="tok-p">{</span>
                            <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;diastolic&quot;</span>
                            <span class="tok-p">},</span>
                            <span class="tok-nt">&quot;archetype_node_id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;at0005&quot;</span><span class="tok-p">,</span>
                            <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
                                <span class="tok-nt">&quot;magnitude&quot;</span><span class="tok-p">:</span> <span class="tok-mf">70.0</span>
                            <span class="tok-p">}</span>
                        <span class="tok-p">}</span>
                    <span class="tok-p">]</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">]</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
in the above example, <code><em>name</em></code> values are shown as if they were all <code>DV_TEXTs</code>, whereas in reality in openEHR they more likely to be <code>DV_CODED_TEXT</code> instances; either is allowed by the archetype. This has been done to reduce the size of the example, and makes no difference to the paths shown below.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The archetype path mentioned above matches both systolic pressures in the recording. In many querying situations, this may be the intention. However, to uniquely match each of the systolic pressure nodes, paths would need to be created that are based not only on the <code><em>archetype_node_id</em></code> but also on another attribute. In the case above, the <code><em>name</em></code> attribute may be used, if it is known to have been reliably populated with unique values across sets of immediate siblings under container attributes. The paths are created using the openEHR shortcut form of the `name/value' predicate described earlier, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[at0006, 'sitting']/data/items[at0004]/value/magnitude
/data/events[at0006, 'sitting']/data/items[at0005]/value/magnitude
/data/events[at0006, 'standing']/data/items[at0004]/value/magnitude
/data/events[at0006, 'standing']/data/items[at0005]/value/magnitude</pre>
</div>
</div>
<div class="paragraph">
<p>Each of these paths has an Xpath equivalent of the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[@archetype_node_id='at0006' and name/value='standing']/data/items[@archetype_node_id='at0004']/value/magnitude</pre>
</div>
</div>
<div class="paragraph">
<p>To achieve unique paths based on the <code>LOCATABLE.<em>name</em></code> attribute, the system has to specifically ensure uniqueness of <code><em>name</em></code> for sibling nodes, e.g. by systematically being set to a copy of one or more other attribute values. For example, in an <code>EVENT</code> object, <code><em>name</em></code> could be a string copy of the <code><em>time</em></code> attribute.</p>
</div>
<div class="paragraph">
<p>In general, uniqueness of property values of sibling nodes is not required, and the only guaranteed unique paths are those based on positional predicates.</p>
</div>
</div>
<div class="sect4">
<h5 id="_using_positional_parameters"><a class="anchor" href="#_using_positional_parameters"></a>11.2.4.3. Using Positional Parameters</h5>
<div class="paragraph">
<p>If it is known within a system that the order of items in container attributes in the data is always preserved across storage, transformation etc, guaranteed unique paths can be created using the Xpath positional parameter. Using the above example, unique to the systolic and diastolic pressures of each event (sitting and standing measurements) can be constructed using the following expressions (identical in openEHR and Xpath):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/events[1]/data/items[1]/value/magnitude
/data/events[1]/data/items[2]/value/magnitude
/data/events[2]/data/items[1]/value/magnitude
/data/events[2]/data/items[2]/value/magnitude</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ehr_uris"><a class="anchor" href="#_ehr_uris"></a>11.3. EHR URIs</h3>
<div class="paragraph">
<p>There are two broad categories of URIs that can be used with any resource: direct references, and queries. The first kind are usually generated by the system containing the referred-to item, and passed to other systems as definitive references, while the second are queries from the requesting system in the form of a URI.</p>
</div>
<div class="paragraph">
<p>Query-oriented URIs are not formally defined here, since the expectation is that a query service will be used, and that URI formats for querying will dependent on the type of service (for example REST URIs are usually based on served resources).</p>
</div>
<div class="paragraph">
<p>A dedicated type <code>DV_EHR_URI</code> is defined within the RM <code>data_types</code> package to carry the URIs described here. A <code>DV_EHR_URI</code> instance can only refer to an entity within an openEHR EHR (i.e. not some other kind of resource).</p>
</div>
<div class="paragraph">
<p>The following guiding principles have been used to inform the design of EHR URIs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is assumed that one URI 'scheme' (i.e. what precedes the ':' in an <a href="https://www.ietf.org/rfc/rfc3986" target="_blank" rel="noopener">IETF RFC3986</a> URI) is used for each major category of data, i.e. EHR, demographics, etc. Thus, the <code>ehr</code> scheme corresponds to EHR content.</p>
</li>
<li>
<p>URIs described here refer to information items within <code>VERSION.<em>data</em></code>, i.e. to objects such as <code>COMPOSITION</code> or <code>FOLDER</code>;</p>
</li>
<li>
<p>Versions are identified within URIs either via the relevant <code>VERSIONED_OBJECT.<em>uid</em></code> (i.e. a GUID)  or the <code>VERSION.<em>uid</em></code> (a 3-part <code>OBJECT_VERSION_ID</code>).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ehr_reference_uris"><a class="anchor" href="#_ehr_reference_uris"></a>11.3.1. EHR Reference URIs</h4>
<div class="paragraph">
<p>To create a reference to a node in an EHR in the form of a URI (uniform resource identifier), three elements are needed: the path within a top-level structure, a reference to a top-level structure within an EHR, a reference to an EHR, and an optional reference to an EHR system (i.e. repository). These can be combined to form a URI in an 'ehr' scheme-space which conforms to the following model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr://system_id/ehr_id/top_level_structure_locator/path_inside_top_level_structure

// ----------- variations -----------
ehr://system_id/ehr_id                // refer to an EHR within a specific EHR system/service
ehr:/ehr_id	                      // refer to an EHR within the &#39;current&#39; (i.e. local) EHR system
ehr:/ehr_id/top_level_structure_locator // a specific COMPOSITION, FOLDER etc
ehr:/ehr_id/top_level_structure_locator/path_inside_top_level_structure
                                      // a sub-item of a specific COMPOSITION, FOLDER etc</code></pre>
</div>
</div>
<div class="paragraph">
<p>The possible values for <code>top_level_structure_locator</code> come from attribute names of the class <code>EHR</code>, visible in the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#" class="bare">https://specifications.openehr.org/releases/RM/latest/ehr.html#</a><em>ehr_package[ehr package^], namely <code>_compositions</em></code>, <code><em>directory</em></code> etc.</p>
</div>
<div class="paragraph">
<p>In this way, any object in any openEHR EHR is addressable via a URI. Within <code>ehr</code> space, URL-style references to particular servers, hosts etc are not used, due to not being reliable in the long term. Instead, logical identifiers for EHRs and/or subjects are used, ensuring that URIs remain correct for the lifetime of the resources to which they refer. The openEHR data type <code>DV_EHR_URI</code> is designed to carry URIs of this form, enabling URIs to be constructed for use within <code>LINKs</code> and elsewhere in the openEHR EHR.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
So-called 'plain-text URIs' that contain RFC-3986 forbidden characters such as spaces etc, are allowed on the basis of human readability, but must be RFC-3986 encoded prior to use in e.g. REST APIs or other contexts relying on machine-level conformance.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="https://www.ietf.org/rfc/rfc3986" target="_blank" rel="noopener">RFC-3986, Universal Resource Identifiers in WWW</a> by Tim Berners-Lee. See W3C document <a href="http://www.w3.org/Addressing" target="_blank" rel="noopener">Naming and Addressing: URIs, URLs, &#8230;&#8203;</a> for a starting point on URIs.</p>
</div>
<div class="paragraph">
<p>An <code>ehr:</code> URI implies the availability of a name resolution mechanism in ehr-space, similar to the DNS, which provides such services for http-, ftp- and other well-known URI schemes. Until such services are established, ad hoc means of dealing with <code>ehr:</code> URIs are likely to be used, as well as more traditional <code>http://</code> style references. The subsections below describe how URIs of both kinds can be constructed.</p>
</div>
<div class="sect4">
<h5 id="_ehr_location"><a class="anchor" href="#_ehr_location"></a>11.3.1.1. EHR Location</h5>
<div class="paragraph">
<p>In ehr-space, a direct locator for an EHR is an EHR identifier (i.e. <code>EHR.<em>ehr_id</em></code>) as distinct from a subject or patient identifier. Normally the copy in the 'local system' is the one required, and a majority of the time, may be the only one in existence. In this case, the required EHR can be identified simply by an unqualified identifier, giving a URI of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr:/347a5490-55ee-4da9-b91a-9bba710f730e/</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, due to copying / synchronising of the EHR for one subject among multiple EHR systems, a given EHR identifier may exist at more than one location. It is not guaranteed that each such EHR is a completely identical copy of the others, since partial copying is allowed. Therefore, in an environment where EHR copies exist, and there is a need to identify exactly which EHR instance is required, a system identifier is also required, giving a URI of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr://rmh.nhs.net/347a5490-55ee-4da9-b91a-9bba710f730e/</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_top_level_structure_locator"><a class="anchor" href="#_top_level_structure_locator"></a>11.3.1.2. Top-level Structure Locator</h5>
<div class="paragraph">
<p>There are two logical ways to identify a top-level structure in an openEHR EHR. The first is via the identifier of the required top-level object (i.e. <code>VERSIONED_OBJECT.<em>uid</em></code>). When a URI uses the object identifier, the latest trunk version is always assumed. This leads to URIs like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr:/347a5490-55ee-4da9-b91a-9bba710f730e/compositions/87284370-2D4B-4e3d-A3F3-F303D2F4F34B
ehr:/347a5490-55ee-4da9-b91a-9bba710f730e/directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second way to identify a top-level structure is by using an exact Version identifier, which takes the form <code>object_id::creating_system_id::version_tree_id</code>. This leads to URIs like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr:/347a5490-55ee-4da9-b91a-9bba710f730e/compositions/87284370-2D4B-4e3d-A3F3-F303D2F4F34B::rmh.nhs.net::2</code></pre>
</div>
</div>
<div class="paragraph">
<p>This URI identifies a top-level item whose version identifier is <code>87284370-2D4B-4e3d-A3F3-F303D2F4F34B::rmh.nhs.net::2</code>, i.e. the second trunk version of the Versioned Object indentified by the GUID, created at an EHR system identified by <code>net.nhs.rmh</code>. Note that the mention of a system in the version identifier does not imply that the requested EHR is at that system, only that the top-level object being sought was created at that system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_item_uris"><a class="anchor" href="#_item_uris"></a>11.3.1.3. Item URIs</h5>
<div class="paragraph">
<p>With the addition of path expressions as described earlier, URIs can be constructed that refer to the finest grained items in the openEHR EHR, such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr:/347a5490-55ee-4da9-b91a-9bba710f730e/compositions/87284370-2D4B-4e3d-A3F3-F303D2F4F34B/content[openEHR-EHR-SECTION.vital_signs.v1]/items[openEHR-EHR-OBSERVATION.heart_rate-pulse.v1]/data/events[at0006, &#39;any event&#39;]/data/items[at0004]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_relative_uris"><a class="anchor" href="#_relative_uris"></a>11.3.1.4. Relative URIs</h5>
<div class="paragraph">
<p>URIs can also be constructed relative to the current EHR, in which case they do not mention the EHR id, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="uri"><span></span>ehr:compositions/87284370-2D4B-4e3d-A3F3-F303D2F4F34B/content[openEHR-EHR-SECTION.vital_signs.v1]/items[openEHR-EHR-OBSERVATION.blood_pressure.v1]/data/events[at0006, &#39;any event&#39;]/data/items[at0004]
ehr:directory</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_terminology_in_openehr"><a class="anchor" href="#_terminology_in_openehr"></a>12. Terminology in openEHR</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_12"><a class="anchor" href="#_overview_12"></a>12.1. Overview</h3>
<div class="paragraph">
<p>openEHR archetypes provide a powerful way to define the meaning of clinical and related data, and
to connect, or "bind", data to recognised terminologies such as <a href="http://loinc.org" target="_blank" rel="noopener">LOINC</a>, <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">ICDx</a>, <a href="http://www.who.int/classifications/icd/adaptations/icpc2/en/" target="_blank" rel="noopener">ICPC</a>, <a href="http://www.ihtsdo.org" target="_blank" rel="noopener">SNOMED CT</a>
and the many other terminologies and vocabularies used in healthcare. Terminology is used in
openEHR in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The values of coded attributes in the reference model are defined by an "openEHR" terminology.</p>
</li>
<li>
<p>Each archetype contains its own internal terminology, defining the meaning of each element.</p>
</li>
<li>
<p>Bindings to external terminologies can be included in an archetype, allowing direct mappings to terms, or mappings to queries that return specific value sets.</p>
</li>
<li>
<p>Querying the EHR using external terminologies is supported by archetype bindings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections describe these features.</p>
</div>
</div>
<div class="sect2">
<h3 id="_terminology_to_support_the_reference_model"><a class="anchor" href="#_terminology_to_support_the_reference_model"></a>12.2. Terminology to Support the Reference Model</h3>
<div class="paragraph">
<p>openEHR has its own small terminology and code sets, which are used to provide the value sets of a
number of attributes in the reference model. Code sets are used to express well-known internationally
standardised lists of codes where the codes themselves have meaningful values e.g. the ISO 3166
country codes ("au", "cn", "pl" etc). Six such code sets are used by various attributes in the reference
model, each of type <code>CODE_PHRASE</code> (the openEHR type used to represent a term code).
For other coded attributes, such as <code>PARTICIPATION</code>.<code><em>function</em></code> in the reference model, the openEHR
terminology takes the more orthodox route in terminology design, and defines value sets in groups
using meaningless codes and rubrics. These attributes are always of type <code>DV_CODED_TEXT</code>; the code
itself is contained within the defining_code attribute.</p>
</div>
<div class="paragraph">
<p>The openEHR terminology is described in the <a href="https://specifications.openehr.org/releases/TERM/latest/SupportTerminology.html" target="_blank" rel="noopener">openEHR Terminology specification</a>, with computable
expressions available at the <a href="https://github.com/openEHR/terminology" target="_blank" rel="noopener">openEHR terminology Git repository</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_archetype_internal_terminology"><a class="anchor" href="#_archetype_internal_terminology"></a>12.3. Archetype Internal Terminology</h3>
<div class="paragraph">
<p>Archetypes contain their own local terminology (found in the 'ontology' section of an archetype).
The use of internal term sets is appropriate when there is no structure to the terms (ie no relationships)
and when synonyms are not important. Thus, the use is limited to small flat lists of terms. The advantages
of the terms being internal to the archetype, apart from computational efficiency mentioned
above, are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Queries can be based on archetypes alone and do not require interacting with a terminology server;</p>
</li>
<li>
<p>Translation of the terms is made within an explicit thematic context (since every archetype is about a specific topic) and is therefore far more likely to be accurate;</p>
</li>
<li>
<p>Many terms required in archetypes are not available even in very large terminologies;</p>
</li>
<li>
<p>People can share data based on archetypes even if they do not share terminologies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is clear, however, that many archetypes require a connection to external terminologies to provide
the full benefits of automatic processing; this is described in the next section.
The internal terminology takes the form of a set of <code>{code, text, description}</code> semantic definitions for
each node of the archetype structure. Each such term is identified by an "at" (archetype term) code,
e.g. <code>[at0012]</code>. Each code defined locally in an archetype is used for one of two purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either to semantically identify the data nodes of the archetype (i.e. to "name" the data), or</p>
</li>
<li>
<p>to provide value-sets for leaf attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the local codes in an "Apgar result" archetype could contain terms for "1 minute
event" and "2 minute event". These codes are associated with the reference model nodes within the
'definition' part of the archetype. In the Apgar example, the two codes (say <code>[at0003]</code> and <code>[at0026]</code>)
will be mapped to nodes of reference model type <code>EVENT</code> (<code>rm.data_structures.history</code> package),
as shown below. It is this mapping that is the basis for archetype paths: an archetype
path is simply the alternating pattern of reference model attribute names and node codes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span> <span class="tok-c">-- Apgar score</span>
    <span class="tok-nc">data</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
        <span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span> <span class="tok-c">-- history</span>
            <span class="tok-nc">events</span> <span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*; unordered</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                <span class="tok-nc">POINT_EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span> <span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-c">-- 1 minute</span>
                    <span class="tok-nc">offset</span> <span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-ld">PT1M</span><span class="tok-p">|}</span>
                    <span class="tok-nc">data</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                        <span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span> <span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-c">-- structure</span>
                            <span class="tok-nc">items</span> <span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1; ordered</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                <span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span> <span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-c">-- Heart r</span>
                                    <span class="tok-nc">value</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                        <span class="tok-nc">ORDINAL</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                            <span class="tok-nc">value</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                                                <span class="tok-m">0</span><span class="tok-p">|</span><span class="tok-nd">[local::at0006]</span><span class="tok-p">,</span> <span class="tok-c">-- No heart beat</span>
                                                <span class="tok-m">1</span><span class="tok-p">|</span><span class="tok-nd">[local::at0007]</span><span class="tok-p">,</span> <span class="tok-c">-- Less than 100 bpm</span>
                                                <span class="tok-m">2</span><span class="tok-p">|</span><span class="tok-nd">[local::at0008]</span> <span class="tok-c">-- Greater than 100 bpm</span>
                                            <span class="tok-p">}</span>
                                        <span class="tok-p">}</span>
                                    <span class="tok-p">}</span>
                                <span class="tok-p">}</span>
                            <span class="tok-p">}</span>
                        <span class="tok-p">}</span>
                    <span class="tok-p">}</span>
                <span class="tok-p">}</span>
                <span class="tok-nc">POINT_EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0026</span><span class="tok-p">]</span> <span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span> <span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-c">-- 2 minute</span>
                    <span class="tok-nc">offset</span> <span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-ld">PT2M</span><span class="tok-p">|}</span>
                    <span class="tok-nc">data</span> <span class="tok-o">matches </span><span class="tok-p">{</span>
                        <span class="tok-kt">use_node </span><span class="tok-nc">ITEM_LIST</span> <span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span>
<span class="tok-p">                        ...</span>
                    <span class="tok-p">}</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span>
<span class="tok-p">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The second use of local codes is as values. Above, the <code>ELEMENT</code> node identified by code
<code>[at0005]</code> has as its value constraint an <code>ORDINAL</code> type whose values can be 0, 1, or 2. Each of these
values is coded by the codes <code>[at0006]</code>, <code>[at0007]</code>, and <code>[at0008]</code>. An extract of the archetype ontology
showing these terms is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">ontology</span>
    <span class="tok-nc">primary_language</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">&gt;</span>
    <span class="tok-nc">languages_available</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">,</span> <span class="tok-s">&quot;en-us&quot;</span><span class="tok-p">&gt;</span>
    <span class="tok-nc">terminologies_available</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;LNC205&quot;</span><span class="tok-p">,</span> <span class="tok-p">...&gt;</span>
    <span class="tok-nc">term_definitions</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
        <span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
            <span class="tok-nc">items</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                <span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                    <span class="tok-nc">description</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical score derived from assessment of</span>
<span class="tok-s">                        breathing, colour, muscle tone, heart rate and reflex</span>
<span class="tok-s">                        response usually taken at 1, 5 and 10 minutes after birth&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">text</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
                <span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                    <span class="tok-nc">description</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score at one minute&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">text</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;1 minute&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
                <span class="tok-p">[</span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                    <span class="tok-nc">description</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;No heart beat is present (palpation at base of</span>
<span class="tok-s">                        umbilical cord)&quot;</span><span class="tok-p">&gt;</span>
                        <span class="tok-nc">text</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;No heart beat&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
                <span class="tok-p">[</span><span class="tok-s">&quot;at0007&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                    <span class="tok-nc">description</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Heart rate of less than 100 beats per minute&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">text</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Less than 100 beats per minute&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
                <span class="tok-p">[</span><span class="tok-s">&quot;at0008&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                    <span class="tok-nc">description</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Heart rate of greater than or equal to 100</span>
<span class="tok-s">                        beats per minute&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">text</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Greater than 100 beats per minute&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
                <span class="tok-p">[</span><span class="tok-s">&quot;at0026&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
                    <span class="tok-nc">description</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score 2 minutes after birth&quot;</span><span class="tok-p">&gt;</span>
                    <span class="tok-nc">text</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span><span class="tok-s">&quot;2 minute&quot;</span><span class="tok-p">&gt;</span>
                <span class="tok-p">&gt;</span>
            <span class="tok-p">&gt;</span>
        <span class="tok-p">&gt;</span>
    <span class="tok-p">&gt;</span>
    <span class="tok-nc">term_bindings</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
        <span class="tok-p">[</span><span class="tok-s">&quot;LNC205&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
            <span class="tok-nc">items</span> <span class="tok-o">=</span> <span class="tok-p">&lt;</span>
            <span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0003]/data/items[at0025]&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">9272-6</span><span class="tok-p">]&gt;</span> <span class="tok-c">-- 1 minute total</span>
            <span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0026]/data/items[at0025]&quot;</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">9271-8</span><span class="tok-p">]&gt;</span> <span class="tok-c">-- 2 minute total</span>
        <span class="tok-p">&gt;</span>
    <span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_binding_to_external_terminologies"><a class="anchor" href="#_binding_to_external_terminologies"></a>12.4. Binding to External Terminologies</h3>
<div class="sect3">
<h4 id="_binding_external_terminology_codes_to_archetype_codes"><a class="anchor" href="#_binding_external_terminology_codes_to_archetype_codes"></a>12.4.1. Binding External Terminology Codes to Archetype Codes</h4>
<div class="paragraph">
<p>The first kind of binding is the ability within an archetype to map an internal code to a code from an
external terminology. The bindings are grouped on the basis of external terminology, allowing any
given internal code in an archetype to be bound to codes in multiple terminologies. Usually, coverage
provided by external terminologies is incomplete, and the mappings may be approximate, so care
must be taken in creating the mappings in the first place. In the example shown above, two
paths are shown respectively as being bound to LOINC codes for 1-minute and 2-minute Apgar total.
In this example, the whole path is bound, meaning that the mapping only holds between <code>[at0025]</code> and
<code>[LNC205::9272-6]</code> when <code>[at0025]</code> occurs in the first path; when it occurs in the second path, the mapping
is to a different LOINC code. This is how so-called "pre-coordinated" codes from external terminologies
can be mapped to an openEHR archetype concept.</p>
</div>
<div class="paragraph">
<p>Bindings can also be made between atomic internal codes and external codes, in which case the
meaning is that the mapping always holds, no matter how many times the internal code is used within
the archetype.</p>
</div>
<div class="sect4">
<h5 id="_binding_terminology_value_sets_to_archetypes"><a class="anchor" href="#_binding_terminology_value_sets_to_archetypes"></a>12.4.1.1. Binding Terminology Value-sets to Archetypes</h5>
<div class="paragraph">
<p>An important requirement with respect to terminology is that of specifying value sets for attributes
defined in archetypes. Sometimes value sets are defined locally within the archetype, because the
terms are not available in published terminologies, and in any case may be too hard to define therein,
due to the lack of encapsulation. The terms "no effort", "moderate effort" and "crying" for example
are recognised values for the "breathing" attribute of an Apgar result1. In the context of Apgar /
breathing, the meanings are clear; clearly however a term with this rubric within a terminology like
SNOMED-CT would need to be pre-coordinated. More importantly, there seems to be little business
value in mapping a SNOMED term for "no effort", since a query for items containing "no effort" is
unlikely to be useful in a clinical context.</p>
</div>
<div class="paragraph">
<p>For many other kinds of attributes however, terminologies are an appropriate source of values. Often
such attributes define kinds of real world phenomena, such as kinds of disease and blood groups,
rather than qualities of a phenomenon such as "no effort", or "blue". For these attributes a different
kind of connection to external terminology is required. This is achieved in a similar way as for single
code bindings: an internal code is defined, in this case an "ac" code ("ac" = archetype constraint), and
this is bound to queries to one or more external terminologies, whose result would be a (possibly
structured) value set from that terminology. The logical scheme is illustrated in the figure below, where he
attribute value to be coded is "blood group phenotype".</p>
</div>
<div id="archetype_constraint_binding" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/archetype_constraint_binding.png" alt="archetype constraint binding" width="80%">
</div>
<div class="title">Figure 40. Archetype Constraint Binding</div>
</div>
<div class="paragraph">
<p>Currently there is no standard for such queries. This does not affect archetypes directly, since they
simply hold an identifier for a query; the query itself is defined within a "terminology query server".
The result of this query is a list of blood group phenotypes, which might appear as shown at the bottom
of <a href="#archetype_constraint_binding">Figure 40</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_querying_using_external_terminologies"><a class="anchor" href="#_querying_using_external_terminologies"></a>12.5. Querying using External Terminologies</h3>
<div class="paragraph">
<p>Querying through EHR data is frequently cited to be the major utility of terminology with respect to
health information. With the mappings defined in archetypes, a number of approaches are possible,
however the semantics of the intended query need to be understood first. Consider a query for "adenocarcinoma"
on a patient record. SNOMED-CT includes 63 terms beginning with "adenocarcinoma"
(and 171 terms which include the word as a secondary part of the phrase), some as children of a common
parent. Nevertheless, the terms do not all have a single common parent; a choice has to be made
of which terms correspond to the intent of the query. If it is to find any previous diagnosis of "adenocarcinoma",
then at least the terms of the form <code>[snomed-ct::254626006|adenocarcinoma of lung|]</code>,
"&#8230;&#8203; of liver" have to be included. These are within the "clinical finding" hierarchy, so the use of these
latter terms should ensure that matches are not made with other uses of the same terms in the record,
e.g. "fear of adenocarcinoma" or "minimal risk of adenocarcinoma". Such correct matching is completely
dependent upon the correct use of SNOMED-CT terms in the first place by the software application
and/or user creating the data. It is easy to imagine an application that saves data (including
openEHR data) in the form of two name/value pairs: <code>&lt;"principal diagnosis", [snomed-ct::35917007|adenocarcinoma|])&gt;</code> and <code>&lt;"site", "lung"&gt;</code>. Querying using <code>[snomedct::254626006|adenocarcinoma of lung|]</code> will fail, even though this is exactly the meaning of the data. The data are not wrong
as such, but the lesson is clear: coding of data and code use in queries must be governed by common
models, otherwise there is no hope of reliably processing the data.</p>
</div>
<div class="paragraph">
<p>Under the openEHR aproach, path-based querying can be used to specify (for example):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>find <code>EVALUATIONs</code> based on a <code>problem-diagnosis-histological_staging</code> archetype with a value at the path <code>/data/items[at0002.1.1]/value/code</code> (histological diagnosis) equal-to-or-subsumed-by "clinical finding" and equal-to or-subsumed-by "adenocarcinoma".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The assumption here is that the value at this path was <em>originally</em> restricted by the archetype from
which the path is taken, to conforming to the relation {is-a "clinical finding" and is-a "abnormal morphological
mass"}. Any finding of adenocarcinoma of the lung is then forced to be from the resulting
subsumption hierarchy; other "adenocarcinoma" terms cannot be wrongly used in this position.</p>
</div>
<div class="paragraph">
<p>However, even if the archetype had not restricted the value in this way, the same query which
searched for any "adenocarcinoma" term at the same path could reasonably be used to locate "previous
diagnoses of adenocarcinoma", since this is the only use of the archetype. In a similar way, archetype
path-based querying can be used to distinguish the other potential ambiguities described in
the section on <a href="#_entries_and_clinical_statements">Section 6.4</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment"><a class="anchor" href="#_deployment"></a>13. Deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_5_tier_system_architecture"><a class="anchor" href="#_5_tier_system_architecture"></a>13.1. 5-tier System Architecture</h3>
<div class="paragraph">
<p>Previous sections have described the software architecture of the openEHR specifications. Here we
describe how the package architecture can be applied to building real systems. The general architectural
approach in any openEHR system can be considered as 5 layers (i.e. a "5-tier" architecture). The
tiers are as follows.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>persistence</em>: data storage and retrieval.</p>
</li>
<li>
<p>back-end services: including EHR, demographics, terminology, archetypes, security, record location, and so on. In this layer, the separation of the different services is transparent, and each service has a coarse-grained service interface.</p>
</li>
<li>
<p><em>virtual EHR</em>: this tier is the middleware, and consists of a coherent set of APIs to the various back-end services providing access to the relevant services, thereby allowing user access to the EHR; including EHR, demographics, security, terminology, and archetype services. It also contains an archetype- and template-enabled kernel, the component responsible for creating and processing archetype-enabled data. In this tier, the separation of backend services is hidden, only the functionality is exposed. Other virtual clients are possible, consisting of APIs for other combinations of back-end services.</p>
</li>
<li>
<p><em>application logic</em>: this tier consists of whatever logic is specific to an application, which might be a user application, or another service such as a query engine.</p>
</li>
<li>
<p><em>presentation layer</em>: this layer consists of the graphical interface of the application, where applicable.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The same tiers can be used in large deployments, as shown in the next figure or simply as layers in single-
machine applications.</p>
</div>
<div id="system_architecture" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/system_architecture.png" alt="system architecture" width="70%">
</div>
<div class="title">Figure 41. Basic Enterprise EHR System Architecture</div>
</div>
<div class="paragraph">
<p>The figure below illustrates an approximate mapping of major parts of the openEHR software architecture
to the 5-tier scheme. Clearly where parts of the architecture are used will depend on various implementation
choices; the mapping shown is therefore not definitive. Nevertheless, the principal use of
parts of the architecture is likely to be similar in most systems, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RM and AM: mainly used to construct an archetype- and template-processing kernel;</p>
</li>
<li>
<p>RM <code>common.change_control</code> package: provides the logic for versioning in versioned services such as the EHR and demographics;</p>
</li>
<li>
<p>SM: various service model packages define the exposed interfaces of major services;</p>
</li>
<li>
<p>SM <code>virtual_ehr</code> package defines the API of the virtual EHR component;</p>
</li>
<li>
<p>archetypes: archetypes might be assumed directly in some applications, e.g. a specialist peri-natal package might be partly based on a family of archetypes for this specialisation;</p>
</li>
<li>
<p>templates: both archetypes and templates will be used in the presentation layer of applications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some will base the GUI code on them, while others will have either tool-generated
code, or dynamically generate forms based on particular templates and archetypes.
In the future, an abstract persistence API and optimised persistence models (transformations of the
existing RM models) are likely to be published by openEHR in order to help with the implementation
of databases.</p>
</div>
<div id="software_arch_deployment" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/software_arch_deployment.png" alt="software arch deployment" width="70%">
</div>
<div class="title">Figure 42. Mapping of software architecture to deployment architecture</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integrating_openehr_with_other_systems"><a class="anchor" href="#_integrating_openehr_with_other_systems"></a>14. Integrating openEHR with other Systems</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_13"><a class="anchor" href="#_overview_13"></a>14.1. Overview</h3>
<div class="paragraph">
<p>Getting data in and out of the EHR is one of the most basic requirements openEHR aims to satisfy. In
"greenfield" (new build) situations, and for data being created by GUI applications via the openEHR
EHR APIs, there is no issue, since native openEHR structures and semantics are being used. In almost
all other situations, existing data sources and sinks have to be accounted for. In general, external or
legacy data (here the term is used for convenience, and does not imply anything about the age or
quality of the systems in question) have different syntactic and semantic formats than openEHR data,
and seamless conversion requires addressing both levels.</p>
</div>
<div class="paragraph">
<p>Existing data sources and sinks include relational databases, HL7v2 messages, HL7 CDA documents
and are likely to include ISO 13606 data. HL7v2 messages are probably one of the most common
sources of pathology messages in many countries; EDIFACT messages are another. More recently,
HL7v2 messages have been designed for referrals and even discharge summaries. Not all legacy systems
are standardised; most hospital and GP products have their own private models of data and terminology
usage.</p>
</div>
<div class="paragraph">
<p>The primary need with respect to legacy data is to be able to convert data from multiple mutually
incompatible sources into a single, standardised patient-centric EHR for each patient, that can then be
longitudinally viewed and queried. This is what enables GP and specialist notes, diagnoses and plans
to be integrated with laboratory results from multiple sources, patient notes, administrative data and
so on, to provide a coherent record of the patient journey.</p>
</div>
<div class="paragraph">
<p>In technical terms, a number of types of incompatibility have to be dealt with. There is no guarantee
of correspondence of scope of incoming transactions and target openEHR structures - an incoming
document for example might correspond to a number of clinical archetypes. Structure will not usually
correspond, with legacy data (particularly messages) usually having flatter structures than those
defined in target archetypes. Terminology use is extremely variable in existing systems and messages,
and also has to be dealt with. Data types will also not correspond directly, so that for example, a mapping
between an incoming string "110/80 mmHg" and the target openEHR form of two
<code>DV_QUANTITY</code> objects each with their own value and units has to be made.</p>
</div>
</div>
<div class="sect2">
<h3 id="_integration_archetypes"><a class="anchor" href="#_integration_archetypes"></a>14.2. Integration Archetypes</h3>
<div class="paragraph">
<p>The foundation of a key approach to the integration problem is the use of two kinds of archetypes. So
far in this document "archetypes" has meant "designed" archetypes, generally clinical, demographic
or administrative. The common factors for all such archetypes are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>they are based on the main part of the reference model, particularly the Entry subtypes <code>OBSERVATION</code>, <code>EVALUATION</code>, <code>INSTRUCTION</code> and <code>ACTION</code>;</p>
</li>
<li>
<p>they are consciously designed from scratch by groups of domain specialists, and integrated into the existing library of openEHR archetypes;</p>
</li>
<li>
<p>there is one archetype per identifiable health "concept", such as an observation type, person type etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A second category of archetypes is "integration" archetypes. These are characterised as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>they are based on the same high-level types (<code>COMPOSITION</code>, <code>SECTION</code> etc), but use the Entry subtype <code>GENERIC_ENTRY</code> (see EHR Information Model);</p>
</li>
<li>
<p>they are designed to mimic the structure of legacy or existing data or messages; the design effort therefore is completely different, and is more likely to be done by IT or other technical staff who are familiar with the structures of the incoming data;</p>
</li>
<li>
<p>there is one integration archetype per message type or identifiable source data that makes sense as a transaction to the EHR.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the data integration environment, "designed" archetypes always define the target structures, coding
and other semantics of data, while "integration" archetypes provide the means mapping of external
data into the openEHR environment.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_conversion_architecture"><a class="anchor" href="#_data_conversion_architecture"></a>14.3. Data Conversion Architecture</h3>
<div class="paragraph">
<p>The integration archetype-based strategy for importing data into an openEHR system, shown below, consists of two steps.</p>
</div>
<div id="data_integration" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/data_integration.png" alt="data integration" width="80%">
</div>
<div class="title">Figure 43. Data Integration using openEHR</div>
</div>
<div class="paragraph">
<p>Firstly, data are converted from their original syntactic format into openEHR <code>COMPOSITION</code> / <code>SECTION</code> / <code>GENERIC_ENTRY</code> structures, shown in the openEHR integration switch. Most of the data will
appear in the <code>GENERIC_ENTRY</code> part, controlled by an integration archetype designed to mimic the
incoming structure (such as an HL7v2 lab message) as closely as possible; <code>FEEDER_AUDIT</code> structures
are used to contain integration meta-data. The result of this step is data that are expressed in the
openEHR type system (i.e. as instances of the openEHR reference model), and are immediately amenable
to processing with normal openEHR software.</p>
</div>
<div class="paragraph">
<p>In the second step, semantic transformation is effected, by the use of mappings between integration
and designed archetypes. Such mappings are created by archetype authors using tools. The mapping
rules are the key to defining structural transformations, use of terminological codes, and other
changes. Serious challenges of course remain in the business of integrating heterogeneous systems;
some of these are dealt with in the Common IM document sections on Feeder systems.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_to_standards"><a class="anchor" href="#_relationship_to_standards"></a>15. Relationship to Standards</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The openEHR specifications make use of available standards where relevant, and as far as possible in
a compatible way. However, for the many standards have never been validated in their published form
(i.e. the form published is not tested in implementations, and may contain errors), openEHR makes
adjustments so as to ensure quality and coherence of the openEHR models. In general, "using" a
standard in openEHR may mean defining a set of classes which map it into the openEHR type system,
or wrap it or express it in some other compatible way, allowing developers to build completely coherent
openEHR systems, while retaining compliance or compatibility with standards. The standards relevant
to openEHR fall into a number of categories as follows.</p>
</div>
<div class="sect2">
<h3 id="_standards_by_which_openehr_can_be_evaluated"><a class="anchor" href="#_standards_by_which_openehr_can_be_evaluated"></a>15.1. Standards by which openEHR can be evaluated</h3>
<div class="paragraph">
<p>These standards define high-level requirements or compliance criteria which can be used to provide a
means of normative comparison of openEHR with other related specifications or systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.iso.org/standard/39525.html" target="_blank" rel="noopener">ISO 20514 - Electronic health record  Definition, scope, and context</a>.</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/52823.html" target="_blank" rel="noopener">ISO 18308 - Technical Specification for Requirements for an EHR Architecture</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards_which_have_influenced_the_design_of_openehr_specifications"><a class="anchor" href="#_standards_which_have_influenced_the_design_of_openehr_specifications"></a>15.2. Standards which have influenced the design of openEHR specifications</h3>
<div class="paragraph">
<p>The following standards have influenced the design of the openEHR specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OMG HDTF Standards - general design</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/40784.html" target="_blank" rel="noopener">ISO 13606:2005: Electronic Health Record Communication</a></p>
</li>
<li>
<p>CEN HISA 12967-3: Health Informatics Service Architecture - Computational viewpoint</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards_which_have_influenced_the_design_of_openehr_archetypes"><a class="anchor" href="#_standards_which_have_influenced_the_design_of_openehr_archetypes"></a>15.3. Standards which have influenced the design of openEHR archetypes</h3>
<div class="paragraph">
<p>The following standards are mainly domain-level models of clinical practice or concepts, and are being used to design openEHR archetypes and templates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CEN HISA 12967-2: Health Informatics Service Architecture - Information viewpoint</p>
</li>
<li>
<p>CEN ENV 13940: Continuity of Care.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards_which_are_used_inside_openehr"><a class="anchor" href="#_standards_which_are_used_inside_openehr"></a>15.4. Standards which are used "inside" openEHR</h3>
<div class="paragraph">
<p>The following standards are used or referenced at a fine-grained level in openEHR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank" rel="noopener">ISO 8601: Syntax for expressing dates and times</a> (used in openEHR Quantity package)</p>
</li>
<li>
<p><a href="http://unitsofmeasure.org/ucum.html" target="_blank" rel="noopener">Unified Coding for Units of Measure (UCUM)</a> (used by openEHR Quantity data type)</p>
</li>
<li>
<p>HL7v3 GTS: General Timing Specification syntax (used by openEHR Time specification data types).</p>
</li>
<li>
<p>some HL7v3 domain vocabularies are mapped to the openEHR terminology.</p>
</li>
<li>
<p><a href="https://www.ietf.org/rfc/rfc4880" target="_blank" rel="noopener">IETF RFC4880</a> - openPGP.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards_which_require_a_conversion_gateway"><a class="anchor" href="#_standards_which_require_a_conversion_gateway"></a>15.5. Standards which require a conversion gateway</h3>
<div class="paragraph">
<p>The following standards are in use and require data conversion for use with openEHR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.iso.org/standard/40784.html" target="_blank" rel="noopener">ISO 13606:2005 - Electronic Health Record Communication</a> - near-direct conversion possible, as openEHR and ISO 13606 are actively maintained to be compatible.</p>
</li>
<li>
<p><a href="https://www.hl7.org/implement/standards/product_brief.cfm?product_id=7" target="_blank" rel="noopener">HL7v3 CDA: Clinical Document Architecture (CDA) release 2.0</a> - fairly close conversion may be possible.</p>
</li>
<li>
<p>HL7v3 messages. Quality of conversion currently unknown due to flux in HL7v3 messaging specifications and diversity of message schemas.</p>
</li>
<li>
<p>HL7v2 messages. Importing of HL7v2 message data is technically not difficult, and is already used in some openEHR systems. Export from openEHR may also be possible.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_generic_technology_standards"><a class="anchor" href="#_generic_technology_standards"></a>15.6. Generic Technology Standards</h3>
<div class="paragraph">
<p>The following standards are used or referenced in openEHR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/RM-ODP" target="_blank" rel="noopener">ISO RM/ODP</a></p>
</li>
<li>
<p><a href="https://www.omg.org/spec/UML/" target="_blank" rel="noopener">OMG UML 2.0</a></p>
</li>
<li>
<p><a href="https://www.w3.org/XML/Schema" target="_blank" rel="noopener">W3C XML schema 1.0</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/xpath-31/" target="_blank" rel="noopener">W3C Xpath 1.0</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_technology_specifications"><a class="anchor" href="#_implementation_technology_specifications"></a>16. Implementation Technology Specifications</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_14"><a class="anchor" href="#_overview_14"></a>16.1. Overview</h3>
<div class="paragraph">
<p>ITSs are created by the application of transformation rules from the "full-strength" semantics of the
abstract models to equivalents in a particular technology. Transformation rules usually include mappings
of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>names of classes and attributes;</p>
</li>
<li>
<p>property and function signature mapping;</p>
</li>
<li>
<p>mapping of basic types e.g. strings, numerics;</p>
</li>
<li>
<p>how to handle multiple inheritance;</p>
</li>
<li>
<p>how to handle generic (template) types;</p>
</li>
<li>
<p>how to handle covariant and contravariant redefinition semantics;</p>
</li>
<li>
<p>the choice of mapping properties with signature <code>xxxx:T</code> (i.e. properties with no arguments) to stored attributes (<code>xxxx:T</code>) or functions (<code>xxxx():T</code>);</p>
</li>
<li>
<p>how to express pre-conditions, post-conditions and class invariants;</p>
</li>
<li>
<p>mappings between assumed types such as List&lt;&gt;, Set&lt;&gt; and inbuilt types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ITSs are being developed for a number of major implementation technologies, as summarised below.
Implementors should always look for an ITS for the technology in question before proceeding. If
none exists, it will need to be defined. A methodology to do this is being developed.
The figure below illustrates the implementation technology specification space. Each specification documents
the mapping from the standard object-oriented semantics used in the openEHR abstract models,
and also provides an expression of each of the abstract models in the ITS formalism.</p>
</div>
<div id="implem_technologies" class="imageblock text-center text-center">
<div class="content">
<img src="architecture_overview/diagrams/implem_technologies.png" alt="implem technologies" width="70%">
</div>
<div class="title">Figure 44. Implementation Technologies</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="Anderson1996"></a>Anderson, D. R., &amp; Anderson, J. (1996). Security in Clinical Information Systems. Retrieved from <a href="http://www.cl.cam.ac.uk/users/rja14/policy11/policy11.html" class="bare">http://www.cl.cam.ac.uk/users/rja14/policy11/policy11.html</a></p>
</div>
<div class="paragraph">
<p><a id="Beale2002"></a>Beale, T. (2002). Archetypes: Constraint-based Domain Models for Future-proof Information Systems. In K. Baclawski &amp; H. Kilov (Eds.), <em>Eleventh OOPSLA Workshop on Behavioral Semantics: Serving the Customer</em> (pp. 1632). Northeastern University, Boston. Retrieved from <a href="https://www.openehr.org/publications/archetypes/archetypes_beale_oopsla_2002.pdf" class="bare">https://www.openehr.org/publications/archetypes/archetypes_beale_oopsla_2002.pdf</a></p>
</div>
<div class="paragraph">
<p><a id="Beale_Heard2007"></a>Beale, T., &amp; Heard, S. (2007). An Ontology-based Model of Clinical Information. In K. K. et al. (Ed.), <em>Proceedings MedInfo 2007</em> (pp. 760764). IOS Publishing. Retrieved from <a href="http://www.openehr.org/publications/health_ict/MedInfo2007-BealeHeard.pdf" class="bare">http://www.openehr.org/publications/health_ict/MedInfo2007-BealeHeard.pdf</a></p>
</div>
<div class="paragraph">
<p><a id="Elstein1978"></a>Elstein, A. S., Shulman, L. S., &amp; Sprafka, S. A. (1978). <em>Medical problem solving: an analysis of clinical reasoning.</em> Cambridge, MA: Harvard University Press.</p>
</div>
<div class="paragraph">
<p><a id="Kifer_Lausen_Wu2000"></a>Kifer, M., Lausen, G., &amp; Wu, J. (2000). Logical Foundations of Object-Oriented and Frame-Based Languages. <em>Journal of the ACM</em>, <em>42</em>, 741843. Retrieved from <a href="ftp://ftp.cs.sunysb.edu/pub/TechReports/kifer/flogic.pdf" class="bare">ftp://ftp.cs.sunysb.edu/pub/TechReports/kifer/flogic.pdf</a></p>
</div>
<div class="paragraph">
<p><a id="Maier2000"></a>Maier, M. (2000). <em>Architecting Principles for Systems-of-Systems</em>. University of Alabama in Huntsville. Retrieved from <a href="http://www.infoed.com/Open/PAPERS/systems.htm" class="bare">http://www.infoed.com/Open/PAPERS/systems.htm</a></p>
</div>
<div class="paragraph">
<p><a id="Rector1994"></a>Rector, A., Nowlan, W. A., &amp; Kay, S. (1991). Foundations for an Electronic Medical Record. <em>Methods of information in medicine</em>, <em>30</em>, 17986.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-03-04 21:22:47 UTC
</div>
</div>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-default.css">
</body>
</html>